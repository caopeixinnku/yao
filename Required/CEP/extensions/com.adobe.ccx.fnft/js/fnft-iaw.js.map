{"version":3,"sources":["startup.js","a11y.js","analytics.js","i18n.js","json.js","libraryManager.js","localstorage.js","log.js","motor.js","perf.js","profile.js","stockUtil.js","util.js","fnft.js","host-events.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzjDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/iCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9MA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC1zBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC7LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC1HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC7+BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"fnft-iaw.js","sourcesContent":["/*************************************************************************\n * ADOBE CONFIDENTIAL\n * ___________________\n *\n *  Copyright 2015 Adobe Systems Incorporated\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe Systems Incorporated and its suppliers,\n * if any.  The intellectual and technical concepts contained\n * herein are proprietary to Adobe Systems Incorporated and its\n * suppliers and are protected by all applicable intellectual property\n * laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe Systems Incorporated.\n **************************************************************************/\n\n/*\n\tService helper that holds the objects wanting to run something when the app starts.\n\n\tThe functions you should have attached to your objects correspond to PHASES.\n\teg if you want to listen for when everything has been loaded, make sure you have a function called \"whenReady\".\n\n\tExample usage:\n\tvar startupObj = {\n\t\twhenHostReady: function() {\n\t\t\t// your code here\n\t\t}\n\t};\n\n\tiaw.startup.add(startupObj);\n*/\nvar iaw = iaw || {};\niaw.startup = {\n\tPHASES: {\n\t\tDoc: 'whenDocReady', // after the document finishes loading, before host data is loaded\n\t\tHost: 'whenHostReady', // after host data has been loaded\n\t\tDone: 'whenReady' // after everything has been loaded\n\t},\n\n\t_objs: [],\n\n\t/*\n\t\tPass in the object that holds the (public) function(s) to be called during the startup sequence.\n\t*/\n\tadd: function(startupObj) {\n\t\tvar haveCB = false;\n\t\tfor (var p in this.PHASES) {\n\t\t\tif (startupObj[this.PHASES[p]]) {\n\t\t\t\thaveCB = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!haveCB) {\n\t\t\tthrow new Error('[iaw.init] Add at least one init callback before adding to startup sequence.');\n\t\t}\n\t\tthis._objs.push(startupObj);\n\t},\n\n\tremove: function(startupObj) {\n\t\tvar i = this._objs.indexOf(startupObj);\n\t\tif (i === -1) return;\n\t\tthis._objs.splice(i, 1);\n\t\tconsole.log(this._objs);\n\t},\n\n\t/*\n\t\tCycles through all objects to call their functions if they exist. No arguments are passed.\n\t\t@private\n\t*/\n\trun: function(phase) {\n\t\tvar i, o;\n\t\t// console.log('[Startup] Running '+phase);\n\t\tfor (i = 0; i < this._objs.length; i++) {\n\t\t\to = this._objs[i];\n\t\t\tif (o[phase]) {\n\t\t\t\to[phase].call(o);\n\t\t\t}\n\t\t}\n\t}\n};\n","//===================================================================================\n//\n//  ADOBE CONFIDENTIAL\n//\n//  Copyright © 2015 Adobe Systems Incorporated\n//  All Rights Reserved.\n//\n//  NOTICE:  All information contained herein is, and remains\n//  the property of Adobe Systems Incorporated and its suppliers,\n//  if any.  The intellectual and technical concepts contained\n//  herein are proprietary to Adobe Systems Incorporated and its\n//  suppliers and are protected by all applicable intellectual property\n//  laws, including trade secret and copyright laws.\n//\n//  Dissemination of this information or reproduction of this material\n//  is strictly forbidden unless prior written permission is obtained\n//  from Adobe Systems Incorporated.\n//\n//===================================================================================\n\n/**\n * Simple singleton style utility container so accessibility related\n * stuff has a centralized wrapper.\n */\nvar iaw = iaw || {};\n\niaw.a11y = function() {\n\tvar KEYS_OF_INTEREST_MAC = [\n\t\t{\n\t\t\t/* Enter */\n\t\t\tkeyCode: 36\n\t\t},\n\t\t{\n\t\t\t/* Tab */\n\t\t\tkeyCode: 48\n\t\t},\n\t\t{\n\t\t\t/* Shift+Tab */\n\t\t\tkeyCode: 48,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* Space */\n\t\t\tkeyCode: 49\n\t\t},\n\t\t{\n\t\t\t/* Esc */\n\t\t\tkeyCode: 53\n\t\t},\n\t\t{\n\t\t\t/* Home */\n\t\t\tkeyCode: 115\n\t\t},\n\t\t{\n\t\t\t/* Page Up */\n\t\t\tkeyCode: 116\n\t\t},\n\t\t{\n\t\t\t/* End */\n\t\t\tkeyCode: 119\n\t\t},\n\t\t{\n\t\t\t/* Page Down */\n\t\t\tkeyCode: 121\n\t\t},\n\t\t{\n\t\t\t/* Left Arrow */\n\t\t\tkeyCode: 123\n\t\t},\n\t\t{\n\t\t\t/* Right Arrow */\n\t\t\tkeyCode: 124\n\t\t},\n\t\t{\n\t\t\t/* Down Arrow */\n\t\t\tkeyCode: 125\n\t\t},\n\t\t{\n\t\t\t/* Up Arrow */\n\t\t\tkeyCode: 126\n\t\t},\n\t\t{\n\t\t\t/* A */\n\t\t\tkeyCode: 0\n\t\t},\n\t\t{\n\t\t\t/* B */\n\t\t\tkeyCode: 11\n\t\t},\n\t\t{\n\t\t\t/* C */\n\t\t\tkeyCode: 8\n\t\t},\n\t\t{\n\t\t\t/* D */\n\t\t\tkeyCode: 2\n\t\t},\n\t\t{\n\t\t\t/* E */\n\t\t\tkeyCode: 14\n\t\t},\n\t\t{\n\t\t\t/* F */\n\t\t\tkeyCode: 3\n\t\t},\n\t\t{\n\t\t\t/* G */\n\t\t\tkeyCode: 5\n\t\t},\n\t\t{\n\t\t\t/* H */\n\t\t\tkeyCode: 4\n\t\t},\n\t\t{\n\t\t\t/* I */\n\t\t\tkeyCode: 34\n\t\t},\n\t\t{\n\t\t\t/* J */\n\t\t\tkeyCode: 38\n\t\t},\n\t\t{\n\t\t\t/* K */\n\t\t\tkeyCode: 40\n\t\t},\n\t\t{\n\t\t\t/* L */\n\t\t\tkeyCode: 37\n\t\t},\n\t\t{\n\t\t\t/* M */\n\t\t\tkeyCode: 46\n\t\t},\n\t\t{\n\t\t\t/* N */\n\t\t\tkeyCode: 45\n\t\t},\n\t\t{\n\t\t\t/* O */\n\t\t\tkeyCode: 31\n\t\t},\n\t\t{\n\t\t\t/* P */\n\t\t\tkeyCode: 35\n\t\t},\n\t\t{\n\t\t\t/* Q */\n\t\t\tkeyCode: 12\n\t\t},\n\t\t{\n\t\t\t/* R */\n\t\t\tkeyCode: 15\n\t\t},\n\t\t{\n\t\t\t/* S */\n\t\t\tkeyCode: 1\n\t\t},\n\t\t{\n\t\t\t/* T */\n\t\t\tkeyCode: 17\n\t\t},\n\t\t{\n\t\t\t/* U */\n\t\t\tkeyCode: 32\n\t\t},\n\t\t{\n\t\t\t/* V */\n\t\t\tkeyCode: 9\n\t\t},\n\t\t{\n\t\t\t/* W */\n\t\t\tkeyCode: 13\n\t\t},\n\t\t{\n\t\t\t/* X */\n\t\t\tkeyCode: 7\n\t\t},\n\t\t{\n\t\t\t/* Y */\n\t\t\tkeyCode: 16\n\t\t},\n\t\t{\n\t\t\t/* Z */\n\t\t\tkeyCode: 6\n\t\t},\n\t\t{\n\t\t\t/* ` */\n\t\t\tkeyCode: 50\n\t\t},\n\t\t{\n\t\t\t/* 1 */\n\t\t\tkeyCode: 18\n\t\t},\n\t\t{\n\t\t\t/* 2 */\n\t\t\tkeyCode: 19\n\t\t},\n\t\t{\n\t\t\t/* 3 */\n\t\t\tkeyCode: 20\n\t\t},\n\t\t{\n\t\t\t/* 4 */\n\t\t\tkeyCode: 21\n\t\t},\n\t\t{\n\t\t\t/* 5 */\n\t\t\tkeyCode: 23\n\t\t},\n\t\t{\n\t\t\t/* 6 */\n\t\t\tkeyCode: 22\n\t\t},\n\t\t{\n\t\t\t/* 7 */\n\t\t\tkeyCode: 26\n\t\t},\n\t\t{\n\t\t\t/* 8 */\n\t\t\tkeyCode: 28\n\t\t},\n\t\t{\n\t\t\t/* 9 */\n\t\t\tkeyCode: 25\n\t\t},\n\t\t{\n\t\t\t/* 0 */\n\t\t\tkeyCode: 29\n\t\t},\n\t\t{\n\t\t\t/* - */\n\t\t\tkeyCode: 27\n\t\t},\n\t\t{\n\t\t\t/* = */\n\t\t\tkeyCode: 24\n\t\t},\n\t\t{\n\t\t\t/* [ */\n\t\t\tkeyCode: 33\n\t\t},\n\t\t{\n\t\t\t/* ] */\n\t\t\tkeyCode: 30\n\t\t},\n\t\t{\n\t\t\t/* \\ */\n\t\t\tkeyCode: 42\n\t\t},\n\t\t{\n\t\t\t/* ; */\n\t\t\tkeyCode: 41\n\t\t},\n\t\t{\n\t\t\t/* ' */\n\t\t\tkeyCode: 39\n\t\t},\n\t\t{\n\t\t\t/* , */\n\t\t\tkeyCode: 43\n\t\t},\n\t\t{\n\t\t\t/* . */\n\t\t\tkeyCode: 47\n\t\t},\n\t\t{\n\t\t\t/* / */\n\t\t\tkeyCode: 44\n\t\t},\n\t\t{\n\t\t\t/* A */\n\t\t\tkeyCode: 0,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* B */\n\t\t\tkeyCode: 11,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* C */\n\t\t\tkeyCode: 8,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* D */\n\t\t\tkeyCode: 2,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* E */\n\t\t\tkeyCode: 14,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* F */\n\t\t\tkeyCode: 3,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* G */\n\t\t\tkeyCode: 5,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* H */\n\t\t\tkeyCode: 4,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* I */\n\t\t\tkeyCode: 34,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* J */\n\t\t\tkeyCode: 38,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* K */\n\t\t\tkeyCode: 40,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* L */\n\t\t\tkeyCode: 37,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* M */\n\t\t\tkeyCode: 46,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* N */\n\t\t\tkeyCode: 45,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* O */\n\t\t\tkeyCode: 31,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* P */\n\t\t\tkeyCode: 35,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* Q */\n\t\t\tkeyCode: 12,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* R */\n\t\t\tkeyCode: 15,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* S */\n\t\t\tkeyCode: 1,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* T */\n\t\t\tkeyCode: 17,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* U */\n\t\t\tkeyCode: 32,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* V */\n\t\t\tkeyCode: 9,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* W */\n\t\t\tkeyCode: 13,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* X */\n\t\t\tkeyCode: 7,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* Y */\n\t\t\tkeyCode: 16,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* Z */\n\t\t\tkeyCode: 6,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* ` */\n\t\t\tkeyCode: 50,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* 1 */\n\t\t\tkeyCode: 18,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* 2 */\n\t\t\tkeyCode: 19,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* 3 */\n\t\t\tkeyCode: 20,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* 4 */\n\t\t\tkeyCode: 21,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* 5 */\n\t\t\tkeyCode: 23,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* 6 */\n\t\t\tkeyCode: 22,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* 7 */\n\t\t\tkeyCode: 26,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* 8 */\n\t\t\tkeyCode: 28,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* 9 */\n\t\t\tkeyCode: 25,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* 0 */\n\t\t\tkeyCode: 29,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* - */\n\t\t\tkeyCode: 27,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* = */\n\t\t\tkeyCode: 24,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* [ */\n\t\t\tkeyCode: 33,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* ] */\n\t\t\tkeyCode: 30,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* \\ */\n\t\t\tkeyCode: 42,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* ; */\n\t\t\tkeyCode: 41,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* ' */\n\t\t\tkeyCode: 39,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* , */\n\t\t\tkeyCode: 43,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* . */\n\t\t\tkeyCode: 47,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* / */\n\t\t\tkeyCode: 44,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* / */\n\t\t\tkeyCode: 75\n\t\t},\n\t\t{\n\t\t\t/* * */\n\t\t\tkeyCode: 67\n\t\t},\n\t\t{\n\t\t\t/* - */\n\t\t\tkeyCode: 78\n\t\t},\n\t\t{\n\t\t\t/* + */\n\t\t\tkeyCode: 69\n\t\t},\n\t\t{\n\t\t\t/* ⌫ */\n\t\t\tkeyCode: 51\n\t\t}\n\t];\n\n\tvar KEYS_OF_INTEREST_WIN = [\n\t\t{\n\t\t\t/* Enter */\n\t\t\tkeyCode: 0x0D\n\t\t},\n\t\t{\n\t\t\t/* Tab */\n\t\t\tkeyCode: 0x09\n\t\t},\n\t\t{\n\t\t\t/* Shift+Tab */\n\t\t\tkeyCode: 0x09,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* Space */\n\t\t\tkeyCode: 0x20\n\t\t},\n\t\t{\n\t\t\t/* Esc */\n\t\t\tkeyCode: 0x1B\n\t\t},\n\t\t{\n\t\t\t/* Home */\n\t\t\tkeyCode: 0x24\n\t\t},\n\t\t{\n\t\t\t/* Page Up */\n\t\t\tkeyCode: 0x21\n\t\t},\n\t\t{\n\t\t\t/* End */\n\t\t\tkeyCode: 0x23\n\t\t},\n\t\t{\n\t\t\t/* Page Down */\n\t\t\tkeyCode: 0x22\n\t\t},\n\t\t{\n\t\t\t/* Left Arrow */\n\t\t\tkeyCode: 0x25\n\t\t},\n\t\t{\n\t\t\t/* Right Arrow */\n\t\t\tkeyCode: 0x27\n\t\t},\n\t\t{\n\t\t\t/* Down Arrow */\n\t\t\tkeyCode: 0x28\n\t\t},\n\t\t{\n\t\t\t/* Up Arrow */\n\t\t\tkeyCode: 0x26\n\t\t},\n\t\t{\n\t\t\t/* A */\n\t\t\tkeyCode: 0x41\n\t\t},\n\t\t{\n\t\t\t/* B */\n\t\t\tkeyCode: 0x42\n\t\t},\n\t\t{\n\t\t\t/* C */\n\t\t\tkeyCode: 0x43\n\t\t},\n\t\t{\n\t\t\t/* D */\n\t\t\tkeyCode: 0x44\n\t\t},\n\t\t{\n\t\t\t/* E */\n\t\t\tkeyCode: 0x45\n\t\t},\n\t\t{\n\t\t\t/* F */\n\t\t\tkeyCode: 0x46\n\t\t},\n\t\t{\n\t\t\t/* G */\n\t\t\tkeyCode: 0x47\n\t\t},\n\t\t{\n\t\t\t/* H */\n\t\t\tkeyCode: 0x48\n\t\t},\n\t\t{\n\t\t\t/* I */\n\t\t\tkeyCode: 0x49\n\t\t},\n\t\t{\n\t\t\t/* J */\n\t\t\tkeyCode: 0x4A\n\t\t},\n\t\t{\n\t\t\t/* K */\n\t\t\tkeyCode: 0x4B\n\t\t},\n\t\t{\n\t\t\t/* L */\n\t\t\tkeyCode: 0x4C\n\t\t},\n\t\t{\n\t\t\t/* M */\n\t\t\tkeyCode: 0x4D\n\t\t},\n\t\t{\n\t\t\t/* N */\n\t\t\tkeyCode: 0x4E\n\t\t},\n\t\t{\n\t\t\t/* O */\n\t\t\tkeyCode: 0x4F\n\t\t},\n\t\t{\n\t\t\t/* P */\n\t\t\tkeyCode: 0x50\n\t\t},\n\t\t{\n\t\t\t/* Q */\n\t\t\tkeyCode: 0x51\n\t\t},\n\t\t{\n\t\t\t/* R */\n\t\t\tkeyCode: 0x52\n\t\t},\n\t\t{\n\t\t\t/* S */\n\t\t\tkeyCode: 0x53\n\t\t},\n\t\t{\n\t\t\t/* T */\n\t\t\tkeyCode: 0x54\n\t\t},\n\t\t{\n\t\t\t/* U */\n\t\t\tkeyCode: 0x55\n\t\t},\n\t\t{\n\t\t\t/* V */\n\t\t\tkeyCode: 0x56\n\t\t},\n\t\t{\n\t\t\t/* W */\n\t\t\tkeyCode: 0x57\n\t\t},\n\t\t{\n\t\t\t/* X */\n\t\t\tkeyCode: 0x58\n\t\t},\n\t\t{\n\t\t\t/* Y */\n\t\t\tkeyCode: 0x59\n\t\t},\n\t\t{\n\t\t\t/* Z */\n\t\t\tkeyCode: 0x5A\n\t\t},\n\t\t{\n\t\t\t/* ` */\n\t\t\tkeyCode: 0xC0\n\t\t},\n\t\t{\n\t\t\t/* 1 */\n\t\t\tkeyCode: 0x31\n\t\t},\n\t\t{\n\t\t\t/* 2 */\n\t\t\tkeyCode: 0x32\n\t\t},\n\t\t{\n\t\t\t/* 3 */\n\t\t\tkeyCode: 0x33\n\t\t},\n\t\t{\n\t\t\t/* 4 */\n\t\t\tkeyCode: 0x34\n\t\t},\n\t\t{\n\t\t\t/* 5 */\n\t\t\tkeyCode: 0x35\n\t\t},\n\t\t{\n\t\t\t/* 6 */\n\t\t\tkeyCode: 0x36\n\t\t},\n\t\t{\n\t\t\t/* 7 */\n\t\t\tkeyCode: 0x37\n\t\t},\n\t\t{\n\t\t\t/* 8 */\n\t\t\tkeyCode: 0x38\n\t\t},\n\t\t{\n\t\t\t/* 9 */\n\t\t\tkeyCode: 0x39\n\t\t},\n\t\t{\n\t\t\t/* 0 */\n\t\t\tkeyCode: 0x30\n\t\t},\n\t\t{\n\t\t\t/* - */\n\t\t\tkeyCode: 0xBD\n\t\t},\n\t\t{\n\t\t\t/* = */\n\t\t\tkeyCode: 0xBB\n\t\t},\n\t\t{\n\t\t\t/* [ */\n\t\t\tkeyCode: 0xDB\n\t\t},\n\t\t{\n\t\t\t/* ] */\n\t\t\tkeyCode: 0xDD\n\t\t},\n\t\t{\n\t\t\t/* \\ */\n\t\t\tkeyCode: 0xDC\n\t\t},\n\t\t{\n\t\t\t/* ; */\n\t\t\tkeyCode: 0xBA\n\t\t},\n\t\t{\n\t\t\t/* ' */\n\t\t\tkeyCode: 0xDE\n\t\t},\n\t\t{\n\t\t\t/* , */\n\t\t\tkeyCode: 0xBC\n\t\t},\n\t\t{\n\t\t\t/* . */\n\t\t\tkeyCode: 0xBE\n\t\t},\n\t\t{\n\t\t\t/* / */\n\t\t\tkeyCode: 0xBF\n\t\t},\n\t\t{\n\t\t\t/* A */\n\t\t\tkeyCode: 0x41,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* B */\n\t\t\tkeyCode: 0x42,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* C */\n\t\t\tkeyCode: 0x43,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* D */\n\t\t\tkeyCode: 0x44,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* E */\n\t\t\tkeyCode: 0x45,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* F */\n\t\t\tkeyCode: 0x46,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* G */\n\t\t\tkeyCode: 0x47,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* H */\n\t\t\tkeyCode: 0x48,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* I */\n\t\t\tkeyCode: 0x49,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* J */\n\t\t\tkeyCode: 0x4A,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* K */\n\t\t\tkeyCode: 0x4B,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* L */\n\t\t\tkeyCode: 0x4C,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* M */\n\t\t\tkeyCode: 0x4D,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* N */\n\t\t\tkeyCode: 0x4E,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* O */\n\t\t\tkeyCode: 0x4F,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* P */\n\t\t\tkeyCode: 0x50,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* Q */\n\t\t\tkeyCode: 0x51,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* R */\n\t\t\tkeyCode: 0x52,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* S */\n\t\t\tkeyCode: 0x53,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* T */\n\t\t\tkeyCode: 0x54,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* U */\n\t\t\tkeyCode: 0x55,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* V */\n\t\t\tkeyCode: 0x56,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* W */\n\t\t\tkeyCode: 0x57,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* X */\n\t\t\tkeyCode: 0x58,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* Y */\n\t\t\tkeyCode: 0x59,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* Z */\n\t\t\tkeyCode: 0x5A,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* ` */\n\t\t\tkeyCode: 0xC0,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* 1 */\n\t\t\tkeyCode: 0x31,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* 2 */\n\t\t\tkeyCode: 0x32,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* 3 */\n\t\t\tkeyCode: 0x33,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* 4 */\n\t\t\tkeyCode: 0x34,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* 5 */\n\t\t\tkeyCode: 0x35,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* 6 */\n\t\t\tkeyCode: 0x36,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* 7 */\n\t\t\tkeyCode: 0x37,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* 8 */\n\t\t\tkeyCode: 0x38,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* 9 */\n\t\t\tkeyCode: 0x39,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* 0 */\n\t\t\tkeyCode: 0x30,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* - */\n\t\t\tkeyCode: 0xBD,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* = */\n\t\t\tkeyCode: 0xBB,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* [ */\n\t\t\tkeyCode: 0xDB,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* ] */\n\t\t\tkeyCode: 0xDD,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* \\ */\n\t\t\tkeyCode: 0xDC,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* ; */\n\t\t\tkeyCode: 0xBA,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* ' */\n\t\t\tkeyCode: 0xDE,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* , */\n\t\t\tkeyCode: 0xBC,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* . */\n\t\t\tkeyCode: 0xBE,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* / */\n\t\t\tkeyCode: 0xBF,\n\t\t\tshiftKey: true\n\t\t},\n\t\t{\n\t\t\t/* / */\n\t\t\tkeyCode: 0x6F\n\t\t},\n\t\t{\n\t\t\t/* * */\n\t\t\tkeyCode: 0x6A\n\t\t},\n\t\t{\n\t\t\t/* - */\n\t\t\tkeyCode: 0x6D\n\t\t},\n\t\t{\n\t\t\t/* + */\n\t\t\tkeyCode: 0x6B\n\t\t},\n\t\t{\n\t\t\t/* ⌫ */\n\t\t\tkeyCode: 0x08\n\t\t}\n\t];\n\n\tvar FOCUSABLE_SELECTOR = ['input:not([type=\"hidden\"]):not(:disabled)', ' select:not(:disabled)', 'a[href]', 'textarea:not(:disabled)', 'button:not(:disabled)', '[tabindex]'].join(',');\n\n\t// variables for alphanumeric seach\n\tvar searchString = '';\n\tvar searchStringDelay = 800;\n\tvar searchTimeout;\n\tvar whitespaceRegex = /\\s+/g;\n\tvar regexRegex = /[\\-\\[\\]{}()*+?.,\\\\\\^$|#\\s]/g;\n\n\t// Utility method to evaluate whether an node or any of its parents is hidden.\n\tvar nodeCache = {}, cacheIndex = 1;\n\tfunction isHidden(node) {\n\t\tif (node === document.documentElement) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// No need to test node if we already have tested its display/visibility.\n\t\tif (node.focusableCacheIndex) {\n\t\t\treturn nodeCache[node.focusableCacheIndex];\n\t\t}\n\n\t\tvar result = false,\n\t\t\tstyle = window.getComputedStyle(node);\n\t\tif (style.visibility === 'hidden' || style.display === 'none') {\n\t\t\tresult = true;\n\t\t}\n\t\telse if (node.parentNode) {\n\t\t\tresult = isHidden(node.parentNode);\n\t\t}\n\n\t\t// Once node has been tested store result.\n\t\tnode.focusableCacheIndex = cacheIndex;\n\t\tnodeCache[node.focusableCacheIndex] = result;\n\t\tcacheIndex++;\n\n\t\treturn result;\n\t}\n\n\tfunction onLoadEvent() {\n\t\tconsole.log(); // this is a hack to force this function to run; don't remove\n\t\tvar hadKeyboardEvent = false,\n\t\t\tkeyboardModalityWhitelist = ['input:not([type])', 'input[type=text]', 'input[type=checkbox]', 'input[type=radio]', 'input[type=number]', 'input[type=date]', 'input[type=time]', 'input[type=datetime]', 'textarea', '[role=textbox]', 'select', '[supports-modality=keyboard]'].join(',');\n\n\t\tdisableFocusRingByDefault();\n\n\t\tdocument.body.addEventListener('keydown', function(evt) {\n\t\t\thadKeyboardEvent = true;\n\t\t\tsetTimeout(function() {\n\t\t\t\thadKeyboardEvent = false;\n\t\t\t}, 0);\n\t\t}, true);\n\n\t\tdocument.body.addEventListener('focus', function(evt) {\n\t\t\tif (hadKeyboardEvent || focusTriggersKeyboardModality(evt.target)) {\n\t\t\t\tdocument.body.setAttribute('modality', 'keyboard');\n\t\t\t}\n\t\t}, true);\n\n\t\tdocument.body.addEventListener('blur', function(evt) {\n\t\t\tdocument.body.removeAttribute('modality');\n\t\t}, true);\n\n\t\tfunction disableFocusRingByDefault() {\n\t\t\tvar css = 'body:not([modality=keyboard]) :focus { outline: none; }',\n\t\t\t\thead = document.head || document.getElementsByTagName('head')[0],\n\t\t\t\tstyle = document.createElement('style');\n\n\t\t\tstyle.type = 'text/css';\n\t\t\tstyle.id = 'disable-focus-ring';\n\t\t\tif (style.styleSheet) {\n\t\t\t\tstyle.styleSheet.cssText = css;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tstyle.appendChild(document.createTextNode(css));\n\t\t\t}\n\n\t\t\thead.appendChild(style);\n\t\t}\n\n\t\tfunction focusTriggersKeyboardModality(el) {\n\t\t\treturn el.matches(keyboardModalityWhitelist);\n\t\t}\n\t}\n\n\t// there is no event that works consistently across start and fnft, so we utilize startup\n\tiaw.startup.add({\n\t\twhenDocReady: onLoadEvent.bind(this)\n\t});\n\n\treturn {\n\t\t/**\n\t\t * Static keycode constants.\n\t\t */\n\t\tKeys: {\n\t\t\tTAB: 9,\n\t\t\tENTER: 13,\n\t\t\tESC: 27,\n\t\t\tSPACE: 32,\n\t\t\tPAGEUP: 33,\n\t\t\tPAGEDOWN: 34,\n\t\t\tEND: 35,\n\t\t\tHOME: 36,\n\t\t\tLEFT: 37,\n\t\t\tUP: 38,\n\t\t\tRIGHT: 39,\n\t\t\tDOWN: 40\n\t\t},\n\n\t\t/**\n\t\t * Register keys that the host application should allow to pass through to be handled by the CEP web view.\n\t\t */\n\t\tregisterKeyEventsInterest: function() {\n\t\t\tvar keyEventsInterest = iaw.util.isWindowsOS() ? KEYS_OF_INTEREST_WIN : KEYS_OF_INTEREST_MAC;\n\t\t\tif (iaw.cepUtil.csInterface) {\n\t\t\t\tiaw.cepUtil.csInterface.registerKeyEventsInterest(JSON.stringify(keyEventsInterest));\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Returns true when a given element can receive keyboard or mouse focus.\n\t\t *\n\t\t * @param el HTMLElement An HTML element.\n\t\t * @return Boolean true when element can receive keyboard or mouse focus.\n\t\t */\n\t\tisFocusable: function(el) {\n\t\t\treturn el.matches(FOCUSABLE_SELECTOR) && !isHidden(el);\n\t\t},\n\n\t\t/**\n\t\t * Returns an array of focusable descendants of a given element ordered with elements having tabIndex > 0 coming before elements with tabIndex <= 0.\n\t\t *\n\t\t * @param el Object Parent node or selector\n\t\t * @param tabbable Boolean Return only tabbable children by excluding elements with tabIndex < 0\n\t\t * @param includeEl Boolean Include parent element in result if it is focusable.\n\t\t * @return Array Ordered array of focusable elements\n\t\t */\n\t\tfocusable: function(el, tabbable, includeEl) {\n\t\t\tif (typeof el === 'string') {\n\t\t\t\tel = document.querySelector(el);\n\t\t\t}\n\t\t\tvar basicFocusables = [],\n\t\t\t\torderedFocusables = [],\n\t\t\t\tcandidateNodelist = el.querySelectorAll(FOCUSABLE_SELECTOR),\n\t\t\t\tcandidates = Array.prototype.slice.call(candidateNodelist),\n\t\t\t\tcandidate, candidateTabIndex;\n\n\t\t\tif (includeEl) {\n\t\t\t\tcandidates.unshift(el);\n\t\t\t}\n\n\t\t\tfor (var i = 0, l = candidates.length; i < l; i++) {\n\t\t\t\tcandidate = candidates[i];\n\t\t\t\tcandidateTabIndex = candidate.tabIndex;\n\n\t\t\t\tif ((candidateTabIndex < 0 && tabbable) || isHidden(candidate)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (candidateTabIndex <= 0) {\n\t\t\t\t\tbasicFocusables.push(candidate);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\torderedFocusables.push({\n\t\t\t\t\t\ttabIndex: candidateTabIndex,\n\t\t\t\t\t\tnode: candidate\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\torderedFocusables = orderedFocusables\n\t\t\t\t.sort(function(a, b) {\n\t\t\t\t\treturn a.tabIndex - b.tabIndex;\n\t\t\t\t})\n\t\t\t\t.map(function(a) {\n\t\t\t\t\treturn a.node;\n\t\t\t\t});\n\n\t\t\tArray.prototype.push.apply(orderedFocusables, basicFocusables);\n\n\t\t\treturn orderedFocusables;\n\t\t},\n\n\t\t/**\n\t\t * Returns an array of tabbable descendants of a given element ordered with elements having\n\t\t * tabIndex > 0 coming before elements with tabIndex <= 0.\n\t\t *\n\t\t * @param el HtmlElement Parent node\n\t\t * @param includeEl Boolean Include parent element in result if it is tabbable\n\t\t * @return Array Ordered array of tabbable elements\n\t\t */\n\t\ttabbable: function(el, includeEl) {\n\t\t\tif (typeof el === 'string') {\n\t\t\t\tel = document.querySelector(el);\n\t\t\t}\n\t\t\treturn iaw.a11y.focusable(el, true, includeEl);\n\t\t},\n\n\t\t/**\n\t\t * Returns true if a given element or one of its descendants has focus.\n\t\t *\n\t\t * @param el Object Element or selector\n\t\t * @return Boolean Whether the element or one of its descendant has focus.\n\t\t */\n\t\tdescendantHasFocus: function(el) {\n\t\t\tif (typeof el === 'string') {\n\t\t\t\tel = document.querySelector(el);\n\t\t\t}\n\t\t\treturn el === document.activeElement || el.contains(document.activeElement);\n\t\t},\n\n\t\t/**\n\t\t * Returns next item from array of items by alphanumeric search\n\t\t *\n\t\t * @param evt Event Keypress event object\n\t\t * @param items Array An array of HTMLElements\n\t\t * @param currentItem HTMLElement Current item within the items array.\n\t\t * @return HTMLElement An element with text content that starts with an alphanumeric string\n\t\t */\n\t\talphanumericSearch: function(evt, items, currentItem) {\n\t\t\tvar charCode = evt.charCode,\n\t\t\t\tstringFromCharCode,\n\t\t\t\tindex = -1;\n\n\t\t\tif (charCode <= 32 || evt.ctrlKey || evt.metaKey || evt.altKey) return;\n\n\t\t\tstringFromCharCode = String.fromCharCode(charCode);\n\t\t\tif (stringFromCharCode !== searchString) {\n\t\t\t\tsearchString += String.fromCharCode(charCode);\n\t\t\t}\n\n\t\t\tclearTimeout(searchTimeout);\n\t\t\tsearchTimeout = setTimeout(function() {\n\t\t\t\tsearchString = '';\n\t\t\t}, searchStringDelay);\n\n\t\t\titems = items.filter(function(el) {\n\t\t\t\tvar textContent = el.textContent.replace(whitespaceRegex, ' ').trim();\n\t\t\t\treturn new RegExp('^' + searchString.replace(regexRegex, '\\\\$&'), 'i').test(textContent);\n\t\t\t});\n\t\t\tif (items.length) {\n\t\t\t\tindex = items.indexOf(currentItem);\n\t\t\t\tif (index === -1) {\n\t\t\t\t\treturn items[0];\n\t\t\t\t}\n\t\t\t\telse if (searchString.length > 1) {\n\t\t\t\t\treturn items;\n\t\t\t\t}\n\t\t\t\telse if (index === items.length - 1) {\n\t\t\t\t\treturn items[0];\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\treturn items[index + 1];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn;\n\t\t},\n\n\t\t/**\n\t\t * Returns next item from a grid/card layout in vertical direction\n\t\t *\n\t\t * @param items Array An array of HTMLElements\n\t\t * @param currentItem HTMLElement Current item within the items array.\n\t\t * @param up Boolean Search in the reverse or 'up' direction\n\t\t * @return HTMLElement An element adjacent to the current item vertically\n\t\t */\n\t\tgetAdjacentElementVertically: function(items, currentItem, up) {\n\t\t\tvar\tincrement = up ? -1 : 1,\n\t\t\t\ti = items.indexOf(currentItem),\n\t\t\t\trect = currentItem.getBoundingClientRect(),\n\t\t\t\trowTop = rect.top,\n\t\t\t\tcolLeft = rect.left,\n\t\t\t\tcolRight = rect.right,\n\t\t\t\tprevOrNext = items[i + increment],\n\t\t\t\tnextRowTop = null,\n\t\t\t\tcandidates = [], filtered;\n\n\t\t\ti += increment;\n\n\t\t\twhile (prevOrNext) {\n\t\t\t\trect = prevOrNext.getBoundingClientRect();\n\t\t\t\t// determine start of next row\n\t\t\t\tif (nextRowTop === null && rowTop !== rect.top) {\n\t\t\t\t\tnextRowTop = rect.top;\n\t\t\t\t}\n\t\t\t\t// in next row,\n\t\t\t\tif (nextRowTop) {\n\t\t\t\t\t// add candidates until\n\t\t\t\t\tif (nextRowTop === rect.top) {\n\t\t\t\t\t\tcandidates.push({item: prevOrNext, rect: rect});\n\t\t\t\t\t}\n\t\t\t\t\t// we reach the first card in the following row.\n\t\t\t\t\telse {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ti += increment;\n\t\t\t\tprevOrNext = items[i];\n\t\t\t}\n\t\t\t// sort candidates from left to right\n\t\t\t// @todo We may need to be aware of right-to-left languages when sorting.\n\t\t\tcandidates = candidates.sort(function(a, b) {\n\t\t\t\treturn a.rect.left > b.rect.left;\n\t\t\t});\n\t\t\t// filter candidates based whether they overlap with the current card\n\t\t\tfiltered = candidates.filter(function(candidate) {\n\t\t\t\trect = candidate.rect;\n\t\t\t\treturn (colLeft === rect.left || colRight === rect.right ||\n\t\t\t\t\t(colLeft > rect.left && colRight < rect.right));\n\t\t\t});\n\t\t\t// Return the first candidate that overlaps with the current card,\n\t\t\tif (filtered.length) {\n\t\t\t\treturn filtered[0].item;\n\t\t\t}\n\t\t\t// or return the last item in the next row.\n\t\t\telse if (candidates.length) {\n\t\t\t\treturn candidates[candidates.length - 1].item;\n\t\t\t}\n\t\t\treturn;\n\t\t},\n\n\t\t/**\n\t\t * TrapFocus is used to trap keyboard focus within a DOM node.\n\t\t * @returns Class iaw.a11y.TrapFocus class instance\n\t\t */\n\t\tTrapFocus: function() {\n\t\t\tvar trap,\n\t\t\t\ttabbables,\n\t\t\t\tlastFocused,\n\t\t\t\tisActive,\n\t\t\t\tconfig;\n\n\t\t\t/**\n\t\t\t * Activate traps keyboard focus within given DOM node or selector.\n\t\t\t * <p>\n\t\t\t * Options:\n\t\t\t * <ul>\n\t\t\t *  <li><b>initialFocus:</b> By default, focus will be set to the\n\t\t\t *  first element in the element's tab order, but by declaring the\n\t\t\t *  <b>initialFocus</b> you can specify which specific element or\n\t\t\t *  selector will receive focus.</li>\n\t\t\t *  <li><b>onDeactivate:</b> A callback method to be executed when\n\t\t\t *  the focus trap is deactivated</li>\n\t\t\t * </ul>\n\t\t\t *\n\t\t\t * @param Object el HTMLselector\n\t\t\t * @param Object Options object containing intialFocus and/or onDeactivate callback method.\n\t\t\t */\n\t\t\tfunction activate(el, options) {\n\t\t\t\t// There can be only one focus trap at a time\n\t\t\t\tif (isActive) deactivate();\n\t\t\t\tisActive = true;\n\n\t\t\t\ttrap = (typeof el === 'string') ? document.querySelector(el) : el;\n\t\t\t\tconfig = options || {};\n\t\t\t\tlastFocused = document.activeElement;\n\n\t\t\t\tupdateTabbables();\n\n\t\t\t\tfocus(initialFocus());\n\n\t\t\t\tdocument.addEventListener('focus', onFocus, true);\n\t\t\t\tdocument.addEventListener('click', onClick, true);\n\t\t\t\tdocument.addEventListener('keydown', onKeyDown, true);\n\n\t\t\t\tsetModal(trap, true);\n\t\t\t}\n\t\t\t/**\n\t\t\t * Returns the HTMLElement that should receive initial focus when\n\t\t\t * the focus trap has been activated.\n\t\t\t *\n\t\t\t * @return HTMLElement Element to receive initial focus\n\t\t\t */\n\t\t\tfunction initialFocus() {\n\t\t\t\tvar node;\n\n\t\t\t\tif (!config.initialFocus) {\n\t\t\t\t\tnode = tabbables[0];\n\t\t\t\t\tif (!node) {\n\t\t\t\t\t\tthrow new Error('You can\\'t have a focus-trap without at least one focusable element');\n\t\t\t\t\t}\n\t\t\t\t\treturn node;\n\t\t\t\t}\n\n\t\t\t\tif (typeof config.initialFocus === 'string') {\n\t\t\t\t\tnode = document.querySelector(config.initialFocus);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tnode = config.initialFocus;\n\t\t\t\t}\n\t\t\t\tif (!node) {\n\t\t\t\t\tthrow new Error('The `initialFocus` selector you passed refers to no known node');\n\t\t\t\t}\n\t\t\t\treturn node;\n\t\t\t}\n\t\t\t/**\n\t\t\t * Deactivate the focus trap, call onDeactivate callback method,\n\t\t\t * and restore focus to the last element that had focus before\n\t\t\t * the trap was activated if the focus hasn't been shifted\n\t\t\t * to some other element.\n\t\t\t */\n\t\t\tfunction deactivate() {\n\t\t\t\tif (!isActive) return;\n\t\t\t\tisActive = false;\n\n\t\t\t\tdocument.removeEventListener('focus', onFocus, true);\n\t\t\t\tdocument.removeEventListener('click', onClick, true);\n\t\t\t\tdocument.removeEventListener('keydown', onKeyDown, true);\n\n\t\t\t\tsetModal(trap, false);\n\n\t\t\t\tif (config.onDeactivate) {\n\t\t\t\t\tconfig.onDeactivate();\n\t\t\t\t}\n\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tif (iaw.a11y.descendantHasFocus(trap) ||\n\t\t\t\t\t\t\t(!document.activeElement || document.body === document.activeElement)) {\n\t\t\t\t\t\tfocus(lastFocused);\n\t\t\t\t\t}\n\t\t\t\t}, 0);\n\t\t\t}\n\t\t\t/**\n\t\t\t * Handle click event when trap is active, to ensure that elements\n\t\t\t * outside focus trap do not respond to click events.\n\t\t\t * @param MouseEvent evt Click event\n\t\t\t */\n\t\t\tfunction onClick(evt) {\n\t\t\t\tif (trap.contains(evt.target)) return;\n\t\t\t\tevt.preventDefault();\n\t\t\t\tevt.stopImmediatePropagation();\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Handle focus event when trap is active, to ensure that elements\n\t\t\t * outside focus trap do not receive focus.\n\t\t\t * @param FocusEvent evt Focus event\n\t\t\t */\n\t\t\tfunction onFocus(evt) {\n\t\t\t\tupdateTabbables();\n\t\t\t\tif (trap.contains(evt.target)) return;\n\t\t\t\tfocus(tabbables[0]);\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Handle key down event when trap is active to respond to the TAB\n\t\t\t * key or the ESC key, which should deactivate the focus trap.\n\t\t\t * @param KeyboardEvent evt Keyboard event\n\t\t\t */\n\t\t\tfunction onKeyDown(evt) {\n\t\t\t\tif (evt.keyCode === iaw.a11y.Keys.TAB) {\n\t\t\t\t\thandleTabKey(evt);\n\t\t\t\t}\n\n\t\t\t\tif (evt.keyCode === iaw.a11y.Keys.ESC) {\n\t\t\t\t\tdeactivate();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Handle TAB key when trap is active to ensure that focus stays\n\t\t\t * within the focus trap.\n\t\t\t * @param KeyboardEvent evt Keyboard event\n\t\t\t */\n\t\t\tfunction handleTabKey(evt) {\n\t\t\t\tevt.preventDefault();\n\t\t\t\tupdateTabbables();\n\t\t\t\tvar targ = evt.target;\n\t\t\t\tvar index = tabbables.indexOf(targ);\n\t\t\t\tvar last = tabbables[tabbables.length - 1];\n\t\t\t\tvar first = tabbables[0];\n\t\t\t\tif (evt.shiftKey) {\n\t\t\t\t\tif (evt.target === first) {\n\t\t\t\t\t\tfocus(last);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tfocus(tabbables[index - 1]);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (targ === last) {\n\t\t\t\t\tfocus(first);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tfocus(tabbables[index + 1]);\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Update array of tabbable elements within the focus trap.\n\t\t\t */\n\t\t\tfunction updateTabbables() {\n\t\t\t\ttabbables = iaw.a11y.tabbable(trap, true);\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Set focus to an HTMLElement node.\n\t\t\t * @param HTMLElementnode HTMLElement node to receive focus.\n\t\t\t */\n\t\t\tfunction focus(node) {\n\t\t\t\tif (!node || !node.focus) return;\n\t\t\t\tif (node === initialFocus() && !iaw.a11y.isFocusable(node)) {\n\t\t\t\t\tnode.tabIndex = -1;\n\t\t\t\t\tnode.addEventListener('blur', function blurred() {\n\t\t\t\t\t\tnode.removeAttribute('tabIndex');\n\t\t\t\t\t\tnode.removeEventListener('blur', blurred);\n\t\t\t\t\t}, true);\n\t\t\t\t}\n\t\t\t\tnode.focus();\n\t\t\t\tif (node.tagName.toLowerCase() === 'input') {\n\t\t\t\t\tnode.select();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Hide siblings of an HTMLElement node from assistive technology\n\t\t\t * using `aria-hidden`, so that it is not possible to read elements\n\t\t\t * outside of the given node with a screen reader.\n\t\t\t * @param HTMLElement node HTMLElement node to receive focus.\n\t\t\t */\n\t\t\tfunction setModal(node, bool) {\n\t\t\t\tif (!node) return;\n\n\t\t\t\tvar parentNode = node.parentNode,\n\t\t\t\t\tsiblings, sibling, cachedAriaHidden;\n\t\t\t\twhile (parentNode !== document.documentElement) {\n\t\t\t\t\tsiblings = Array.prototype.slice.call(parentNode.children);\n\t\t\t\t\tArray.prototype.splice.call(siblings, siblings.indexOf(node), 1);\n\t\t\t\t\tfor (var i = 0, l = siblings.length; i < l; i++) {\n\t\t\t\t\t\tsibling = siblings[i];\n\t\t\t\t\t\tif (sibling.tagName !== 'AREA' &&\n\t\t\t\t\t\t\t\tsibling.tagName !== 'BASE' &&\n\t\t\t\t\t\t\t\tsibling.tagName !== 'BASEFONT' &&\n\t\t\t\t\t\t\t\tsibling.tagName !== 'BR' &&\n\t\t\t\t\t\t\t\tsibling.tagName !== 'COL' &&\n\t\t\t\t\t\t\t\tsibling.tagName !== 'LINK' &&\n\t\t\t\t\t\t\t\tsibling.tagName !== 'META' &&\n\t\t\t\t\t\t\t\tsibling.tagName !== 'PARAM' &&\n\t\t\t\t\t\t\t\tsibling.tagName !== 'SCRIPT' &&\n\t\t\t\t\t\t\t\tsibling.tagName !== 'STYLE') {\n\t\t\t\t\t\t\tif (bool) {\n\t\t\t\t\t\t\t\tcachedAriaHidden = sibling.getAttribute('aria-hidden');\n\t\t\t\t\t\t\t\tif (cachedAriaHidden) {\n\t\t\t\t\t\t\t\t\tsibling.setAttribute('data-aria-hidden', cachedAriaHidden);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tsibling.setAttribute('aria-hidden', 'true');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tcachedAriaHidden = sibling.getAttribute('data-aria-hidden');\n\t\t\t\t\t\t\t\tif (cachedAriaHidden) {\n\t\t\t\t\t\t\t\t\tsibling.setAttribute('aria-hidden', cachedAriaHidden);\n\t\t\t\t\t\t\t\t\tsibling.removeAttribute('data-aria-hidden');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\tsibling.removeAttribute('aria-hidden');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tnode = parentNode;\n\t\t\t\t\tparentNode = parentNode.parentNode;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tactivate: activate,\n\t\t\t\tdeactivate: deactivate\n\t\t\t};\n\t\t}()\n\t};\n}();\n","/*************************************************************************\n * ADOBE CONFIDENTIAL\n * ___________________\n *\n *  Copyright 2015 Adobe Systems Incorporated\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe Systems Incorporated and its suppliers,\n * if any.  The intellectual and technical concepts contained\n * herein are proprietary to Adobe Systems Incorporated and its\n * suppliers and are protected by all applicable intellectual property\n * laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe Systems Incorporated.\n **************************************************************************/\n\n/*global Ingest*/\n\n/**\n * Simple singleton style container so all analytics related stuff has a centralized point.\n */\nvar iaw = iaw||{};\n\niaw.analytics = {\n\n\t/**\n\t * Override to turn analytics on or off\n\t */\n\tenabled: false,\n\n\tpipQuery: {\n\t\t//Events\n\t\tcategory: 'Mobile Creations',\n\t\tpipAware: {\n\t\t\tsubCategory: 'See Start Screen',\n\t\t\teventName: 'See Start Screen'\n\t\t},\n\t\tpipTry: {\n\t\t\tsubCategory: 'Click Mobile Creations',\n\t\t\teventName : 'Click Mobile Creations'\n\t\t},\n\t\tpipSucceedProject: {\n\t\t\tsubCategory: 'Open Mobile Creations',\n\t\t\teventName: 'Open Mobile Creations'\n\t\t},\n\t\tpipSucceedProjectFile: {\n\t\t\tsubCategory: 'Open Mobile Creations',\n\t\t\teventName : 'Open App Page'\n\t\t},\n\t\tpipNoAssetUI: {\n\t\t\tsubCategory : 'No Mobile Creations',\n\t\t\teventName : 'See No Asset UI'\n\t\t},\n\t\tpipGetApp: {\n\t\t\tsubCategory : 'No Mobile Creations',\n\t\t\teventName : 'Click on Get App'\n\t\t},\n\t\tpipTimeOutOnMCClick: {\n\t\t\tsubCategory: 'TimeOutOnMCClick',\n\t\t\teventName: 'TimeOutOnMCClick'\n\t\t},\n\t\tpipTimeOutOnProjectClick: {\n\t\t\tsubCategory: 'TimeOutOnProjectClick',\n\t\t\teventName: 'TimeOutOnProjectClick'\n\t\t},\n\t\tpipTimeOutOnFileClick: {\n\t\t\tsubCategory: 'TimeOutOnFileClick',\n\t\t\teventName: 'TimeOutOnFileClick'\n\t\t},\n\t\tpipTryAgainOnMCClick: {\n\t\t\tsubCategory: 'TryAgainOnMCClick',\n\t\t\teventName: 'TryAgainOnMCClick'\n\t\t},\n\t\tpipTryAgainOnProjectClick: {\n\t\t\tsubCategory: 'TryAgainOnProjectClick',\n\t\t\teventName: 'TryAgainOnProjectClick'\n\t\t},\n\t\tpipTryAgainOnFileClick: {\n\t\t\tsubCategory: 'TryAgainOnFileClick',\n\t\t\teventName: 'TryAgainOnFileClick'\n\t\t}\n\t},\n\n\t/**\n\t * Configure analytics for future analytics calls.\n\t *\n\t * @param client        client ID string\n\t * @param hostData      data from the host\n\t * @param psdkData      data fron the PSDK\n\t * @param mode          string indicating the server mode (prod, stage, or dev)\n\t */\n\tconfig: function(client, hostData, psdkData, mode) {\n\n\t\tthis.enabled = hostData.userTrackingEnabled;\n\t\tthis.ingest.configure(client, hostData, psdkData, mode);\n\t},\n\n\t/**\n\t * Compose the passed URL for proper analytics logging - this means\n\t * adding in analytic query params and moving any deep links to the end.\n\t * This is primarily for Adobe Learn.\n\t *\n\t * @param url\t original URL to add analytic params into\n\t * @return String containing the URL properly ordered with analytics query arguments.\n\t */\n\tcomposeURLWithAnalyticsQueryString: function(url) {\n\n\t\tvar composedURL = url;\n\n\t\tif (composedURL) {\n\t\t\tvar analyticsQuery\t= this.getAnalyticsQueryString();\n\n\t\t\t// check for deep links\n\t\t\tvar deepLinkIndex\t= composedURL.indexOf('#');\n\t\t\tvar deepLink\t\t= '';\n\n\t\t\tif (deepLinkIndex >= 0) {\n\t\t\t\tdeepLink = composedURL.substr(deepLinkIndex);\n\t\t\t\tcomposedURL = composedURL.substr(0, deepLinkIndex);\n\t\t\t}\n\n\t\t\t// check for existing query which it could have\n\t\t\tvar querySep = ((composedURL.indexOf('?') < 0) ? '?' : '&');\n\n\t\t\tcomposedURL += (querySep + analyticsQuery + deepLink);\n\t\t}\n\n\t\treturn composedURL;\n\t},\n\n\n\t/**\n\t * Build the passthrough analytics string for\n\t *\n\t * @return String containing the query arguments.\n\t */\n\tgetAnalyticsQueryString: function() {\n\n\t\tvar hostData = iaw.store.get('host');\n\n\t\treturn 'locale='+hostData.language+\n\t\t\t\t'&x-product='+hostData.hostID+'%2F'+hostData.appVersion+\n\t\t\t\t'&x-product-location=CCXStart-'+hostData.displayMode+'%2F'+hostData.radarVersion+\n\t\t\t\t'&x-radarSession='+hostData.radarSessionGUID+\n\t\t\t\t'&x-appSession='+hostData.sessionGUID+\n\t\t\t\t'&ute='+hostData.userTrackingEnabled;\n\t},\n\n\t/**\n\t * AdobePIP/Highbeam Analytics\n\t */\n\tpip: {\n\t\tkCategory: 'CCXStart',\n\t\tfnftCategory: 'CCXFNFT',\n\n\t\t/**\n\t\t * Log Highbeam events to the hosting application.\n\t\t *\n\t\t * @param pipCategory       Highbeam category classification string\n\t\t * @param pipSubCategory    Highbeam sub-category classification string\n\t\t * @param pipEvent          Highbeam event name string\n\t\t */\n\t\tlogEvent: function( pipCategory, pipSubCategory, pipEvent ) {\n\t\t\tif ( iaw.analytics.enabled ) {\n\t\t\t\tif ( pipEvent ) {\n\t\t\t\t\t// Highbeam events are limited to 128 characters\n\t\t\t\t\tpipEvent = (pipEvent.length < 128) ? pipEvent: pipEvent.substr(0, 127);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar pipJSO = {\n\t\t\t\t\tdataType: 'event',\n\t\t\t\t\tcategory: pipCategory,\n\t\t\t\t\tsubcategory: pipSubCategory,\n\t\t\t\t\teventname: pipEvent\n\t\t\t\t};\n\n\t\t\t\tvar pipJSON = JSON.stringify( pipJSO );\n\n\t\t\t\tif ( iaw.cepUtil ) {\n\t\t\t\t\tiaw.cepUtil.sendEvent( iaw.cepUtil.events.LOGPIP, pipJSON );\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Log Highbeam group data to the hosting application.\n\t\t *\n\t\t * @param pipGroupName\t\tHighbeam group name\n\t\t * @param data\t\t\t\tHighbeam group data\n\t\t * @param category\t\t\tHighbeam group category\n\t\t * @param subcategory\t\tHighbeam group subcategory\n\t\t */\n\t\tlogDataGroupEvent: function( pipGroupName, data, category, subcategory ) {\n\n\t\t\tif (iaw.analytics.enabled) {\n\t\t\t\tvar group_Data_Array = [];\n\n\t\t\t\tif (data) {\n\t\t\t\t\tObject.keys(data).forEach(function(key) {\n\t\t\t\t\t\tgroup_Data_Array.push({\n\t\t\t\t\t\t\t'columnname': key,\n\t\t\t\t\t\t\t'value': data[key].toString()\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tvar pipJSON = {\n\t\t\t\t\tdataType: 'group',\n\t\t\t\t\tcategory: category,\n\t\t\t\t\tsubcategory: subcategory,\n\t\t\t\t\tgroupname: pipGroupName,\n\t\t\t\t\tGroup_Data_Array: group_Data_Array\n\t\t\t\t};\n\n\t\t\t\tpipJSON = JSON.stringify( pipJSON );\n\n\t\t\t\tif ( iaw.cepUtil ) {\n\t\t\t\t\tiaw.cepUtil.sendEvent( iaw.cepUtil.events.LOGPIP, pipJSON );\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Log Highbeam group data to the hosting application for FNFT. For PHXS only so far.\n\t\t *\n\t\t */\n\t\tlogFNFTDataGroupEvent: function( pipGroupName, data ) {\n\t\t\t// For PHXS only so far.\n\t\t\tif ('PHXS' === iaw.store.get(['host', 'hostID'])) {\n\t\t\t\tthis.logDataGroupEvent(pipGroupName, data, this.fnftCategory, 'Interaction');\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Utility method to log an 'Interaction' event.\n\t\t *\n\t\t * @param interactionEvent  event to log\n\t\t */\n\t\tlogInteractionEvent: function( interactionEvent ) {\n\n\t\t\tthis.logEvent( this.kCategory, 'Interaction', interactionEvent );\n\t\t},\n\n\t\t/**\n\t\t * Utility method to log an 'Interaction' event for FNFT. For PHXS only so far.\n\t\t *\n\t\t * @param interactionEvent  event to log\n\t\t */\n\t\tlogFNFTInteractionEvent: function( interactionEvent ) {\n\n\t\t\tif ('PHXS' === iaw.store.get(['host', 'hostID'])) {\n\t\t\t\tthis.logEvent( this.fnftCategory, 'Interaction', interactionEvent );\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Utility method to log an 'Failure' event.\n\t\t *\n\t\t * @param failEvent         event to log\n\t\t */\n\t\tlogFailureEvent: function( failEvent ) {\n\n\t\t\tthis.logEvent( this.kCategory, 'Failure', failEvent );\n\t\t}\n\t}, // end of pip container\n\n\t/**\n\t * Ingest Analytics\n\t */\n\tingest: {\n\t\t/**\n\t\t * Ingest configuration objects\n\t\t */\n\n\t\timsToken: null,\n\t\tingestLibReady: false,\n\t\tinstance: null,\n\t\tpsdkData: null,\n\n\t\tbasePayloadData: {\n\t\t\teventType:\t\t\tnull,\n\t\t\teventGUID:\t\t\tnull,\n\t\t\tdts:\t\t\t\tnull,\n\t\t\tuserGUID:\t\t\tnull,\n\t\t\tsubscriptionStatus:\tnull,\n\t\t\tproductName:\t\tnull,\n\t\t\tproductVersion:\t\tnull,\n\t\t\tproductLanguage:\tnull,\n\t\t\tdisplayCount:\t\t0,\n\t\t\tradarVersion:\t\tnull,\n\t\t\tuserAgent:\t\t\tnavigator.userAgent,\n\t\t\tradarSessionGUID:\tnull,\n\t\t\tappSessionGUID:\t\tnull\n\t\t},\n\n\t\trenderedCards: {},  // map of rendered card events\n\n\t\t// since many things load asynchronously, some event actions can happen before\n\t\t// the Ingest lib scripts have completed - therefore we pre-queue some events\n\t\t// that get processed once the lib is ready\n\t\tprequeuedEvents: [],\n\n\t\t/**\n\t\t * Configure Ingest for future analytics calls.\n\t\t *\n\t\t * @param client        client ID string\n\t\t * @param hostData      data from the host\n\t\t * @param psdkData      data fron the PSDK\n\t\t * @param mode          string indicating the server mode (prod, stage, or dev)\n\t\t */\n\t\tconfigure: function( client, hostData, psdkData, mode ) {\n\t\t\tvar self = this;\n\t\t\tmode = mode || 'prod';\n\t\t\tthis.psdkData = psdkData;\n\n\t\t\t// Ingest.js library configuration\n\t\t\tvar options = {\n\t\t\t\tENVIRONMENT: mode,\n\t\t\t\tANALYTICS_API_KEY: client,\n\t\t\t\tANALYTICS_X_PRODUCT: hostData.hostID+'%2F'+hostData.appVersion,\n\t\t\t\tANALYTICS_PROJECT: 'ccxservice',\n\t\t\t\tANALYTICS_USER_REGION: hostData.countryCode,\n\t\t\t\tANALYTICS_INGEST_TYPE: 'dunamis',\n\t\t\t\tANALYTICS_MAX_QUEUED_EVENTS: 50,\n\t\t\t\tANALYTICS_DEBOUNCE: 0,\n\t\t\t\tTIMESTAMP_PROPERTY_NAME: 'event.dts_end'\n\t\t\t};\n\n\t\t\tvar dependencies = {\n\t\t\t\tlog: function(msg) {\n\t\t\t\t\tiaw.log.console(msg);\n\t\t\t\t},\n\t\t\t\tgetAccessToken: function(callback) {\n\t\t\t\t\tif (self.imsToken) {\n\t\t\t\t\t\tcallback(null, self.imsToken);\n\t\t\t\t\t}\n\t\t\t\t\telse { // handle case when no IMS token is available\n\t\t\t\t\t\tiaw.cepUtil.getIMSAccessToken(function( token ) {\n\t\t\t\t\t\t\tself.imsToken = token;\n\t\t\t\t\t\t\tcallback(null, token);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tclearAccessToken: function() {\n\t\t\t\t\tself.imsToken = null;\n\t\t\t\t\tiaw.cepUtil.clearAccessToken();\n\t\t\t\t}\n\t\t\t};\n\t\t\t// Get Ingest instance (Ingest supports multiple instances since v1.0)\n\t\t\tthis.instance = Ingest.createInstance(dependencies, options);\n\t\t\tthis.instance.enable(iaw.analytics.enabled);\n\n\t\t\t// configure basic payload\n\t\t\tthis.basePayloadData.userGUID           = hostData.adobeGUID;\n\t\t\tthis.basePayloadData.subscriptionStatus = hostData.accountStatus;\n\t\t\tthis.basePayloadData.productName        = hostData.hostID;\n\t\t\tthis.basePayloadData.productVersion     = hostData.appVersion;\n\t\t\tthis.basePayloadData.productLanguage    = hostData.language;\n\t\t\tthis.basePayloadData.displayCount       = hostData.displayCount;\n\t\t\tthis.basePayloadData.radarVersion       = hostData.radarVersion;\n\t\t\tthis.basePayloadData.modeID             = hostData.displayMode;\n\t\t\tthis.basePayloadData.radarSessionGUID   = hostData.radarSessionGUID;\n\t\t\tthis.basePayloadData.appSessionGUID     = hostData.sessionGUID;\n\t\t\tif (hostData.displayMode !== 'fnft') {\n\t\t\t\tthis.basePayloadData.appLaunchCount = hostData.launchCount;\n\t\t\t}\n\t\t\tthis.basePayloadData.AUMSegments        = null;\n\t\t\tthis.basePayloadData.hvaFlow\t\t\t= null;\n\t\t\tthis.basePayloadData.displayMode\t\t= null;\n\t\t\tif (psdkData) {\n\t\t\t\tthis.basePayloadData.AUMSegments = psdkData.segmentID || 'none';\n\t\t\t\tthis.basePayloadData.hvaFlow = psdkData.hvaFlow || 'none';\n\n\t\t\t\t// find the control card section for this display mode\n\t\t\t\tfor (var index = 0; index < psdkData.cardControl.length && !this.basePayloadData.displayMode; index++) {\n\t\t\t\t\tif ( psdkData.cardControl[index].modeID === hostData.displayMode ) {\n\t\t\t\t\t\tthis.basePayloadData.displayMode = psdkData.cardControl[index].cardOrder.toString();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// we only want to add the trialEndDts parameter if we are a trial account\n\t\t\tif (hostData.accountStatus !== 'paid' && hostData.secondsLeftInTrial !== undefined) {\n\t\t\t\tvar trialEndDts = window.moment().add(window.moment.duration(hostData.secondsLeftInTrial, 'seconds'));\n\n\t\t\t\tthis.basePayloadData.trialEndDts = trialEndDts.format('YYYY-MM-DDTHH:mm:ss.SSSZZ');\n\t\t\t}\n\n\t\t\tiaw.log.console('Ingest configured ('+mode+')');\n\t\t\tthis.ingestLibReady = true;\n\n\t\t\t// now handle any prequeued events\n\t\t\tthis.processPrequeuedEvents();\n\t\t},\n\n\t\t/**\n\t\t * Create a clone of the Ingest base payload data.\n\t\t *\n\t\t * @param needsAEMData\t\tboolean flag to indicated that AEM card data is needed in the payload\n\t\t * @return A new object based off the preset payload data.\n\t\t */\n\t\tcreatePayload: function(needsAEMData) {\n\n\t\t\tvar payload = JSON.parse(JSON.stringify(this.basePayloadData));\n\n\t\t\tpayload.eventGUID = iaw.util.generateGUID();\n\n\t\t\tif (!needsAEMData) {\n\t\t\t\tdelete payload.AUMSegments;\n\t\t\t\tdelete payload.hvaFlow;\n\t\t\t\tdelete payload.displayMode;\n\t\t\t}\n\t\t\treturn payload;\n\t\t},\n\n\t\t/**\n\t\t * If the Ingest library is not loaded/configured prior to calling a postEvent,\n\t\t * then the event gets pre-queued. So once the library is ready then we process\n\t\t * all the events.\n\t\t */\n\t\tprocessPrequeuedEvents: function() {\n\n\t\t\tvar self = this;\n\n\t\t\tthis.prequeuedEvents.forEach(function(payload) {\n\n\t\t\t\t// update base payload properties - dont use iaw.util.assign here\n\t\t\t\t// as it would overwrite properties we dont want\n\t\t\t\tfor (var prop in self.basePayloadData) {\n\t\t\t\t\tif (!payload[prop] && self.basePayloadData[prop]) {\n\t\t\t\t\t\tpayload[prop] = self.basePayloadData[prop];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tself.postEvent(payload);\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * Post the analytics call to the Ingest data server.\n\t\t *\n\t\t * @param payload           payload data to send\n\t\t */\n\t\tpostEvent: function( payload ) {\n\t\t\tif (this.ingestLibReady) {\n\t\t\t\tif (payload.debugIt) {\n\t\t\t\t\twindow.alert(JSON.stringify(payload));\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.instance.postEvent(payload);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.prequeuedEvents.push(payload);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Flush the queued events to the Ingest data server.\n\t\t *\n\t\t */\n\t\tflushEvent: function() {\n\t\t\tif (this.ingestLibReady) {\n\t\t\t\tthis.instance.flush(true);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Log a screen state event.\n\t\t *\n\t\t * @param mode      values: 'open', 'close-manual', 'close-auto', 'do-not-show'\n\t\t */\n\t\tlogScreenStateEvent: function( mode ) {\n\t\t\tvar ingestPayloadData = this.createPayload();\n\n\t\t\tingestPayloadData.eventType          = 'screen-state';\n\t\t\tingestPayloadData.welcomeScreenState = mode;\n\n\t\t\tthis.postEvent(ingestPayloadData);\n\t\t},\n\n\t\t/**\n\t\t * Log a Ingest event on the PSDK engagement card.\n\t\t *\n\t\t * @param type              type of event\n\t\t * @param cardData          card data from the PSDK\n\t\t */\n\t\tlogEngagementCardEvent: function( type, cardData ) {\n\n\t\t\tif ((type === 'rendered' && (!this.renderedCards[cardData.cardID])) ||\n\t\t\t\t(type !== 'rendered')) {\n\t\t\t\tvar ingestPayloadData = this.createPayload(true);\n\n\t\t\t\tswitch (type) {\n\t\t\t\t\tcase 'rendered':\n\t\t\t\t\t\tingestPayloadData.eventType = 'eng-card-rendered';\n\t\t\t\t\t\tthis.renderedCards[cardData.cardID] = true;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'clicked':\n\t\t\t\t\t\tingestPayloadData.eventType = 'eng-card-click';\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tiaw.log.conosle('Invalid Ingest card event');\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tingestPayloadData.cardTypeID         = cardData.cardTypeID;\n\t\t\t\tingestPayloadData.cardTypeName       = cardData.cardType;\n\t\t\t\tingestPayloadData.cardID             = cardData.cardID;\n\t\t\t\tingestPayloadData.cardName           = cardData.cardName;\n\t\t\t\tingestPayloadData.width              = cardData.width;\n\t\t\t\tingestPayloadData.displayTemplate    = cardData.displayTemplate    || '';\n\t\t\t\tingestPayloadData.startDTS           = cardData.startDTS           || '';\n\t\t\t\tingestPayloadData.endDTS             = cardData.endDTS             || '';\n\t\t\t\tingestPayloadData.actionURL          = cardData.actionURL          || '';\n\t\t\t\tingestPayloadData.urlLinkType        = cardData.urlLinkType        || '';\n\n\t\t\t\t// invertPresentation is a boolean - so usual logic above doesnt work\n\t\t\t\tingestPayloadData.invertPresentation = (typeof cardData.invertPresentation !== 'undefined') ? cardData.invertPresentation: 'n/a';\n\n\t\t\t\t// optional params, some are not implemented yet in AEM,\n\t\t\t\t// so strip them out until they are\n\t\t\t\tif ( cardData.campaignCode ) {\n\t\t\t\t\tingestPayloadData.campaignCode = cardData.campaignCode;\n\t\t\t\t}\n\t\t\t\tif ( cardData.recipe ) {\n\t\t\t\t\tingestPayloadData.recipe = cardData.recipe;\n\t\t\t\t}\n\t\t\t\tif ( cardData.aumSegments ) {\n\t\t\t\t\tingestPayloadData.aumSegments = cardData.aumSegments;\n\t\t\t\t}\n\t\t\t\t// price copy is only present on offer cards\n\t\t\t\tif ( cardData.priceCopy ) {\n\t\t\t\t\tingestPayloadData.priceCopy = cardData.priceCopy;\n\t\t\t\t}\n\t\t\t\t// some cards like AdobeStock, may have a promo ID, if so, then log it\n\t\t\t\tif ( cardData.promoID ) {\n\t\t\t\t\tingestPayloadData.promoID = cardData.promoID;\n\t\t\t\t}\n\t\t\t\t// only present on AdobeStock cards\n\t\t\t\tif ( cardData.as_query ) {\n\t\t\t\t\tingestPayloadData.actionURL = ingestPayloadData.actionURL+'&'+cardData.as_query;\n\t\t\t\t}\n\t\t\t\t// playlists fields present on all engagement stream cards\n\t\t\t\tif (this.psdkData) {\n\t\t\t\t\tingestPayloadData.eventParams = {\n\t\t\t\t\t\t'persona': this.psdkData.persona || 'none',\n\t\t\t\t\t\t'skill': this.psdkData.skill || 'none',\n\t\t\t\t\t\t'appLaunchBucket': this.psdkData.appLaunchBucket || 'none',\n\t\t\t\t\t\t'entitlement': this.psdkData.entitlement || 'none',\n\t\t\t\t\t\t'entitlementType': this.psdkData.entitlementType || 'none',\n\t\t\t\t\t\t'marketSegment': this.psdkData.marketSegment || 'none',\n\t\t\t\t\t\t'derivedPersona': this.psdkData.derivedPersona || 'none',\n\t\t\t\t\t\t'derivedSkill': this.psdkData.derivedSkill || 'none',\n\t\t\t\t\t\t'derivedAppLaunchBucket': this.psdkData.derivedAppLaunchBucket || 'none',\n\t\t\t\t\t\t'bonusLaunch': this.psdkData.bonusLaunch || 'none',\n\t\t\t\t\t\t'ccxVersion': this.psdkData.ccxVersion || 'none',\n\t\t\t\t\t\t'radarSessionGUID': this.psdkData.radarSessionGUID || 'none'\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tthis.postEvent(ingestPayloadData);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Log a view change event.\n\t\t *\n\t\t * @param viewData           view data to log\n\t\t */\n\t\tlogViewChangeEvent: function( viewData ) {\n\n\t\t\tvar ingestPayloadData = this.createPayload();\n\n\t\t\tingestPayloadData.eventType     = 'uc-section';\n\t\t\tingestPayloadData.sectionView   = viewData.sectionView;\n\t\t\tingestPayloadData.sectionType   = viewData.sectionType;\n\t\t\tthis.postEvent(ingestPayloadData);\n\t\t},\n\n\t\t/**\n\t\t * Log a file/lib/etc. open event.\n\t\t *\n\t\t * @param itemData          item data to log\n\t\t */\n\t\tlogItemOpenedEvent: function( itemData ) {\n\n\t\t\tvar ingestPayloadData = this.createPayload();\n\n\t\t\tingestPayloadData.eventType     = 'uc-file-open';\n\t\t\tingestPayloadData.fileType      = itemData.fileType;\n\t\t\tingestPayloadData.fileOpenType  = itemData.openType;\n\t\t\tingestPayloadData.sectionView\t= itemData.sectionView;\n\t\t\tif (typeof itemData.itemPosition !== 'undefined') {\n\t\t\t\tingestPayloadData.itemPosition  = itemData.itemPosition;\n\t\t\t}\n\t\t\tif (itemData.ucAction) {\n\t\t\t\tingestPayloadData.ucAction = itemData.ucAction;\n\t\t\t}\n\t\t\tif (itemData.cardID) {\n\t\t\t\tingestPayloadData.cardID = itemData.cardID;\n\t\t\t}\n\t\t\tif (itemData.eventAction) {\n\t\t\t\tingestPayloadData.eventAction = itemData.eventAction;\n\t\t\t}\n\t\t\tthis.postEvent(ingestPayloadData);\n\t\t},\n\n\t\t/**\n\t\t * Log a miscellaneous event.\n\t\t *\n\t\t * @param itemData          item data to log\n\t\t */\n\t\tlogMiscellaneousEvent: function( itemData ) {\n\n\t\t\tvar ingestPayloadData = this.createPayload();\n\n\t\t\tingestPayloadData.eventType = itemData.eventType || 'uc-misc';\n\n\t\t\tfor (var key in itemData) {\n\t\t\t\tingestPayloadData[key] = itemData[key];\n\t\t\t}\n\n\t\t\tthis.postEvent(ingestPayloadData);\n\t\t},\n\n\t\t/**\n\t\t * Log a Ingest event on the Mobile Creations item.\n\t\t *\n\t\t * @param eventAction       render,click, or open\n\t\t * @param cardTypeName\t\tnull/project/pages/appcards/appdetail\n\t\t * @param cardName\t\t\twill be null in most cases, added here for future expansion\n\t\t */\n\t\tlogMobileCreationsEvent: function( mcEventData ) {\n\n\t\t\tvar ingestPayloadData = this.createPayload();\n\n\t\t\tingestPayloadData.eventType\t= 'mobile-creations';\n\n\t\t\tfor (var prop in mcEventData) {\n\t\t\t\tif (mcEventData[prop]) {\n\t\t\t\t\tingestPayloadData[prop] = mcEventData[prop];\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.postEvent(ingestPayloadData);\n\t\t},\n\n\t\t/**\n\t\t * Build up the event structure or the differnt types of Mobile Creations events to Ingest.\n\t\t *\n\t\t * @param mode\t\t\tstring object indicating the event mode\n\t\t * @param action\t\tstring containg type of action 'click' or 'render'\n\t\t * @param cardData\t\tJSON object containing the data to log\n\t\t */\n\t\tconstructMobileCreationsEventData: function(mode, action, cardData) {\n\n\t\t\tvar mcEventData = {\n\t\t\t\teventAction:\taction,\n\t\t\t\tcardTypeName:\t''\n\t\t\t};\n\n\t\t\t// setup card data\n\t\t\tif (mode !== 'item') {\n\t\t\t\tfor (var prop in cardData) {\n\t\t\t\t\tif (cardData) {\n\t\t\t\t\t\tmcEventData[prop] = cardData[prop];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// setup mode op\n\t\t\tswitch (mode) {\n\t\t\t\tcase 'project':\n\t\t\t\t\tmcEventData.cardTypeName = 'project';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'pages':\n\t\t\t\t\tmcEventData.cardTypeName  = 'pages';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'app':\n\t\t\t\t\tmcEventData.cardTypeName = 'appcards';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'item':\n\t\t\t\t\tmcEventData.cardTypeName = 'item';\n\t\t\t\t\tmcEventData.cardName = cardData.syncGroup || null;\n\t\t\t\t\tmcEventData.cardID = cardData.compositeId || null;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tiaw.log.console('Invalid Ingest Mobile Creations '+action+' event');\n\t\t\t\t\tmcEventData = null;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\treturn mcEventData;\n\t\t},\n\n\t\t/**\n\t\t * Log a user clicked event for Mobile Creations to Ingest.\n\t\t *\n\t\t * @param mode\t\t\tstring object indicating the event mode\n\t\t * @param cardData\t\tJSON object containing the data to log\n\t\t */\n\t\tlogMobileCreationsRenderedEvent: function(mode, cardData) {\n\n\t\t\tvar mcEventData = this.constructMobileCreationsEventData(mode, 'render', cardData);\n\n\t\t\tif (mcEventData) {\n\t\t\t\tthis.logMobileCreationsEvent(mcEventData);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Log a user clicked event for Mobile Creations to Ingest.\n\t\t *\n\t\t * @param mode\t\t\tstring object indicating the event mode\n\t\t * @param cardData\t\tJSON object containing the data to log\n\t\t */\n\t\tlogMobileCreationsClickedEvent: function(mode, cardData) {\n\n\t\t\tvar action = (mode !== 'item') ? 'click' : 'open';\n\t\t\tvar mcEventData = this.constructMobileCreationsEventData(mode, action, cardData);\n\n\t\t\tif (mcEventData) {\n\t\t\t\tthis.logMobileCreationsEvent(mcEventData);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Log a error event for Mobile Creations to Ingest.\n\t\t *\n\t\t * @param mcErrorCode\tstring object indicating the error code\n\t\t */\n\t\tlogMobileCreationsErrorEvent: function(mcErrorCode) {\n\n\t\t\tvar mcEventData = {\n\t\t\t\teventAction: 'error',\n\t\t\t\terrorCode : mcErrorCode\n\t\t\t};\n\n\t\t\tthis.logMobileCreationsEvent(mcEventData);\n\t\t},\n\n\t\t/**\n\t\t * Log an event from the FNFT dialog.\n\t\t *\n\t\t * @param itemData          item data to log\n\t\t */\n\t\tlogFNFTItemEvent: function( itemData ) {\n\n\t\t\tvar ingestPayloadData = this.createPayload();\n\n\t\t\tingestPayloadData.eventType = 'uc-file-open';\n\t\t\tingestPayloadData.fileOpenType = 'new';\n\n\t\t\tiaw.util.assign(ingestPayloadData, itemData);\n\t\t\tthis.postEvent(ingestPayloadData);\n\t\t},\n\n\t\t/**\n\t\t * Log an analytics call for the FNFT grid item render event.\n\t\t *\n\t\t * @param itemData\t\t\tgrid item's data parameters\n\t\t * @param section \t\t\tcategory section ID string\n\t\t */\n\t\tlogFNFTItemRenderedEvent: function( itemData ) {\n\t\t\t// window.alert(JSON.stringify(itemData));\n\t\t\t/*\n\t\t\t\t{\n\t\t\t\t   \"name\":\"Custom (1074 x 1394 px @ 72 ppi)\",\n\t\t\t\t   \"tip\":\"Start a new Custom (1074 x 1394 px @ 72 ppi) document - 1074 x 1394 px\",\n\t\t\t\t   \"group\":\"\",\n\t\t\t\t   \"width\":1074,\n\t\t\t\t   \"height\":1394,\n\t\t\t\t   \"showInFNFT\":false,\n\t\t\t\t   \"units\":\"pixelsUnit\",\n\t\t\t\t   \"profile\":\"sRGB IEC61966-2.1\",\n\t\t\t\t   \"resolution\":72,\n\t\t\t\t   \"resolutionUnits\":\"inchesUnit\",\n\t\t\t\t   \"depth\":8,\n\t\t\t\t   \"scale\":1,\n\t\t\t\t   \"mode\":\"RGB\",\n\t\t\t\t   \"fill\":\"white\",\n\t\t\t\t   \"lastUsedTime\":1466528752889,\n\t\t\t\t   \"isPreset\":true,\n\t\t\t\t   \"id\":\"\",\n\t\t\t\t   \"title\":\"Custom (1074 x 1394 px @ 72 ppi)\",\n\t\t\t\t   \"description\":\"\",\n\t\t\t\t   \"thumbnail_url\":\"SP_PresetCustom.png\",\n\t\t\t\t   \"mime_type\":\"image/photoshop\",\n\t\t\t\t   \"price_prompt\":\"\",\n\t\t\t\t   \"template_category\":\"recent\",\n\t\t\t\t   \"previews\":[],\n\t\t\t\t   \"uuid\":\"f707810544c34470a5e048664fcaa5b2\"\n\t\t\t\t}\n\t\t\t\t{\n\t\t\t\t   \"name\":\"Clipboard\",\n\t\t\t\t   \"tip\":\"Start a new Clipboard document - 565 x 396 px\",\n\t\t\t\t   \"group\":\"clipboard\",\n\t\t\t\t   \"width\":565,\n\t\t\t\t   \"height\":396,\n\t\t\t\t   \"showInFNFT\":true,\n\t\t\t\t   \"units\":\"pixelsUnit\",\n\t\t\t\t   \"profile\":\"Display\",\n\t\t\t\t   \"resolution\":72,\n\t\t\t\t   \"resolutionUnits\":\"inchesUnit\",\n\t\t\t\t   \"depth\":8,\n\t\t\t\t   \"scale\":1,\n\t\t\t\t   \"mode\":\"RGB\",\n\t\t\t\t   \"isPreset\":true,\n\t\t\t\t   \"id\":\"\",\n\t\t\t\t   \"title\":\"Clipboard\",\n\t\t\t\t   \"description\":\"\",\n\t\t\t\t   \"thumbnail_url\":\"SP_PresetClipboard.png\",\n\t\t\t\t   \"mime_type\":\"image/photoshop\",\n\t\t\t\t   \"price_prompt\":\"\",\n\t\t\t\t   \"template_category\":\"recent\",\n\t\t\t\t   \"previews\":[],\n\t\t\t\t   \"uuid\":\"e258641a2e264aea9fe9b0692103457a\"\n\t\t\t\t}\n\t\t\t\t{\n\t\t\t\t   \"id\":111631092,\n\t\t\t\t   \"title\":\"Photo Album Presentation\",\n\t\t\t\t   \"description\":\"##### Two easy-to-use photo album mockups\\r##### What's included:\\r* Smart objects\\r* Fully editable\\r* High resolution\\r* Great for presenting book layouts\\r\\r\\r\",\n\t\t\t\t   \"marketing_text\":null,\n\t\t\t\t   \"thumbnail_url\":\"/Users/mortimer/Library/Caches/Adobe/CCX Welcome/stock/assets/0a529bbf-ce4d-4db3-8d1c-3d851d8ac897.jpeg\",\n\t\t\t\t   \"width\":2048,\n\t\t\t\t   \"height\":1424,\n\t\t\t\t   \"mime_type\":\"image/vnd.adobe.photoshop.template\",\n\t\t\t\t   \"size\":16634446,\n\t\t\t\t   \"template_category\":[\n\t\t\t\t      \"photo\"\n\t\t\t\t   ],\n\t\t\t\t   \"previews\":[\n\t\t\t\t      {\n\t\t\t\t         \"url\":\"/Users/mortimer/Library/Caches/Adobe/CCX Welcome/stock/assets/fbc0094f-0e27-4c79-9b76-9e87bc77fb0e.jpeg\"\n\t\t\t\t      }\n\t\t\t\t   ],\n\t\t\t\t   \"units\":\"inches\",\n\t\t\t\t   \"resolution\":\"72\",\n\t\t\t\t   \"price_prompt\":\"free\",\n\t\t\t\t   \"lastUsedTime\":0,\n\t\t\t\t   \"uuid\":\"a4d794f391274c32a11d02bab2005c75\"\n\t\t\t\t}\n\t\t\t*/\n\t\t\tvar itemPayloadData = {\n\t\t\t\t// debugIt: true,\n\t\t\t\teventAction: 'render',\n\t\t\t\tcardTypeName: itemData.activeFilter,\n\t\t\t\tdisplayMode: (itemData.displayPosition >= 0) ? itemData.displayPosition : -1,\n\t\t\t\tsectionView: (itemData.group && itemData.group === 'clipboard') ? 'clipboard' : 'blank',\n\t\t\t\tdisplayTemplate: itemData.isPreset ? 'preset' : 'stock-template',\n\t\t\t\tcardName: itemData.name || itemData.title,\n\t\t\t\tcardID: itemData.id || 'preset'\n\t\t\t};\n\n\t\t\t// for templates - add in the price parameter data\n\t\t\tif (!itemData.isPreset) {\n\t\t\t\titemPayloadData.attributes = { price: itemData.price_prompt };\n\t\t\t}\n\t\t\tthis.logFNFTItemEvent(itemPayloadData);\n\t\t},\n\n\t\t/**\n\t\t * Collected utility methods for setting FNFT sturcture data\n\t\t */\n\t\tfnftUtil: {\n\t\t\t/**\n\t\t\t * Utility method to set the common parameters related to both Preset and Stock template data.\n\t\t\t *\n\t\t\t * @param payload \t\t\t\ttarget Ingest payload object to update\n\t\t\t * @param data  \t\t\t\tsource data object\n\t\t\t */\n\t\t\tsetCommonPayloadParameters: function(payload, data) {\n\t\t\t\tpayload.displayMode = data.displayPosition;\n\t\t\t\tpayload.cardTypeName = data.activeFilter;\n\t\t\t\tpayload.cardName = data.title;\n\t\t\t\tpayload.cardID = data.id || 'preset';\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Utility method to set the common parameters related to Stock template data.\n\t\t\t *\n\t\t\t * @param payload \t\t\t\ttarget Ingest payload object to update\n\t\t\t * @param data  \t\t\t\tsource Stock template data object\n\t\t\t */\n\t\t\tsetCommonStockPayloadParameters: function(payload, data) {\n\t\t\t\tthis.setCommonPayloadParameters(payload, data);\n\t\t\t\tpayload.displayTemplate = 'stock-template';\n\t\t\t\tpayload.attributes = {\n\t\t\t\t\tprice: data.price_prompt\n\t\t\t\t};\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Utility method to set the common parameters related to Preset data.\n\t\t\t *\n\t\t\t * @param payload \t\t\t\ttarget Ingest payload object to update\n\t\t\t * @param data  \t\t\t\tsource preset data object\n\t\t\t */\n\t\t\tsetCommonPresetPayloadParameters: function(payload, data) {\n\t\t\t\tthis.setCommonPayloadParameters(payload, data);\n\t\t\t\tpayload.displayTemplate = 'preset';\n\t\t\t\tpayload.attributes = { };\n\t\t\t\tthis.setAttributesFromPreset(payload.attributes, data);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Utility method to set only the parameters on the 'attributes' object that we care about.\n\t\t\t *\n\t\t\t * @param attributes \t\t\ttarget preset attributes object to update\n\t\t\t * @param preset  \t\t\t\tsource preset data object\n\t\t\t */\n\t\t\tsetAttributesFromPreset: function(attributes, preset) {\n\t\t\t\tfor (var key in preset) {\n\t\t\t\t\tswitch (key) {\n\t\t\t\t\t\tcase 'width':\n\t\t\t\t\t\tcase 'height':\n\t\t\t\t\t\tcase 'mode':\n\t\t\t\t\t\tcase 'units':\n\t\t\t\t\t\tcase 'profile':\n\t\t\t\t\t\tcase 'fill':\n\t\t\t\t\t\tcase 'resolution':\n\t\t\t\t\t\tcase 'resolutionUnits':\n\t\t\t\t\t\t\tattributes[key] = preset[key];\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Log an analytics call for the FNFT action event.\n\t\t *\n\t\t * @param actionData\t\tgrid item's data parameters\n\t\t */\n\t\tlogFNFTActionClickedEvent: function( action, actionData ) {\n\t\t\tvar actionPayloadData = {\n\t\t\t\t// debugIt: true,\n\t\t\t\teventAction: 'click',\n\t\t\t\tucAction: action\n\t\t\t};\n\t\t\tactionData = actionData || {};\n\t\t\tswitch (action) {\n\t\t\t\tcase 'preset-selected':\n\t\t\t\t\tthis.fnftUtil.setCommonPresetPayloadParameters(actionPayloadData, actionData);\n\t\t\t\t\tdelete actionPayloadData.ucAction;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'template-selected':\n\t\t\t\t\tthis.fnftUtil.setCommonStockPayloadParameters(actionPayloadData, actionData);\n\t\t\t\t\tdelete actionPayloadData.ucAction;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'stock-search':\n\t\t\t\t\tactionPayloadData.displayTemplate = 'stock-template';\n\t\t\t\t\tactionPayloadData.cardTypeName = actionData.activeFilter;\n\t\t\t\t\tactionPayloadData.actionURL = actionData.actionURL + '&as_content=ccxstart-search';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'stock-sidebar':\n\t\t\t\t\tthis.fnftUtil.setCommonStockPayloadParameters(actionPayloadData, actionData);\n\t\t\t\t\tactionPayloadData.actionURL = actionData.actionURL + '&as_content=ccxstart-sidebar';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'render-preview':\n\t\t\t\t\tactionPayloadData.eventAction = 'render';\n\t\t\t\t\tactionPayloadData.ucAction = 'preview';\n\t\t\t\t\tthis.fnftUtil.setCommonStockPayloadParameters(actionPayloadData, actionData);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'close-template':\n\t\t\t\t\tactionPayloadData.ucAction = 'close';\n\t\t\t\t\tthis.fnftUtil.setCommonStockPayloadParameters(actionPayloadData, actionData);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'open-template':\n\t\t\t\t\tactionPayloadData.ucAction = 'open';\n\t\t\t\t\tthis.fnftUtil.setCommonStockPayloadParameters(actionPayloadData, actionData);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'preview':\n\t\t\t\tcase 'preview-close':\n\t\t\t\tcase 'preview-back':\n\t\t\t\tcase 'license-template':\n\t\t\t\tcase 'download-start':\n\t\t\t\tcase 'download-end':\n\t\t\t\tcase 'download':\n\t\t\t\t\tthis.fnftUtil.setCommonStockPayloadParameters(actionPayloadData, actionData);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'too-large-render':\n\t\t\t\t\tthis.fnftUtil.setCommonStockPayloadParameters(actionPayloadData, actionData);\n\t\t\t\t\tactionPayloadData.ucAction = 'download-large';\n\t\t\t\t\tactionPayloadData.eventAction = 'render';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'close':\n\t\t\t\t\tthis.fnftUtil.setCommonPresetPayloadParameters(actionPayloadData, actionData);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'preset-viewmore':\n\t\t\t\t\tthis.fnftUtil.setCommonPresetPayloadParameters(actionPayloadData, actionData);\n\t\t\t\t\tactionPayloadData.ucAction = 'viewmore';\n\t\t\t\t\tdelete actionPayloadData.attributes;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'preset-create':\n\t\t\t\t\tthis.fnftUtil.setCommonPresetPayloadParameters(actionPayloadData, actionData);\n\t\t\t\t\tactionPayloadData.attributesChanged = false;\n\t\t\t\t\tactionPayloadData.ucAction = 'create';\n\n\t\t\t\t\t// check for the 'settings' data added which indicates a preset MAY have changed\n\t\t\t\t\tif (actionData.settings && Object.keys(actionData.settings).length !== 0 && actionData.settings.constructor === Object) {\n\t\t\t\t\t\tactionPayloadData.attributesChanged = actionData.settings.attributesChanged || false;\n\t\t\t\t\t\t// only add changed attributes if there were actual changes\n\t\t\t\t\t\tif (actionPayloadData.attributesChanged) {\n\t\t\t\t\t\t\tactionPayloadData.newAttributes = {};\n\t\t\t\t\t\t\tthis.fnftUtil.setAttributesFromPreset(actionPayloadData.newAttributes, actionData.settings);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'more-options':\n\t\t\t\t\tthis.fnftUtil.setCommonPresetPayloadParameters(actionPayloadData, actionData);\n\t\t\t\t\tiaw.util.assign(actionPayloadData, actionData.presetAttributes);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'tab-selected':\n\t\t\t\t\tactionPayloadData.cardTypeName = actionData.activeFilter;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'welcome-rendered':\n\t\t\t\t\tactionPayloadData.displayTemplate = 'welcome';\n\t\t\t\t\tactionPayloadData.eventAction = 'render';\n\t\t\t\t\tactionPayloadData.displayCount = actionData.displayCount;\n\t\t\t\t\tactionPayloadData.cardTypeName = actionData.activeFilter;\n\t\t\t\t\tactionPayloadData.ucAction = 'render';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'welcome-closed':\n\t\t\t\t\tactionPayloadData.displayTemplate = 'welcome';\n\t\t\t\t\tactionPayloadData.cardTypeName = actionData.activeFilter;\n\t\t\t\t\tactionPayloadData.ucAction = 'close';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'resize-dialog':\n\t\t\t\t\tactionPayloadData.eventAction = 'resize';\n\t\t\t\t\tactionPayloadData.displayTemplate = actionData.displayTemplate;\n\t\t\t\t\tactionPayloadData.cardName = actionData.cardName;\n\t\t\t\t\tactionPayloadData.cardTypeName = actionData.activeFilter;\n\t\t\t\t\tif (actionData.displayMode >= 0) {\n\t\t\t\t\t\tactionPayloadData.displayMode = actionData.displayMode;\n\t\t\t\t\t}\n\t\t\t\t\tactionPayloadData.attributes = actionData.attributes;\n\t\t\t\t\tdelete actionPayloadData.ucAction;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tthis.logFNFTItemEvent(actionPayloadData);\n\t\t}\n\t} // end of ingest container\n};\n","/*************************************************************************\n * ADOBE CONFIDENTIAL\n * ___________________\n *\n *  Copyright 2015 Adobe Systems Incorporated\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe Systems Incorporated and its suppliers,\n * if any.  The intellectual and technical concepts contained\n * herein are proprietary to Adobe Systems Incorporated and its\n * suppliers and are protected by all applicable intellectual property\n * laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe Systems Incorporated.\n **************************************************************************/\n\n/**\n * Simple singleton style container for holding the internationalization tables (I18N).\n */\nvar iaw = iaw || { };\n\niaw.i18n = {\n\n\tlocalizedStringTable:\tnull,\n\turlLocalizationTable:\tnull,\n\n\t/**\n\t * Normalize the Adobe locale to a standardized one. Basically converts\n\t * a locale ID like ja_JP to ja-jp.\n\t *\n\t * @param localeID  \t\tlocale ID string to normalize\n\t * @return the normalized locale ID string\n\t */\n\tnormalizeLocaleID: function(localeID) {\n\t\treturn localeID ? localeID.toLowerCase().replace('_', '-') : localeID;\n\t},\n\n\t/**\n\t * Initialize the table from a file in JSON format.\n\t *\n\t * @param localeID          string containing the locale to load\n\t * @param continueFn        continuation function callback\n\t */\n\taddFromLocalLocaleFile: function( localeID, continueFn ) {\n\n\t\tvar self    = this;\n\t\tvar xmlhttp = new XMLHttpRequest();\n\n\t\txmlhttp.overrideMimeType('application/json');\n\t\txmlhttp.onreadystatechange = function() {\n\n\t\t\tif ( xmlhttp.readyState === 4 && xmlhttp.responseText ) {\n//\t\t\t\txmlhttp.status == 200 && // local file will return status code 0\n\n\t\t\t\tif ( xmlhttp.responseText ) {\n\t\t\t\t\tself.localizedStringTable = JSON.parse( xmlhttp.responseText );\n\t\t\t\t}\n\n\t\t\t\t// update html language tag for accessibility\n\t\t\t\tdocument.getElementsByTagName('html')[0]\n\t\t\t\t\t.setAttribute('lang', localeID.toLowerCase().replace(/_/, '-'));\n\n\t\t\t\tif ( continueFn ) { continueFn(); }\n\t\t\t}\n\t\t};\n\t\txmlhttp.open('GET', './locale/'+localeID+'/strings.json', true);\n\t\txmlhttp.send();\n\t},\n\n\t/**\n\t * Add a localized string to the object's string table.\n\t *\n\t * @param stringID      string representing the index key into the table\n\t * @param value         string value to store with associated key\n\t */\n\taddLocalizedString: function( stringID, value ) {\n\t\tif ( stringID ) { this.localizedStringTable[stringID] = value; }\n\t},\n\n\t/**\n\t * Retrieve a localized string to the object's string table. If the string\n\t * is not present, then a standard error string is returned instead.\n\t *\n\t * @param stringID      string representing the index key into the table\n\t * @return String value to associated with the key\n\t */\n\tgetLocalizedString: function( stringID ) {\n\t\tvar locStr = this.localizedStringTable && stringID ? this.localizedStringTable[stringID] : null;\n\t\tvar newStr = locStr ? locStr.replace('^n', '<br>') : '';\n\t\treturn newStr;// debug ? 'NON-LOCALIZED:'+stringID : '';\n\t},\n\n\t/**\n\t * Retrieve a localized string to the object's string table. If the string\n\t * is not present, then a standard error string is returned instead.\n\t *\n\t * @param stringID      string representing the index key into the table\n\t * @return String value to associated with the key\n\t */\n\tgetLocalizedSubstitutionString: function( stringID, subArray ) {\n\t\tvar locStr = (this.localizedStringTable && stringID) ? this.localizedStringTable[stringID] : null;\n\n\t\tif ( locStr && subArray ) {\n\t\t\tfor ( var index = 0; index < subArray.length; index++ ) {\n\t\t\t\tlocStr = locStr.replace('^'+index, subArray[index] );\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tlocStr = '';// debug ? 'NON-LOCALIZED:'+stringID : '';\n\t\t}\n\t\treturn locStr;\n\t},\n\n\t/**\n\t * Change a document element display string to a translated string.\n\t *\n\t * @param elementID             document element ID\n\t * @param stringID              translation key-string ID\n\t * @param dontLocalize          boolean to indicate not to localize\n\t */\n\tsetDocumentElementString : function( elementID, stringID, dontLocalize ) {\n\t\tstringID = !stringID ? elementID : stringID;\n\n\t\tvar elem = document.getElementById( elementID );\n\n\t\tif ( elem ) {\n\t\t\telem.innerHTML = !dontLocalize ? this.getLocalizedString( stringID ) : stringID;\n\t\t}\n\t},\n\n\t/**\n\t * Initialize the table from a file in JSON format.\n\t *\n\t * @param type          string containing the url type.\n\t */\n\taddFromURLFile : function( type  ) {\n\t\tvar self    = this;\n\t\tvar xmlhttp = new XMLHttpRequest();\n\n\t\txmlhttp.overrideMimeType('application/json');\n\t\txmlhttp.onreadystatechange = function() {\n\n\t\t\tif ( xmlhttp.readyState === 4 && xmlhttp.responseText ) {\n//\t\t\t\t xmlhttp.status == 200 && // local files will return status code 0\n\t\t\t\tif ( xmlhttp.responseText ) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tself.urlLocalizationTable = JSON.parse( xmlhttp.responseText );\n\t\t\t\t\t}\n\t\t\t\t\tcatch (e) {\n//\t\t\t\t\t\twindow.alert('i18n table parse error: '+e.message);\n\t\t\t\t\t\tiaw.log.exception('i18n go URL table parse error: '+e.message);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tif (type === 'goURL' ) {\n\t\t\txmlhttp.open('GET', './locale/'+'goURL.json', true);\n\t\t}\n\t\txmlhttp.send();\n\t},\n\n\t/**\n\t * Get language id for help url.\n\t *\n\t * @param appLang       string containing language id xx_XX from app, such like, en_US\n\t * @return String value to associated with the app language.\n\t */\n\tgetLangSuffixForHelpURL : function( appLang ) {\n\t\tvar helpURL =\tthis.urlLocalizationTable &&\n\t\t\t\t\t\tthis.urlLocalizationTable.help &&\n\t\t\t\t\t\tappLang ? this.urlLocalizationTable.help[appLang] : null;\n\n\t\treturn helpURL ? helpURL : 'en';\n\t},\n\n\t/**\n\t * Get language id for account url.\n\t *\n\t * @param appLang       string containing language id xx_XX from app, such like, en_US\n\t * @return String value to associated with the app language.\n\t */\n\tgetLangSuffixForAccountURL : function( appLang ) {\n\t\tvar accountURL = this.urlLocalizationTable &&\n\t\t\t\t\t\t this.urlLocalizationTable.account &&\n\t\t\t\t\t\t appLang ? this.urlLocalizationTable.account[appLang] : null;\n\n\t\treturn accountURL ? accountURL : 'en';\n\t},\n\n\t/**\n\t * Get language id for mobile creations store url.\n\t *\n\t * @param appLang       string containing language id xx_XX from app, such like, en_US\n\t * @return String value to associated with the app language.\n\t */\n\tgetLangSuffixForMobileCreationsGoURL : function( appLang ) {\n\t\tvar suffix = this.urlLocalizationTable &&\n\t\t\t\t\t this.urlLocalizationTable.mobilecreations &&\n\t\t\t\t\t appLang ? this.urlLocalizationTable.mobilecreations[appLang] : null;\n\n\t\treturn (suffix && suffix !== 'en') ? '_'+suffix : '';  // for enUS default is just empty\n\t}\n};\n","/*************************************************************************\n * ADOBE CONFIDENTIAL\n * ___________________\n *\n *  Copyright 2015 Adobe Systems Incorporated\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe Systems Incorporated and its suppliers,\n * if any.  The intellectual and technical concepts contained\n * herein are proprietary to Adobe Systems Incorporated and its\n * suppliers and are protected by all applicable intellectual property\n * laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe Systems Incorporated.\n **************************************************************************/\nvar iaw = iaw || { };\n\niaw.json = {\n\t/**\n\t * Read and parse a JSON file from the local file system disk.\n\t *\n\t * @param path\t\tstring containing the full path to the file to process\n\t * @return Processed JSON as an object or null.\n\t */\n\treadLocalJSONFile: function(path) {\n\n\t\tvar obj = null;\n\n\t\tif (window.__adobe_cep__ && path) {\n\t\t\tvar result = window.cep.fs.readFile(path);\n\n\t\t\tif (0 === result.err) {\n\t\t\t\ttry {\n\t\t\t\t\tobj = JSON.parse(result.data);\n\t\t\t\t}\n\t\t\t\tcatch (error) {\n\t\t\t\t\tiaw.log.exception('Failed to read JSON file with path [' + path + '], error=' + error);\n\t\t\t\t\tobj = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (3 === result.err) {\n\t\t\t\tiaw.log.console('Attempt to read JSON file failed, file does not exist [' + path + ']');\n\t\t\t}\n\t\t\telse {\n\t\t\t\tiaw.log.console('Attempt to read JSON file failed with path [' + path + '], error code=' + result.err);\n\t\t\t}\n\t\t}\n\t\treturn obj;\n\t},\n\n\t/**\n\t * Preprocess the JSON data common to all CCX extensions.\n\t *\n\t * @param key\t\t\tdata key name string\n\t * @param val\t\t\tkey's value\n\t * @return A possibly modified 'val' parameter.\n\t */\n\tcommonDataReceiver: function(key, val) {\n\n\t\tswitch (key) {\n\t\t\tcase 'userTrackingEnabled':\n\t\t\t\tif (typeof val === 'string') {\n\t\t\t\t\tval = (val === 'true' || val === '1');\n\t\t\t\t}\n\t\t\t\tiaw.analytics.enabled = val; // enable/disable analytics\n\t\t\t\tbreak;\n\n\t\t\tcase 'fnftEnabled':\n\t\t\t\tif (typeof val === 'string') {\n\t\t\t\t\tval = (val === 'true' || val === '1');\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'shortcut':\n\t\t\t\tval = val.replace(/Cmd\\+/, '⌘');\n\t\t\t\tbreak;\n\n\t\t\tcase 'language':\n\t\t\t\t// special case en_IL & en_AE to remap for en_US\n\t\t\t\tval =  (val !== 'en_IL' && val !== 'en_AE') ? val : 'en_US';\n//\t\t\t\tval = 'ja_JP';  // force Japanese\n//\t\t\t\tval = 'fr_FR';  // force French\n//\t\t\t\tval = 'de_DE';  // force German\n\t\t\t\tbreak;\n\n\t\t}\n\t\treturn val;\n\t},\n\n\t/**\n\t * Preprocess the JSON data specific for CCX-Start.\n\t *\n\t * @param key\t\t\tdata key name string\n\t * @param val\t\t\tkey's value\n\t * @return A possibly modified 'val' parameter.\n\t */\n\tstartDataReceiver: function(key, val) {\n\n\t\tswitch (key) {\n\t\t\tcase 'thumbnailViewEnabled':\n\t\t\tcase 'listViewEnabled':\n\t\t\t\tif (typeof val === 'string') {\n\t\t\t\t\tval = (val === 'true' || val === '1');\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'size':\n\t\t\t\tval = parseInt(val);\n\t\t\t\tbreak;\n\n\t\t\tcase 'thumb':\n\t\t\t\tif (val) {\n\t\t\t\t\t// strip empty thumbnails\n\t\t\t\t\tif (val === 'data:image/jpeg;base64,') {\n\t\t\t\t\t\tval = '';\n\t\t\t\t\t}\n\t\t\t\t\t// strip newlines inserted by JSON.parse\n\t\t\t\t\telse {\n\t\t\t\t\t\tval = val.replace(/\\n/g, '');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'icon':\n\t\t\t\tif (val.indexOf('SP_Preset') < 0 && val.indexOf('SP_QuickStart') < 0) {\n\t\t\t\t\tswitch (val) {\n\t\t\t\t\t\tcase 'aep':\n\t\t\t\t\t\tcase 'pr_proj_primary':\n\t\t\t\t\t\tcase 'pr_convert_premiere_clip':\n\t\t\t\t\t\t\tval = 'CCX_Start_DefaultThumb_Pr_Ae';\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'ai':\n\t\t\t\t\t\tcase 'psd':\n\t\t\t\t\t\tcase 'id':\n\t\t\t\t\t\tcase 'id_library':\n\t\t\t\t\t\tcase 'id_book':\n\t\t\t\t\t\t\tval = 'CCX_Start_DefaultThumb_Ps_Ai_Id';\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tval = 'CCX_Start_DefaultThumb_other';\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'dontShowAgain':\n\t\t\t\tif (typeof val === 'string') {\n\t\t\t\t\tval = (val === 'true' || val === '1');\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'secondsLeftInTrial':\n\t\t\tcase 'appStartClockTime':\n\t\t\t\tif (typeof val === 'string') {\n\t\t\t\t\tval = parseInt(val);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tval = iaw.json.commonDataReceiver(key, val);\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn val;\n\t},\n\n\t/**\n\t * Preprocess the JSON data specific for CCX-FNFT.\n\t *\n\t * @param key\t\t\tdata key name string\n\t * @param val\t\t\tkey's value\n\t * @return A possibly modified 'val' parameter.\n\t */\n\tfnftDataReceiver: function(key, val) {\n\n\t\tswitch (key) {\n\t\t\tdefault:\n\t\t\t\tval = iaw.json.commonDataReceiver(key, val);\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn val;\n\t}\n};\n","/*************************************************************************\n * ADOBE CONFIDENTIAL\n * ___________________\n *\n *  Copyright 2016 Adobe Systems Incorporated\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe Systems Incorporated and its suppliers,\n * if any.  The intellectual and technical concepts contained\n * herein are proprietary to Adobe Systems Incorporated and its\n * suppliers and are protected by all applicable intellectual property\n * laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe Systems Incorporated.\n **************************************************************************/\n\n/**\n * Simple singleton style container so all Libray related stuff has a centralized point.\n */\nvar iaw = iaw || { };\n\niaw.libraryManager = {\n\n\t// global template lookup map\n\tstatusLookupMap: {},\n\thasSyncListener: false,\n\n\t// download status\n\tDOWNLOADED: 'downloaded',\n\tDOWNLOADING: 'downloading',\n\tDOWNLOAD_ERR: 'error',\n\n\t// template type and mime type\n\tTEMPLATE_ELEMENT_TYPE: 'application/vnd.adobe.element.template+dcx',\n\tMIME_TYPE: {\n\t\t'PHXS': 'image/vnd.adobe.photoshop.template',\n\t\t'ILST': 'application/illustrator.template',\n\t\t'IDSN': 'application/vnd.adobe.indesign.template'\n\t},\n\n\t// others\n\tinitialized: false,\n\tlibraryCollections: null,\n\tdebounce: 300, // 0.3 second\n\tlastSyncTime: new Date().valueOf(),\n\tpendingSyncTimeout: null,\n\tcheckRunningTimeout: null,\n\tcclibraryProcessLaunchPending: false, // CCLibrary process launch pending\n\n\t// cache licensed templates\n\tcachedLicensedTemplates: {},\n\n\t// __________________________________________________________________________\n\t/**\n\t * Listener for library collections loaded\n\t */\n\tonLibraryCollectionsLoaded: function() {\n\t\tclearTimeout(iaw.libraryManager.checkRunningTimeout);\n\n\t\tiaw.libraryManager.libraryCollections = ccLibraries && ccLibraries.getLoadedCollections();\n\t\tif (iaw.cepUtil.getExtensionID() !== 'com.adobe.ccx.fnft' || !iaw.libraryManager.libraryCollections) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Update status lookup map for fnft dialog\n\t\tiaw.libraryManager.getLicensedTemplates(iaw.store.get('host').hostID)\n\t\t.then(function(templates) {\n\n\t\t\tif (!window.__adobe_cep__) {\n\t\t\t\tiaw.fnftFakeLicensedTemplates.forEach(function(template) {\n\t\t\t\t\tiaw.libraryManager.statusLookupMap[template.id] = {\n\t\t\t\t\t\ttemplateId: template.id,\n\t\t\t\t\t\tdownloadStatus: iaw.libraryManager.DOWNLOADED,\n\t\t\t\t\t\tpath: template.url\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!iaw.fnftFakeLicensedTemplates) {\n\t\t\t\tiaw.libraryManager.cachedLicensedTemplates = {};\n\t\t\t}\n\n\t\t\ttemplates.forEach(function(template) {\n\t\t\t\tiaw.libraryManager.statusLookupMap[template.id] = {\n\t\t\t\t\ttemplateId: template.id,\n\t\t\t\t\tdownloadStatus: iaw.libraryManager.DOWNLOADED,\n\t\t\t\t\tpath: template.url,\n\t\t\t\t\telementRef: template.elementRef\n\t\t\t\t};\n\t\t\t});\n\t\t})\n\t\t.catch(function() {\n\t\t\t// ignore\n\t\t});\n\n\t\t//TODO: Enable this for ccx start screen when we need to detect cc lib changes there too.\n\t\t// Listen sync changes\n\t\tiaw.libraryManager.libraryCollections.forEach(function(libraryCollection) {\n\t\t\t(function(libraryCollection) {\n\t\t\t\tlibraryCollection.addSyncListener(function() {\n\t\t\t\t\tiaw.libraryManager.onSync(libraryCollection);\n\t\t\t\t});\n\t\t\t})(libraryCollection);\n\t\t});\n\t},\n\n\t/**\n\t * Load & init CC library\n\t * @param filters \tan array of element filters, like ['application/vnd.adobe.element.template+dcx']\n\t */\n\tinit: function(filters) {\n\t\tfilters = filters || '*';\n\n\t\tif (!iaw.libraryManager.isProcessInstalled()) {\n\t\t\treturn iaw.log.console('CC Library Process is not installed.');\n\t\t}\n\n\t\tiaw.util.loadExternalScript('./js/cc-libraries-api.min.js').then(function(scriptTag) {\n\t\t\tif (typeof ccLibraries === 'undefined') {\n\t\t\t\treturn iaw.log.console('Fail to load CC Library javascript file.');\n\t\t\t}\n\n\t\t\t// Initialize ccLibraries\n\t\t\tvar DEPENDENCIES = {\n\t\t\t\tlog: function(message) {\n\t\t\t\t\tiaw.log.console(message);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tvar OPTIONS = {\n\t\t\t\tSHARED_LOCAL_STORAGE: true,\n\t\t\t\tELEMENT_TYPE_FILTERS: filters\n\t\t\t};\n\n\t\t\tccLibraries.configure(DEPENDENCIES, OPTIONS);\n\n\t\t\t// VulcanInterface.isAppRunning is not reliable to know the running status. Sometimes it returns false for the running CC Lib Process on Mac.\n\t\t\t// We check if ccLibraries.isConnected in 1 second to determine the running status of CC Lib process. this workaround is suggested by CC Library team.\n\t\t\tiaw.libraryManager.checkRunningTimeout = setTimeout(function() {\n\t\t\t\tif ((!iaw.libraryManager.isProcessRunning()) && (!ccLibraries.isConnected())) {\n\t\t\t\t\tiaw.log.console('Start to launch CCLibrary Process');\n\t\t\t\t\tiaw.libraryManager.launchCCLibraryProcess();\n\t\t\t\t}\n\t\t\t}, 1000);\n\n\t\t\tccLibraries.addLoadedCollectionsListener(iaw.libraryManager.onLibraryCollectionsLoaded);\n\t\t});\n\t\t\n\t},\n\n    /**\n\t * Get template library\n\t *\n\t * @return [Promise] promise that will get \"Stock Templates\" library\n\t */\n\tgetTemplateLibrary: function() {\n\t\treturn new Promise(function(resolve, reject) {\n\t\t\tif (!iaw.libraryManager.isLibraryCollelctionsLoaded()) {\n\t\t\t\tiaw.log.console('Get template library: Fail to load library collections.');\n\t\t\t\treturn reject();\n\t\t\t}\n\n\t\t\tvar libraryCollection = iaw.libraryManager.libraryCollections[0];\n\t\t\tvar templateLib;\n\t\t\tvar libraryName = iaw.i18n.getLocalizedString('stock_template_library_name');\n\t\t\tlibraryCollection.libraries.forEach(function(library) {\n\t\t\t\tif (!templateLib && library.name === libraryName) {\n\t\t\t\t\ttemplateLib = library;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (!templateLib) {\n\t\t\t\ttemplateLib = libraryCollection.createLibrary(libraryName);\n\t\t\t}\n\t\t\tresolve(templateLib);\n\t\t});\n\t},\n\n\t/**\n\t * Util to check if representation is in downloading\n\t * @param [Object] representation\tCC library element's representation\n\t * @return [Boolean] true or false\n\t */\n\tisRepresentationDownloadPending: function(representation) {\n\t\tif (!representation.isExternalLink) {\n\t\t\treturn false;\n\t\t}\n\t\treturn !representation.getCachedContentPath() && !representation.getCachedExternalLinkError();\n\t},\n\n\t/**\n\t * Util to check if element is in downloading\n\t *\n\t * @param [Object] element\tCC library element\n\t * @return [Boolean] true or false\n\t */\n\tisElementDownloadPending: function(element) {\n\t\treturn element.representations.some(function(representation) {\n\t\t\treturn iaw.libraryManager.isRepresentationDownloadPending(representation);\n\t\t});\n\t},\n\n\t/**\n\t * Util to retry downloading\n\t *\n\t * @param [Object] element\tCC library element\n\t */\n\tretryElementDownload: function(element) {\n\t\telement.representations.forEach(function(representation) {\n\t\t\tif (iaw.libraryManager.isRepresentationDownloadPending(representation)) {\n\t\t\t\trepresentation.getContentPath(); // This triggers the refetch\n\t\t\t}\n\t\t});\n\t},\n\n\t/**\n\t * Util to get download progress\n\t *\n\t * @param element\tCC library element\n\t * @return [Number] download progress like 60\n\t */\n\tgetElementDownloadProgress: function(element) {\n\t\tvar downloadProgress;\n\t\telement.representations.forEach(function(representation) {\n\t\t\tif (downloadProgress === undefined) {\n\t\t\t\tdownloadProgress = representation.getExternalLinkDownloadProgress();\n\t\t\t}\n\t\t});\n\t\treturn downloadProgress;\n\t},\n\n\t/**\n\t * Hook CC library sync listener\n\t */\n\tonSync: function(libraryCollection) {\n\n\t\tif (iaw.libraryManager.pendingSyncTimeout) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar currentTime = new Date().valueOf();\n\t\tif (currentTime - iaw.libraryManager.lastSyncTime < iaw.libraryManager.debounce) {\n\t\t\t(function(libraryCollection) {\n\t\t\t\tiaw.libraryManager.pendingSyncTimeout = setTimeout(function() {\n\t\t\t\t\tiaw.libraryManager.pendingSyncTimeout = undefined;\n\t\t\t\t\tiaw.libraryManager.onSync(libraryCollection);\n\t\t\t\t}, iaw.libraryManager.debounce);\n\t\t\t})(libraryCollection);\n\t\t\treturn;\n\t\t}\n\n\t\tiaw.libraryManager.lastSyncTime = currentTime;\n\t\tvar statusLookupMap = iaw.libraryManager.statusLookupMap;\n\n\t\tlibraryCollection.libraries.forEach(function(library) {\n\t\t\tlibrary.getFilteredElements(iaw.libraryManager.TEMPLATE_ELEMENT_TYPE).forEach(function(element) {\n\t\t\t\tif (iaw.stockUtil.getElementStockLicense(element) === undefined) return;\n\n\t\t\t\tvar id = iaw.stockUtil.getElementStockId(element);\n\t\t\t\tvar status = statusLookupMap[id] || {templateId: id};\n\t\t\t\tvar oldProgress = status.progress;\n\t\t\t\tstatus.progress = iaw.libraryManager.getElementDownloadProgress(element);\n\t\t\t\tvar oldPending = status.downloadPending;\n\t\t\t\tstatus.downloadPending = iaw.libraryManager.isElementDownloadPending(element);\n\n\t\t\t\tvar logPrefix = 'Stock template [' + status.templateId + '] ';\n\t\t\t\t// TODO: Split to onDownloaded, onDownloading, onDownloadError function\n\t\t\t\tif (status.downloadPending !== oldPending || status.progress !== oldProgress) {\n\t\t\t\t\tif (status.progress === undefined || (oldPending && !status.downloadPending)) {\n\t\t\t\t\t\t// downloaded\n\t\t\t\t\t\t// Filter out any odd progress event(s) from Library. Usually, it happens at parallel downloadings.\n\t\t\t\t\t\tif (oldProgress && status.progress && status.progress < oldProgress) return;\n\n\t\t\t\t\t\telement.getPrimaryRepresentation().getContentPath(function(err, path) {\n\t\t\t\t\t\t\tif (err || (status.downloadStatus === iaw.libraryManager.DOWNLOADED && status.path === path)) return;\n\n\t\t\t\t\t\t\tif (status.downloadStatus !== iaw.libraryManager.DOWNLOADED) {\n\t\t\t\t\t\t\t\tvar templateData = iaw.util.getTemplateData(id) || {};\n\t\t\t\t\t\t\t\tiaw.analytics.ingest.logFNFTActionClickedEvent('download-end', templateData);\n\t\t\t\t\t\t\t\tiaw.log.console(logPrefix + 'is downloaded.');\n\n\t\t\t\t\t\t\t\t// update template data in data store.\n\t\t\t\t\t\t\t\tif (templateData) {\n\t\t\t\t\t\t\t\t\ttemplateData.licensedTime = element.modified;\n\t\t\t\t\t\t\t\t\ttemplateData.lastUsedTime = iaw.localstorage.getUserItem('templateLUT_' + id) || element.modified;\n\t\t\t\t\t\t\t\t\ttemplateData.template_category = templateData.template_category || [];\n\t\t\t\t\t\t\t\t\tif (templateData.template_category.indexOf('saved') === -1) {\n\t\t\t\t\t\t\t\t\t\ttemplateData.template_category.push('saved');\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tstatus.downloadStatus = iaw.libraryManager.DOWNLOADED;\n\t\t\t\t\t\t\tstatus.path = path;\n\t\t\t\t\t\t\tstatus.elementRef = element.getReference();\n\t\t\t\t\t\t\tiaw.store.set(['input', 'download-status'], status);\n\t\t\t\t\t\t\tstatusLookupMap[id] = status;\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\telse if (status.progress === -1) {\n\t\t\t\t\t\t// download error\n\t\t\t\t\t\tif (status.downloadStatus === iaw.libraryManager.DOWNLOAD_ERR) return;\n\t\t\t\t\t\tstatus.downloadStatus = iaw.libraryManager.DOWNLOAD_ERR;\n\t\t\t\t\t\tiaw.log.console(logPrefix + 'fail to be downloaded.');\n\t\t\t\t\t\tiaw.store.set(['input', 'download-status'], status);\n\t\t\t\t\t}\n\t\t\t\t\telse if ((status.progress >= oldProgress) && status.downloadPending) {\n\t\t\t\t\t\t// downloading\n\t\t\t\t\t\tstatus.downloadStatus = iaw.libraryManager.DOWNLOADING;\n\t\t\t\t\t\tstatus.licensedTime = element.modified;\n\t\t\t\t\t\tstatus.lastUsedTime = element.modified;\n\t\t\t\t\t\tiaw.log.console(logPrefix + 'is being downloaded, progress=' + status.progress);\n\t\t\t\t\t\tiaw.store.set(['input', 'download-status'], status);\n\t\t\t\t\t}\n\t\t\t\t\tstatusLookupMap[id] = status;\n\t\t\t\t}\n\t\t\t\telse if (status.downloadPending && (statusLookupMap[id].downloadStatus !== iaw.libraryManager.DOWNLOADING)) {\n\t\t\t\t\tiaw.analytics.ingest.logFNFTActionClickedEvent('download-start', iaw.util.getTemplateData(id) || {});\n\t\t\t\t\tstatus.downloadStatus = iaw.libraryManager.DOWNLOADING;\n\t\t\t\t\tstatus.progress = 0;\n\t\t\t\t\tstatusLookupMap[id] = status;\n\t\t\t\t\tiaw.store.set(['input', 'download-status'], status);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t},\n\n\t/**\n\t * Build up template object based on CC library element\n\t *\n\t * @param [Object] element\t\t\tcc library element\n\t * @param [Boolean] checkPurchased\tflag indicating to check purchase/license status or not\n\t * @param [String] mime_type\t\tmime type of template\n\t * @return [Promise] promise that will build up template in desired format\n\t */\n\tbuildupTemplate: function(element, checkPurchased, mime_type) {\n\n\t\treturn new Promise(function(resolve, reject) {\n\t\t\tif (!element || (checkPurchased && iaw.stockUtil.getElementStockLicense(element) === undefined) || iaw.libraryManager.isElementDownloadPending(element)) {\n\t\t\t\treturn reject();\n\t\t\t}\n\n\t\t\tvar representation = element.getPrimaryRepresentation();\n\t\t\tif (!representation) return reject();\n\t\t\trepresentation.getContentPath(function(err, templatePath) {\n\t\t\t\tif (err) return reject(err);\n\t\t\t\telement.getThumbnailPath(202, function(err, thumbnailPath) {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\tthumbnailPath = null;\n\t\t\t\t\t}\n\t\t\t\t\tvar id = iaw.stockUtil.getElementStockId(element);\n\t\t\t\t\tresolve({\n\t\t\t\t\t\tid: id,\n\t\t\t\t\t\tmime_type: mime_type,\n\t\t\t\t\t\ttemplate_category: ['saved', 'recent'],\n\t\t\t\t\t\ttitle: element.name,\n\t\t\t\t\t\tcreated: element.created,\n\t\t\t\t\t\tlicensedTime: element.modified,\n\t\t\t\t\t\tmodified: element.modified,\n\t\t\t\t\t\tlastUsedTime: iaw.localstorage.getUserItem('templateLUT_' + id) || element.modified,\n\t\t\t\t\t\tdescription: iaw.i18n.getLocalizedString('newdoc_details_template_default'),\n\t\t\t\t\t\t'thumbnail_url': thumbnailPath,\n\t\t\t\t\t\twidth: representation.width,\n\t\t\t\t\t\theight: representation.height,\n\t\t\t\t\t\turl: templatePath,\n\t\t\t\t\t\tsize: representation.contentLength,\n\t\t\t\t\t\telementRef: element.getReference(),\n\t\t\t\t\t\tpreviews: []\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\n\t/**\n\t * Util to check if CC library is connected.\n\t *\n\t * @return [Boolean] true or false.\n\t */\n\tisConnected: function() {\n\t\treturn ccLibraries.isConnected();\n\t},\n\n\t/**\n\t * Util to get CC library service info.\n\t *\n\t * @return [Object] service info.\n\t */\n\tgetServiceInfo: function() {\n\t\treturn ccLibraries.getServiceInfo();\n\t},\n\n\t/**\n\t * Util to check if CC library Process is installed\n\t *\n\t * @return [Boolean] true or false.\n\t */\n\tisProcessInstalled: function() {\n\t\treturn window.__adobe_cep__ ? VulcanInterface.isAppInstalled('cclibraries') : false;\n\t},\n\n\n\t// __________________________________________________________________________\n\t/**\n\t * Public API\n\t */\n\n\t/**\n\t * Check if CC Library process is running or not.\n\t *\n\t * @return [Boolean] true or false.\n\t */\n\tisProcessRunning: function() {\n\t\treturn VulcanInterface.isAppRunning('cclibraries');\n\t},\n\n\t/**\n\t * Launch CC library process.\n\t */\n\tlaunchCCLibraryProcess: function() {\n\t\tif (iaw.libraryManager.cclibraryProcessLaunchPending) {\n\t\t\treturn;\n\t\t}\n\t\tvar interval;\n\t\tvar message = 'vulcan.SuiteMessage.cclibraries.service.Initialized';\n\n\t\tfunction started() {\n\t\t\tif (interval) {\n\t\t\t\tclearInterval(interval);\n\t\t\t}\n\t\t\tiaw.libraryManager.cclibraryProcessLaunchPending = false;\n\t\t\tccLibraries.reconnect();\n\t\t\tVulcanInterface.removeMessageListener(message, started);\n\n\t\t\t// Wait 1s, then check if we're still connected - if not, need to retry\n\t\t\tsetTimeout(function() {\n\t\t\t\tif (!iaw.libraryManager.isConnected()) {\n\t\t\t\t\tiaw.libraryManager.launchCCLibraryProcess();\n\t\t\t\t}\n\t\t\t}, 1000);\n\t\t}\n\n\t\tfunction callLaunch() {\n\t\t\t// If we happen to already be connected then abort the interval\n\t\t\tif (iaw.libraryManager.isConnected()) {\n\t\t\t\tstarted();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// NOTE: We never try to launch the CC Library process if an update is required (either to the panel or process).\n\t\t\t// Unfortunately, Vulcan.isAppRunning always returns false on the Mac, which can mean we keep on trying to start the\n\t\t\t// process even though it's already running, and this causes 2 second hangs on the main thread in the desktop products.\n\t\t\tvar serviceInfo = iaw.libraryManager.getServiceInfo() || {};\n\t\t\tif (!serviceInfo.updateRequired && iaw.libraryManager.isProcessInstalled() && !iaw.libraryManager.isProcessRunning()) {\n\t\t\t\tiaw.log.console('Launching CCLibrary Process');\n\t\t\t\tVulcanInterface.launchApp('cclibraries', false);\n\t\t\t}\n\t\t}\n\n\t\tVulcanInterface.addMessageListener(message, started);\n\t\tccLibraries.reconnect();\n\t\tiaw.libraryManager.cclibraryProcessLaunchPending = true;\n\n\t\tinterval = setInterval(callLaunch, 5000);\n\t\tcallLaunch();\n\t},\n\n\t/**\n\t * Get licensed templates per hostID.\n\t *\n\t * @param [String] hostID\thost id, like 'PHXS'\n\t * @return [Promise] promise that will resolve licensed templates\n\t */\n\tgetLicensedTemplates: function(hostID) {\n\n\t\treturn new Promise(function(resolve, reject) {\n\t\t\tif (!window.__adobe_cep__) {\n\t\t\t\treturn resolve(iaw.fnftFakeLicensedTemplates);\n\t\t\t}\n\n\t\t\tfunction onFinish(templates) {\n\t\t\t\ttemplates = templates.filter(function(item, pos) {\n\t\t\t\t\treturn templates.indexOf(item) == pos;\n\t\t\t\t});\n\n\t\t\t\tresolve(templates);\n\t\t\t}\n\n\t\t\tif (!iaw.libraryManager.isLibraryCollelctionsLoaded()) {\n\t\t\t\tiaw.log.console('Get licensed templates: Fail to load library collections.');\n\t\t\t\treturn reject();\n\t\t\t}\n\n\t\t\tvar elements = [];\n\t\t\tvar libraries = [];\n\t\t\tiaw.libraryManager.libraryCollections.forEach(function(libraryCollection) {\n\t\t\t\tlibraries = libraries.concat(libraryCollection.libraries);\n\t\t\t});\n\t\t\tlibraries.forEach(function(library) {\n\t\t\t\telements = elements.concat(library.getFilteredElements(iaw.libraryManager.TEMPLATE_ELEMENT_TYPE));\n\t\t\t});\n\n\t\t\t// Filter out licensed templates via mime_type.\n\t\t\t// For Photoshop: it's application/photoshop.template\n\t\t\t// For Illustrator: it's application/illustrator.template'\n\t\t\tvar mime_type = iaw.libraryManager.MIME_TYPE[hostID];\n\t\t\tif (mime_type) {\n\t\t\t\telements = elements.filter(function(element) {\n\t\t\t\t\treturn element.getPrimaryRepresentation().isCompatibleType(mime_type);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tvar callCount = 0;\n\t\t\tvar templates = [];\n\t\t\tif (!elements || elements.length === 0) {\n\t\t\t\treturn onFinish([]);\n\t\t\t}\n\n\t\t\t// Build up the desired licensed template array.\n\t\t\telements.forEach(function(element) {\n\t\t\t\t// build up template obj.\n\t\t\t\tiaw.libraryManager.buildupTemplate(element, true, mime_type)\n\t\t\t\t.then(function(template) {\n\t\t\t\t\ttemplates.push(template);\n\t\t\t\t\tif (++callCount === elements.length) {\n\t\t\t\t\t\tonFinish(templates);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(function() {\n\t\t\t\t\tif (++callCount === elements.length) {\n\t\t\t\t\t\tonFinish(templates);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\n\t/**\n\t * Get templates per elements reference.\n\t *\n\t * @param [Array] elementRefs\tan array of elements reference\n\t * @return [Promise] promise that will resolve templates\n\t */\n\telementRefsToTemplates: function(elementRefs) {\n\n\t\treturn new Promise(function(resolve, reject) {\n\t\t\tif (!elementRefs) {\n\t\t\t\treturn reject();\n\t\t\t}\n\n\t\t\tif (!window.__adobe_cep__) {\n\t\t\t\treturn resolve(iaw.fnftFakeLicensedTemplates);\n\t\t\t}\n\n\t\t\tfunction onFinish(templates) {\n\t\t\t\tresolve(templates);\n\t\t\t}\n\n\t\t\tif (!iaw.libraryManager.isLibraryCollelctionsLoaded()) {\n\t\t\t\tiaw.log.console('ElementRefs to templates: Fail to load library collections.');\n\t\t\t\treturn reject();\n\t\t\t}\n\n\t\t\tvar callCount = 0;\n\t\t\tvar elements = [];\n\t\t\telementRefs.forEach(function(elementRef) {\n\t\t\t\tif (!elementRef) return;\n\t\t\t\telements.push(ccLibraries.resolveElementReference(elementRef));\n\t\t\t});\n\n\t\t\tvar templates = [];\n\t\t\tif (!elements || elements.length === 0) {\n\t\t\t\treturn onFinish([]);\n\t\t\t}\n\t\t\telements.forEach(function(element) {\n\t\t\t\t// build up template obj.\n\t\t\t\tiaw.libraryManager.buildupTemplate(element)\n\t\t\t\t.then(function(template) {\n\t\t\t\t\ttemplates.push(template);\n\t\t\t\t\tif (++callCount === elements.length) {\n\t\t\t\t\t\tonFinish(templates);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(function() {\n\t\t\t\t\tif (++callCount === elements.length) {\n\t\t\t\t\t\tonFinish(templates);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\n\t/**\n\t * Get template path per library Id.\n\t *\n\t * @param [Object] libraryCollection\tlibrary collection\n\t * @param [String] stockTemplateId\t\tstock template id\n\t * @return [Promise] promise that will resolve path of template\n\t */\n\tgetTemplatePath: function(libraryCollection, stockTemplateId) {\n\t\treturn new Promise(function(resolve, reject) {\n\t\t\tif (!window.__adobe_cep__) {\n\t\t\t\tvar path;\n\t\t\t\tiaw.fnftFakeLicensedTemplates.forEach(function(template) {\n\t\t\t\t\tif (template.id === stockTemplateId) {\n\t\t\t\t\t\tpath = template.url;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn path;\n\t\t\t}\n\t\t\tvar isFound = false;\n\t\t\tlibraryCollection.libraries.forEach(function(library) {\n\t\t\t\tlibrary.elements.forEach(function(element) {\n\t\t\t\t\tvar id = iaw.stockUtil.getElementStockId(element);\n\t\t\t\t\tif (id === stockTemplateId && !isFound) {\n\t\t\t\t\t\tisFound = true;\n\t\t\t\t\t\telement.getPrimaryRepresentation().getContentPath(function(err, path) {\n\t\t\t\t\t\t\tresolve(path);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t\tif (!isFound) {\n\t\t\t\tresolve();\n\t\t\t}\n\t\t});\n\t},\n\n\t/**\n\t * Check if temlate is licensed or not.\n\t *\n\t * @param [String] id\ttemplate id\n\t * @return [Boolean] true or false.\n\t */\n\tisTemplateLicensed: function(id) {\n\t\tif (!window.__adobe_cep__) {\n\t\t\tvar license = false;\n\t\t\tiaw.fnftFakeLicensedTemplates.forEach(function(template) {\n\t\t\t\tif (template.id === id) {\n\t\t\t\t\tlicense = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn license;\n\t\t}\n\n\t\tif (iaw.libraryManager.cachedLicensedTemplates && Object.keys(iaw.libraryManager.cachedLicensedTemplates).length > 0) {\n\t\t\tif (iaw.libraryManager.cachedLicensedTemplates[id] !== undefined) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn iaw.libraryManager.statusLookupMap[id] && (iaw.libraryManager.statusLookupMap[id].downloadStatus === iaw.libraryManager.DOWNLOADED);\n\t},\n\n\t/**\n\t * Check if temlate is in downloading.\n\t *\n\t * @param [String] id\ttemplate id\n\t * @return [Boolean] true or false.\n\t */\n\tisTemplateDownloading: function(id) {\n\t\treturn iaw.libraryManager.statusLookupMap[id] && (iaw.libraryManager.statusLookupMap[id].downloadStatus === iaw.libraryManager.DOWNLOADING);\n\t},\n\n\t/**\n\t * Get the status of template.\n\t *\n\t * @param [String] id\ttemplate id\n\t * @return [Object] template status.\n\t */\n\tgetTemplateStatus: function(id) {\n\t\treturn iaw.libraryManager.statusLookupMap[id];\n\t},\n\n\t/**\n\t * Set status for template.\n\t *\n\t * @param [String] id\t\ttemplate id\n\t * @param [Object] status\ttemplate status\n\t */\n\tsetTemplateStatus: function(id, status) {\n\t\treturn iaw.libraryManager.statusLookupMap[id] = status;\n\t},\n\n\t/**\n\t * Get element reference by template Id\n\t *\n\t * @param [String] id\ttemplate id\n\t * @return [String] element reference\n\t */\n\tgetElementRefById: function(id) {\n\t\treturn iaw.libraryManager.statusLookupMap[id] && iaw.libraryManager.statusLookupMap[id].elementRef;\n\t},\n\n\t/**\n\t * Get template Id by element reference\n\t *\n\t * @param [String] elementRef element reference\n\t * @return [String] template id\n\t */\n\tgetIdByElementRef: function(elementRef) {\n\t\tif (typeof ccLibraries !== 'undefined') {\n\t\t\tvar element = ccLibraries && ccLibraries.resolveElementReference(elementRef);\n\t\t\treturn element && iaw.stockUtil.getElementStockId(element);\n\t\t}\n\t\treturn null;\n\t},\n\n\t/**\n\t * Check if cc library collections get loaded\n\t *\n\t * @return [Boolean] true or false.\n\t */\n\tisLibraryCollelctionsLoaded: function() {\n\t\treturn (iaw.libraryManager.libraryCollections && iaw.libraryManager.libraryCollections.length > 0);\n\t},\n\n\t/**\n\t * Get the cached licensed templates.\n\t *\n\t * @param [String] hostID\thost id, like 'PHXS'\n\t * @return [Promise] promise that will resolve licensed templates\n\t *\n\t * TODO: Use Accessor JS API to parse local lookup file.\n\t */\n\tgetCachedTemplates: function(hostID) {\n\t\treturn new Promise(function(resolve, reject) {\n\n\t\t\tif (iaw.fnftFakeLicensedTemplates) {\n\t\t\t\tvar templates = [];\n\t\t\t\tiaw.fnftFakeLicensedTemplates.forEach(function(template) {\n\t\t\t\t\tif (template['mime_type'] === iaw.libraryManager.MIME_TYPE[hostID]) {\n\t\t\t\t\t\ttemplates.push(template);\n\t\t\t\t\t\tiaw.libraryManager.cachedLicensedTemplates[template.id] = template;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn resolve(templates);\n\t\t\t}\n\n\t\t\tvar licensedTempaltes = [];\n\t\t\tvar csInterface = new CSInterface();\n\t\t\tvar lookupFilePath = csInterface.getSystemPath(SystemPath.USER_DATA) + '/Adobe/Creative Cloud Libraries/LIBS/librarylookupfile';\n\t\t\tvar lookupMapJSON = iaw.json.readLocalJSONFile(lookupFilePath);\n\n\t\t\tif (lookupMapJSON && lookupMapJSON.libraries) {\n\n\t\t\t\tObject.keys(lookupMapJSON.libraries).forEach(function(libId) {\n\t\t\t\t\tvar lib = lookupMapJSON.libraries[libId];\n\t\t\t\t\tif (!lib || !lib.elements) return;\n\n\t\t\t\t\tObject.keys(lib.elements).forEach(function(elementId) {\n\t\t\t\t\t\tvar element = lib.elements[elementId];\n\t\t\t\t\t\tif (!element || !element.reps) return;\n\n\t\t\t\t\t\tvar template = {\n\t\t\t\t\t\t\tid: element.stockId,\n\t\t\t\t\t\t\ttemplate_category: ['saved', 'recent'],\n\t\t\t\t\t\t\ttitle: element.name,\n\t\t\t\t\t\t\tcreated: element.mod, // no creation time so set modified time\n\t\t\t\t\t\t\tlicensedTime: element.mod,\n\t\t\t\t\t\t\tmodified: element.mod,\n\t\t\t\t\t\t\tlastUsedTime: iaw.localstorage.getUserItem('templateLUT_' + element.stockId) || element.mod,\n\t\t\t\t\t\t\tdescription: iaw.i18n.getLocalizedString('newdoc_details_template_default'),\n\t\t\t\t\t\t\telementRef: 'cloud-asset://' + lib.domain + lib.path + '/' + libId + ';node=' + elementId,\n\t\t\t\t\t\t\tpreviews: []\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tvar isWindows = iaw.store.get(['host', 'platform']) === 'win' || iaw.store.get(['host', 'platform']) === 'windows' || false;\n\t\t\t\t\t\telement.reps.forEach(function(rep) {\n\t\t\t\t\t\t\tif (rep && (rep.type === iaw.libraryManager.MIME_TYPE[hostID])) {\n\t\t\t\t\t\t\t\ttemplate['mime_type'] = rep.type;\n\t\t\t\t\t\t\t\tif (isWindows) {\n\t\t\t\t\t\t\t\t\ttemplate.url = rep.path.replace(/\\\\/g, '/');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\ttemplate.url = rep.path;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (rep && (rep.type === 'image/jpeg')) {\n\t\t\t\t\t\t\t\tif (isWindows) {\n\t\t\t\t\t\t\t\t\ttemplate['thumbnail_url'] = rep.path.replace(/\\\\/g, '/');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\ttemplate['thumbnail_url'] = rep.path;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif (template['mime_type'] && template.url) {\n\t\t\t\t\t\t\tlicensedTempaltes.push(template);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tlicensedTempaltes.forEach(function(template) {\n\t\t\t\tiaw.libraryManager.cachedLicensedTemplates[template.id] = template;\n\t\t\t});\n\n\t\t\tresolve(licensedTempaltes);\n\t\t});\n\t},\n\n\t/**\n\t * Get template id from elementRef of cached templates.\n\t *\n\t * @param [String] elementRef element reference\n\t * @return [String] template id\n\t */\n\tgetIdByCachedElementRef: function(elementRef) {\n\t\tvar templates = iaw.libraryManager.cachedLicensedTemplates;\n\t\tvar keys = Object.keys(templates);\n\n\t\tif (templates && keys.length > 0) {\n\t\t\tfor (var i=0; i<keys.length; i++) {\n\t\t\t\tvar key = keys[i];\n\t\t\t\tif (templates[key].elementRef === elementRef) {\n\t\t\t\t\treturn templates[key].id;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n};\n","/*************************************************************************\n * ADOBE CONFIDENTIAL\n * ___________________\n *\n *  Copyright 2015 Adobe Systems Incorporated\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe Systems Incorporated and its suppliers,\n * if any.  The intellectual and technical concepts contained\n * herein are proprietary to Adobe Systems Incorporated and its\n * suppliers and are protected by all applicable intellectual property\n * laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe Systems Incorporated.\n **************************************************************************/\n\n/**\n * Simple singleton style utility container so all local storage related\n * stuff has a centralized wrapper.\n */\nvar iaw = iaw || { };\n\niaw.localstorage = {\n\tuserID: null,\n\n\t/**\n\t * Set a value to the local storage for a specified userID.\n\t *\n\t * @param userID            user's associated ID value\n\t * @param key               local store key\n\t * @param val               value to store\n\t */\n\tsetUserItem: function( key, val ) {\n\t\tif ( this.userID && key ) {\n\t\t\t// @ifdef DEBUG\n\t\t\t// iaw.log.console('[iaw.localstorage.setUserItem] Setting '+key+' to '+val);\n\t\t\t// @endif\n\t\t\twindow.localStorage[this.userID+'_'+key] = JSON.stringify(val);\n\t\t}\n\t},\n\n\t/**\n\t * Get a value from local storage for a specified userID.\n\t * If the value is not found, a null object is returned.\n\t *\n\t * @param userID            user's associated ID value\n\t * @param key               local store key\n\t * @return The stored value or null if not present.\n\t */\n\tgetUserItem: function( key ) {\n\t\tvar val = null;\n\n\t\tif ( this.userID && key ) {\n\t\t\tval = window.localStorage[this.userID+'_'+key] || null;\n\t\t}\n\n\t\ttry {\n\t\t\tval = JSON.parse(val);\n\t\t}\n\t\tcatch (err) {\n\t\t\tval = null;\n\t\t}\n\n\t\treturn val;\n\t},\n\n\t/**\n\t * Set a value to the local storage.\n\t *\n\t * @param key               local store key\n\t * @param val               value to store\n\t */\n\tsetGlobalItem: function( key, val ) {\n\t\tif ( key ) {\n\t\t\twindow.localStorage[key] = JSON.stringify(val);\n\t\t}\n\t},\n\n\t/**\n\t * Get a value from local storage.\n\t * If the value is not found, a null object is returned.\n\t *\n\t * @param key               local store key\n\t * @return The stored value or null if not present.\n\t */\n\tgetGlobalItem: function( key ) {\n\t\tvar val = null;\n\n\t\tif ( key ) {\n\t\t\tval = window.localStorage[key] || null;\n\t\t}\n\n\t\ttry {\n\t\t\tval = JSON.parse(val);\n\t\t}\n\t\tcatch (err) {\n\t\t\tval = null;\n\t\t}\n\t\t\n\t\treturn val;\n\t}\n};\n","/*************************************************************************\n * ADOBE CONFIDENTIAL\n * ___________________\n *\n *  Copyright 2015 Adobe Systems Incorporated\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe Systems Incorporated and its suppliers,\n * if any.  The intellectual and technical concepts contained\n * herein are proprietary to Adobe Systems Incorporated and its\n * suppliers and are protected by all applicable intellectual property\n * laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe Systems Incorporated.\n **************************************************************************/\n\n/**\n * Simple singleton style container so all logging related stuff has\n * a centeralized wrapper.\n */\nvar iaw = iaw || { };\n\niaw.log = {\n\n\t/**\n\t * Boolean flag to globally enable/disable logging.\n\t */\n\tenabled: true,\n\n\t/**\n\t * Default log prefix.\n\t */\n\tkLogPrefix: 'CCX-Start',\n\n\t/**\n\t * Send a message to the log. An optional prefix can be passed which will get\n\t * prepended to the message.\n\t *\n\t * @param msg           string object containing the log message\n\t * @param optParam      optional object containing either a string to prepend\n\t *                      to the message or an object containing multiple display\n\t *                      options. the format is:\n\t *                          { prefix: 'string', indent: number, alert: true, trace: false }\n\t */\n\tconsole : function(msg, optParam) {\n\n\t\tvar kIndentation = '     ';\n\t\tvar prefix       = '';\n\t\tvar depth        = 0;\n\t\tvar trace        = false;\n\n\t\t// parse out the optional parameters\n\t\tif (typeof optParam === 'object') {\n\t\t\tprefix  = (optParam.prefix) ? ' - ' + optParam.prefix   : prefix;\n\t\t\tdepth   = (optParam.indent) ? optParam.indent           : depth;\n\t\t\ttrace   = (optParam.trace) ? optParam.trace             : trace;\n\t\t}\n\t\telse if (typeof optParam === 'string') {\n\t\t\tprefix =  ' - ' + optParam;\n\t\t}\n\n\t\t// build up the default message\n\t\tvar logmsg = this.kLogPrefix+prefix+' :: ';\n\n\t\t// add indentation if requested\n\t\tfor (; depth > 0; depth--) { logmsg += kIndentation; }\n\t\tlogmsg += msg;\n\n\t\t// dump to the log file\n\t\tconsole.log(logmsg);\n\t\t// dump the stack so we know what happened\n\t\tif (trace) console.trace();\n\t},\n\n\t/**\n\t * Dumps a JavaScript object out to the log. An optional prefix can be passed which will get\n\t * prepended to the message.  This only works in the Chrome debugger.\n\t *\n\t * @param msg           string object containing the log message\n\t * @param prefix        optional object containing a string to prepend to the message\n\t */\n\tdump : function(obj, prefix) {\n\n\t\tconsole.log('<< '+this.kLogPrefix+' >> object: '+ ((prefix) ? prefix + ' - %o' : '%o'), obj);\n\t},\n\n\t/**\n\t * Shortcut to add a debugging prefixed message to the log.\n\t *\n\t * @param msg           string object containing the log message\n\t */\n\tdebug : function(msg) {\n\n\t\tthis.console(msg, 'DEBUG');\n\t},\n\n\t/**\n\t * Place a separator message in the log.\n\t */\n\tseparator : function() {\n\n\t\tconsole.log(this.kLogPrefix + '==========================================================');\n\t},\n\n\t/**\n\t * Send a separated message out to the log . An optional prefix can be passed which\n\t * will get prepended to the message.\n\t *\n\t * @param msg           string object containing the log message\n\t * @param prefix        optional object containing a string to prepend to the message\n\t */\n\tmark : function(msg, prefix) {\n\n\t\tthis.separator();\n\t\tthis.console('@'+Date()+' '+msg, prefix);\n\t},\n\n\t/**\n\t * Dumps out an options structure to the log.\n\t *\n\t * @param msg           string object containing the log message\n\t * @param obj           object to output\n\t * @param step          indentation step for recursive call\n\t */\n\tlogObject : function(msg, obj, step) {\n\n\t\tthis.console(msg);\n\t\tstep = (typeof step !== 'undefined') ? step : 1;\n\n\t\t// walk throug the object\n\t\tif (typeof obj !== 'undefined' && obj !== null) {\n\t\t\tvar otype = null;\n\n\t\t\tswitch (typeof obj) {\n\t\t\t\tcase 'object':\n\t\t\t\t\tfor (var member in obj) {\n\t\t\t\t\t\totype = typeof obj[member];\n\t\t\t\t\t\tthis.console(member +' = '+obj[member]+' ('+otype+')', { indent: step });\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\t// process array\n\t\t\t\tcase 'array': {\n\t\t\t\t\tvar arraylen = obj.length;\n\n\t\t\t\t\tfor (var idx = 0; idx < arraylen; idx++) {\n\t\t\t\t\t\totype = typeof obj[idx];\n\t\t\t\t\t\tthis.console('array['+idx+']= '+obj[idx]+' ('+otype+')', { indent: step });\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tdefault: // atomic type\n\t\t\t\t\tthis.console('('+typeof obj+') : '+obj, { indent: step });\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Dumps out a JSON object structure to the log.\n\t *\n\t * @param msg           string object containing the log message\n\t * @param jsonData      string or object containing the JSON\n\t */\n\tlogJSON : function(msg, jsonData) {\n\n\t\tif (window.__adobe_cep__) {\n\t\t\t// CEP log changed and \\n is not supported so\n\t\t\t// makes the data more difficult to read\n\t\t\tthis.console(msg+' '+JSON.stringify(jsonData));\n\t\t}\n\t\telse {\n\t\t\tthis.console(msg+'\\n'+JSON.stringify(jsonData, null, 4));\n\t\t}\n\t},\n\n\t/**\n\t * Send an error object to the log. The error contains a message and a call stack list\n\t *\n\t * @param e             error object containing the exceptions\n\t */\n\texception : function(e) {\n\t\tconsole.trace();\n\t\tconsole.error(this.kLogPrefix+' EXCEPTION! '+ e.stack);\n\t}\n};\n","/*************************************************************************\n * ADOBE CONFIDENTIAL\n * ___________________\n *\n *  Copyright 2015 Adobe Systems Incorporated\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe Systems Incorporated and its suppliers,\n * if any.  The intellectual and technical concepts contained\n * herein are proprietary to Adobe Systems Incorporated and its\n * suppliers and are protected by all applicable intellectual property\n * laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe Systems Incorporated.\n **************************************************************************/\n\n/*\n\tOnly place in the app that should have a resize event handler. Add a callback to this module to receive resize events.\n\n\tDefers updates so callbacks are only called once per frame (using requestAnimationFrame), and will turn itself off after a number of frames following the last resize event.\n*/\nvar iaw = iaw || { };\n\niaw.motor = {\n\t_running: false,\n\t_steps: 0,\n\t_cycle: 30, // number of frames to step for\n\t_throttleSwitch: false,\n\t_pistons: [],\n\t_stopped: false,\n\n\tstart: function() {\n\t\tiaw.motor._running = false;\n\t\tthis._stopped = false;\n\t\tiaw.motor._steps = 0;\n\t\twindow.addEventListener('resize', iaw.motor.kick.bind(this), false);\n\t},\n\n\tstop: function() {\n\t\tthis._stopped = true;\n\t},\n\n\tupdate: function() {\n\t\tif (this._stopped) return;\n\t\tif (iaw.motor._steps++ > iaw.motor._cycle) {\n\t\t\t// only run for a stride, then automatically shut off\n\t\t\tiaw.motor._running = false;\n\t\t\treturn;\n\t\t}\n\n\t\tiaw.motor._throttleSwitch = !iaw.motor._throttleSwitch;\n\t\tif (iaw.motor._throttleSwitch) {\n\t\t\t// only run the pistons every other frame (30 fps throttle) because any more than that is overkill\n\t\t\tfor (var i = 0; i < iaw.motor._pistons.length; i++) {\n\t\t\t\tvar o = iaw.motor._pistons[i];\n\t\t\t\to.func.call(o.scope || window, iaw.motor._cycle - iaw.motor._steps);\n\t\t\t}\n\t\t}\n\n\t\twindow.requestAnimationFrame(iaw.motor.update);\n\t},\n\n\t// force an update cycle\n\tkick: function() {\n\t\tif (this._stopped) return;\n\t\tiaw.motor._steps = 0;\n\t\tif (iaw.motor._running) {\n\t\t\treturn;\n\t\t}\n\t\tiaw.motor._running = true;\n\t\tiaw.motor.update();\n\t},\n\n\t// in order to be able to ID functions we have to hash them to generate unique-ish keys for us to find them with later\n\t// if we don't do this, we won't be able to remove callbacks that were bound and save us from binding callbacks multiple times all over the place\n\tadd: function(cb, scope) {\n\t\tif (!cb) console.error('[iaw.motor.add] Pass in a valid function');\n\t\tvar k = iaw.util.hashStr(cb.toString());\n\t\tvar h = iaw.motor.has(k, scope);\n\t\tif (h === -1) {\n\t\t\tiaw.motor._pistons.push({\n\t\t\t\tfunc: cb,\n\t\t\t\tscope: scope,\n\t\t\t\tkey: k\n\t\t\t});\n\t\t}\n\t},\n\n\tremove: function(cb) {\n\t\tvar k = iaw.util.hashStr(cb.toString());\n\t\tvar i = iaw.motor.has(k);\n\t\tif (i !== -1) {\n\t\t\tiaw.motor._pistons.splice(i, 1);\n\t\t}\n\t},\n\n\t// check if the handler already has iaw.motor particular callback\n\thas: function(k, scope) {\n\t\tvar n = -1;\n\t\tvar s = null;\n\t\tvar i;\n\t\tfor (i = 0; i < iaw.motor._pistons.length; i++) {\n\t\t\tn = iaw.motor._pistons[i].key;\n\t\t\ts = iaw.motor._pistons[i].scope;\n\t\t\tif (n === k && s === scope) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t}\n\n\t/*\n\t\tNothing to do with motor but this has a RAF, so in order to keep track of all the RAF things, let's put them in this module.\n\t\tscrollTarget \t\tElement \tThe element to scroll to\n\t\t[scrollDuration] \tNumber \t\tHow long the animation takes in milliseconds. Defaults to 500.\n\t*/\n\t/*scrollToTarget: function(scrollTarget, scrollContainer, scrollDuration) {\n\n\t}*/\n};\n","/*\n\tUtility to help measure startup performance.\n*/\niaw.perf = {\n\n\ttimers: {\n\t\tDataTime: 'all data loaded',\n\t\tHostData: 'host data',\n\t\tHostPresetData: 'host preset data',\n\t\tPSDKData: 'psdk data',\n\t\tStockData: 'stock data',\n\t\tLicensedData: 'licensed templates',\n\t\tLoadLibraryFile: 'CC Libraries script load',\n\t\tInitLibrary: 'CC Libraries init',\n\t\tRetrieveLicensedTemplate: 'retreive licensed template',\n\t\tTemplateFixup: 'template fixup',\n\t\tInitHost: 'host init',\n\t\tInitStock: 'stock init',\n\t\tJSLibLateLoad: 'JS scripts late load',\n\t\tInitLicensed: 'licensed templates init',\n\t\tUI: 'UI scripts load',\n\t\tLoadTime: 'total load time',\n\t\tInteractiveTime: 'interactive ready',\n\t\tFinalizeData: 'finalize all data',\n\t\tRenderTime: 'render time',\n\t\tStockDataRequest: 'stock data request',\n\t\tPostStockData: 'postprocess stock data',\n\t\tCORELIBS: 'data store lib & iaw load',\n\t\tINGESTCONFIG: 'Ingest config'\n\t},\n\n\t_timers: {},\n\t_startMark: 0,\n\t_measures: [],\n\t_logToHighBeam: false,\n\n\t/**\n\t * Private method for calculating the global delta off the last set start mark.\n\t *\n\t * @return {Number} containing the global delta value.\n\t */\n\t_globalDelta: function() {\n\t\tvar now = window.performance.now();\n\t\tvar delta = 0;\n\n\t\tif (this._startMark) {\n\t\t\tdelta = Math.round(now - this._startMark);\n\t\t}\n\t\treturn delta;\n\t},\n\n\t/**\n\t * Set an optional start mark. If this is set then all measures will include\n\t * a global delta time from the start mark.\n\t *\n\t * @param start \t\ttime mark to start from\n\t */\n\tmarkStart: function(start) {\n\t\tthis._startMark = start || window.performance.now();\n\t},\n\n\t/**\n\t * Enable HighBeam performance logging.\n\t *\n\t * @param enabled \t\t{Boolean} enablement flag\n\t * @param category \t\t{String} HighBeam category identifier (required)\n\t */\n\tsetHighBeamMode: function(enabled, category) {\n\t\tif (!category) {\n\t\t\tconsole.log('CCX-Performance: Error \\'category\\' parameter is required for HighBeam perfromance logging, data will not be sent.');\n\t\t\tthis._logToHighBeam = false;\n\t\t\treturn;\n\t\t}\n\t\tthis._logToHighBeam = enabled;\n\t\tthis._highBeamCategory = category;\n\t},\n\n\t/**\n\t * Set a timer mark.\n\t *\n\t * @param strID\t\tstring ID for timer\n\t */\n\tset: function(strID) {\n\t\tconsole.time(strID);\n\t\tthis._timers[strID] = window.performance.now();\n\t\tthis._measures.push({\n\t\t\tmode: 'set',\n\t\t\tid: strID,\n\t\t\tglobalDelta: this._globalDelta()\n\t\t});\n\t},\n\n\t/**\n\t * Determine the delta between the set mark an now.\n\t *\n\t * @param strID\t\tstring ID for timer mark\n\t * @param startup\tOptional start timing in case it wasn't measure with `set`\n\t */\n\tmeasure: function(strID, start) {\n\t\tconsole.timeEnd(strID);\n\n\t\tif (!this._timers[strID] && !start) {\n\t\t\tconsole.log('[perf.measure] metric for key: \\''+strID+'\\' was not set - ignoring measure mark');\n\t\t\treturn;\n\t\t}\n\t\tstart = start || this._timers[strID];\n\n\t\tvar now = window.performance.now();\n\t\tvar measure = {\n\t\t\tmode: 'measure',\n\t\t\tid: strID,\n\t\t\tdeltaT: Math.round(now - start),\n\t\t\tglobalDelta: this._globalDelta()\n\t\t};\n\n\t\tthis._measures.push(measure);\n\t},\n\n\t/**\n\t * Report out all measurements to the log and optionally to HighBeam.\n\t *\n\t * @param clearMeasures\t\t{Boolean} value to clear stored measures after report\n\t */\n\treport: function(clearMeasures) {\n\t\tvar count = this._measures.length;\n\t\tvar pipDataGroup = {};\n\n\t\tconsole.log('[perf.report] ----------------------------------------------');\n\t\tfor (var index = 0; index < count; ++index) {\n\t\t\tvar measure = this._measures[index];\n\t\t\tvar message = null;\n\n\t\t\tif (measure.mode === 'measure') {\n\t\t\t\tmessage = '[perf.measure] '+ measure.id+': '+measure.deltaT+' ms (global: '+measure.globalDelta+' ms)';\n\t\t\t\tpipDataGroup[measure.id] = measure.deltaT;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tmessage = '[perf.set] mark for: '+measure.id+' (global: '+measure.globalDelta+' ms)';\n\n\t\t\t}\n\t\t\tconsole.log(message);\n\t\t}\n\t\tif (this._logToHighBeam) {\n\t\t\tiaw.analytics.pip.logDataGroupEvent('Startup Performance', pipDataGroup, this._highBeamCategory, 'performance');\n\t\t}\n\t\t// remove all measures if requested\n\t\tif (clearMeasures) {\n\t\t\tthis._measures.length = 0;\n\t\t}\n\t}\n};\n","/*************************************************************************\n * ADOBE CONFIDENTIAL\n * ___________________\n *\n *  Copyright 2015 Adobe Systems Incorporated\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe Systems Incorporated and its suppliers,\n * if any.  The intellectual and technical concepts contained\n * herein are proprietary to Adobe Systems Incorporated and its\n * suppliers and are protected by all applicable intellectual property\n * laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe Systems Incorporated.\n **************************************************************************/\n\n/**\n * Simple singleton style utility container so all utility related\n * stuff has a centralized wrapper.\n */\nvar iaw = iaw || { };\n\niaw.profile = {\n\n\t/**\n\t * Configuration\n\t */\n\tconfigurations: {\n\t\tstage: {\n\t\t\turl:\t'https://cc-collab-stage.adobe.io/profile',\n\t\t\texpirationDays: 1\n\t\t},\n\t\tprod: {\n\t\t\turl:\t'https://cc-collab.adobe.io/profile',\n\t\t\texpirationDays: 1\n\t\t}\n\t},\n\tconfig: null,\n\tretryAttempt: \t0,\n\n\t/**\n\t * Fetch profile image.\n\t * @param userGUID     user GUID\n\t * @param token        access token\n\t */\n\tfetchImage: function(userGUID, token, callback) {\n\t\tvar self = this;\n\t\tvar url;\n\n\t\tiaw.util.promise('GET', self.config.url, token)\n\t\t.then(function(response) {\n\t\t\tswitch (typeof response) {\n\t\t\t\tcase 'string':\n\t\t\t\t\turl = JSON.parse(response).user.avatar;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'object':\n\t\t\t\t\turl = response.user.avatar;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (!url) return callback(null);\n\t\t\tiaw.util.downLoadImage( url, function(blob) {\n\t\t\t\tif (!blob) {\n\t\t\t\t\tif (self.callback) {\n\t\t\t\t\t\tself.callback( null );\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar reader = new window.FileReader();\n\n\t\t\t\treader.readAsDataURL( blob );\n\t\t\t\treader.onloadend = function() {\n\t\t\t\t\tvar imageBase64 = reader.result;\n\n\t\t\t\t\tiaw.localstorage.setUserItem('profile_image', imageBase64 );\n\t\t\t\t\tiaw.localstorage.setUserItem('profile_image_timestamp', new Date().getTime() );\n\t\t\t\t\tiaw.log.debug( '[' + url + '] Downloaded profile image for user [' + userGUID + ']' );\n\t\t\t\t\tcallback(imageBase64);\n\t\t\t\t};\n\t\t\t});\n\t\t\tself.retryAttempt = 0;\n\t\t})\n\t\t.catch(function(err) {\n\t\t\tiaw.log.debug( 'Fail to download profile image with retryAttempt=' + self.retryAttempt);\n\t\t\tif (self.retryAttempt  === 0) {\n\t\t\t\t// access token is expired. Clear access token and retry once.\n\t\t\t\tiaw.cepUtil.clearAccessToken();\n\t\t\t\tself.getProfilePicture( userGUID, callback, ++self.retryAttempt );\n\t\t\t}\n\t\t});\n\t},\n\n\t/**\n\t * Check to see if we have a profile picture and make sure\n\t * it is not expired.\n\t *\n\t * @param userGUID     user GUID\n\t * @return true if available from cache, false otherwise\n\t */\n\tisProfilePictureAvailable: function( userGUID ) {\n\n\t\tvar isAvailable = false;\n\n\t\t// make sure we have the configuration setup - if not\n\t\t// set the default to the production configuration\n\t\tvar expirationDays =  this.config.expirationDays;\n\n\t\t// fetch image from local storage if it was cached within expirationDays\n\t\tvar imageBase64 = iaw.localstorage.getUserItem('profile_image');\n\t\tvar timestamp   = iaw.localstorage.getUserItem('profile_image_timestamp');\n\n\t\tif ( imageBase64 && timestamp ) {\n\t\t\tvar days = ( new Date().getTime() - timestamp ) / ( 24 * 3600 * 1000 );\n\n\t\t\tisAvailable = ( timestamp && days < expirationDays );\n\t\t}\n\t\treturn isAvailable;\n\t},\n\n\t/**\n\t * Public API\n\t */\n\n\t/**\n\t * Get Profile picture.\n\t *\n\t * @param userGUID     user GUID\n\t * @param callback     completion callback method\n\t * @param retryAttempt retry times once token is expired\n\t */\n\tgetProfilePicture: function( userGUID, callback, retryAttempt ) {\n\t\tthis.retryAttempt = retryAttempt || 0;\n\t\tthis.config = this.config || (iaw.cepUtil.usingStageAuthentication() ? this.configurations.stage : this.configurations.prod);\n\n\t\tiaw.log.debug('Start to get profile Picture, for user [' + userGUID + ']');\n\n\t\t// check to see if we already have one cached\n\t\tif ( this.isProfilePictureAvailable( userGUID ) ) {\n\t\t\tiaw.log.debug( 'Found cached profile image for user [' + userGUID + ']');\n\t\t\tvar imageBase64 = iaw.localstorage.getUserItem('profile_image');\n\t\t\tif ( callback ) { callback( imageBase64 ); }\n\t\t\treturn;\n\n\t\t}\n\n\t\t// no cached profile image available, then access profile api to get a new one\n\t\tiaw.cepUtil.getIMSAccessToken( function( token ) {\n\t\t\tiaw.profile.fetchImage( userGUID, token, callback );\n\t\t});\n\t}\n};\n","/*************************************************************************\n * ADOBE CONFIDENTIAL\n * ___________________\n *\n *  Copyright 2016 Adobe Systems Incorporated\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe Systems Incorporated and its suppliers,\n * if any.  The intellectual and technical concepts contained\n * herein are proprietary to Adobe Systems Incorporated and its\n * suppliers and are protected by all applicable intellectual property\n * laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe Systems Incorporated.\n **************************************************************************/\n\n/**\n * Simple singleton style container so all Stock related stuff has a centralized point.\n */\nvar iaw = iaw || { };\n\niaw.stockUtil = {\n\tSTOCK_NAMESPACE: 'adobestock',\n\tSTOCK_DATA_KEY: 'trackingdata',\n\tSTOCK_STATE_PURCHASED: 'purchased',\n\tSTOCK_STATE_NOT_PURCHASED: 'not_purchased',\n\n\tSTOCK_URL_LICENSE: 'https://www.adobe.com/go/stocklicense_',\n\tSTOCK_URL: 'https://stock.adobe.com',\n\tSTOCK_URL_SEARCH: 'https://stock.adobe.com/Search',\n\tSTOCK_URL_STAGE: 'https://primary.staging.adobestock.com',\n\tSTOCK_URL_SEARCH_STAGE: 'https://primary.staging.adobestock.com/Search',\n\n\t/**\n\t * Get Stock data from representation.\n\t *\n\t * @param [Object] representation\trepresentation of cc library element\n\t * @return [Object] Stock data\n\t */\n\tgetStockData: function(representation) {\n\t\treturn representation && representation.getValue(this.STOCK_NAMESPACE, this.STOCK_DATA_KEY);\n\t},\n\n\t/**\n\t * Get Stock data from cc library element.\n\t *\n\t * @param [Object] element \tcc library element\n\t * @param [Number] index \tindex of representation in cc library element\n\t * @return [Object] Stock data\n\t */\n\tgetStockDataForElement: function(element, index) {\n\t\t// First try the primary representation\n\t\tvar representation = index === undefined ? element.getPrimaryRepresentation() : element.representations[index];\n\t\tvar stockData = this.getStockData(representation);\n\n\t\tif (stockData && representation.isExternalLink && representation.getCachedExternalLinkError()) {\n\t\t\t// It's an external link, but the external link isn't valid: Try the next representation\n\t\t\treturn iaw.stockUtil.getStockDataForElement(element, index === undefined ? 0 : index + 1);\n\t\t}\n\n\t\treturn stockData;\n\t},\n\n\t/**\n\t * Get Stock Id from cc library element.\n\t *\n\t * @param [Object] element \tcc library element\n\t * @return [String] Stock Id\n\t */\n\tgetElementStockId: function(element) {\n\t\tvar stockData = this.getStockDataForElement(element);\n\t\tif (stockData) {\n\t\t\treturn Number(stockData.content_id);\n\t\t}\n\t\treturn undefined;\n\t},\n\n\t/**\n\t * Get Stock license status from cc library element.\n\t *\n\t * @param [Object] element \tcc library element\n\t * @return [String] Stock license status\n\t */\n\tgetElementStockLicense: function(element) {\n\t\tvar stockData = this.getStockDataForElement(element);\n\t\tif (stockData) {\n\t\t\tif (stockData.state === this.STOCK_STATE_PURCHASED) {\n\t\t\t\treturn String(stockData.license);\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t},\n\n\t/**\n\t * License Stock template.\n\t *\n\t * @param [String] imageId \t\tcontent Id of template\n\t * @param [String] licenseType \tlicense type of template\n\t * @return [Promise] promise that will resolve the result to license template\n\t */\n\tlicenseTemplate: function(imageId, licenseType) {\n\t\treturn new Promise(function(resolve, reject) {\n\t\t\tiaw.cepUtil.setEnvironment(iaw.cepUtil.usingStageAuthentication() ? 'stage' : 'prod');\n\t\t\tiaw.cepUtil.getIMSAccessToken(function(token) {\n\t\t\t\tif (!token) {\n\t\t\t\t\treject('Invalid access token.');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar url = iaw.cepUtil.usingStageAuthentication() ? 'https://stock-stage.adobe.io/Rest/Libraries/1/Content/License?' : 'https://stock.adobe.ioRest/Libraries/1/Content/License?';\n\t\t\t\turl += 'content_id=' + imageId + '&license=' + licenseType;\n\t\t\t\tiaw.util.promise('GET', url, token).then(function(res) {\n\t\t\t\t\tif (typeof res === 'string') {\n\t\t\t\t\t\tres = JSON.parse(res);\n\t\t\t\t\t}\n\t\t\t\t\tresolve(res);\n\t\t\t\t}).catch(function(err) {\n\t\t\t\t\treject(err);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t},\n\n\t/**\n\t * Create the URL to open/use for the selected Adobe Stock template.\n\t * https://wiki.corp.adobe.com/display/adobestock/Jump+to+Adobe+Stock+Search+Pages\n\t *\n\t * @param [String] hostID\tphxs, ilst, etc.\n\t * @param [String] type     template type\n\t * @param [String] term     search term, if any\n\t * @return [String] containing the URL that was opened\n\t */\n\tcomposeStockLink: function( hostID, type, term ) {\n\t\tvar baseURL = iaw.cepUtil.usingStageAuthentication() ? this.STOCK_URL_SEARCH_STAGE : this.STOCK_URL_SEARCH;\n\t\tvar category = -1;\n\t\tvar application = 0;\n\n\t\tterm = typeof term === 'undefined' ? '' : term;\n\n\t\tswitch (type) {\n\t\t\tcase 'recent':\n\t\t\tcase 'saved':\n\t\t\t\tcategory = 0;\n\t\t\t\tbreak;\n\t\t\tcase 'mobile':\n\t\t\t\tcategory = 1;\n\t\t\t\tbreak;\n\t\t\tcase 'web':\n\t\t\t\tcategory = 2;\n\t\t\t\tbreak;\n\t\t\tcase 'print':\n\t\t\t\tcategory = 3;\n\t\t\t\tbreak;\n\t\t\tcase 'photo':\n\t\t\t\tcategory = 4;\n\t\t\t\tbreak;\n\t\t\tcase 'film':\n\t\t\t\tcategory = 5;\n\t\t\t\tbreak;\n\t\t\tcase 'art':\n\t\t\t\tcategory = 6;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tcategory = -1; // signify error\n\t\t\t\tbreak;\n\t\t}\n\n\t\tswitch (hostID) {\n\t\t\tcase 'PHXS':\n\t\t\t\tapplication = 1;\n\t\t\t\tbreak;\n\t\t\tcase 'ILST':\n\t\t\t\tapplication = 2;\n\t\t\t\tbreak;\n\t\t\tcase 'IDSN':\n\t\t\t\tapplication = 3;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tapplication = 0;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tterm = term ? 'k=' + iaw.util.fixedEncodeURIComponent(term) + '&' : '';\n\t\tterm += iaw.analytics.getAnalyticsQueryString() + '&'; // includes language and other host data\n\n\t\tvar query = 'filters[content_type:template]=1&filters[template_type_id][]=' + application;\n\t\t// in order to search all categories, remove the filter\n\t\tvar cat = category === 0 ? '' : '&filters[template_category_id][]=' + category;\n\t\tvar analyticsQuery = '&as_channel=adobe_apps&as_source=app&as_campclass=brand&as_campaign=templates_' + hostID;\n\t\tvar featureFlag = 'ff_4815162342=true&';\n\n\t\treturn (baseURL + '?' + featureFlag + term + query + cat + analyticsQuery);\n\t},\n\t\n\t/**\n\t * Open Adobe Stock URL given the product and template type\n\t * https://wiki.corp.adobe.com/display/adobestock/Jump+to+Adobe+Stock+Search+Pages\n\t *\n\t * @param [String] hostID\tphxs, ilst, etc.\n\t * @param [String] type     template type\n\t * @param [String] term     search term, if any\n\t * @return [String] containing the URL that was opened\n\t */\n\topenStockLink: function( hostID, type, term ) {\n\t\tvar uri = this.composeStockLink(hostID, type, term);\n\n\t\tif (window.__adobe_cep__) {\n\t\t\tiaw.util.openDefaultBrowserAuthenicated('adobeStock', uri);\n\t\t}\n\t\telse {\n\t\t\twindow.open(uri);\n\t\t}\n\t\treturn uri;\n\t}\n};\n","/*************************************************************************\n * ADOBE CONFIDENTIAL\n * ___________________\n *\n *  Copyright 2015 Adobe Systems Incorporated\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe Systems Incorporated and its suppliers,\n * if any.  The intellectual and technical concepts contained\n * herein are proprietary to Adobe Systems Incorporated and its\n * suppliers and are protected by all applicable intellectual property\n * laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe Systems Incorporated.\n **************************************************************************/\n\n/**\n * Simple singleton style utility container so all utility related\n * stuff has a centralized wrapper.\n */\nwindow.iaw = window.iaw || { };\n\nwindow.iaw.util = {\n\n\tcurrentBreakPoint: 0,\n\tloadingLibrary: false, // flag indicates cc library is in loading or not\n\tlibraryCallbacks: [],\n\tccxProcessLaunchPending: false,\n\n\n\t/**\n\t* Get current time\n\t*/\n\tgetCurrentTime: function() {\n\t\tvar currentTime = new Date().getTime();\n\t\treturn currentTime;\n\t},\n\t/**\n\t * Determine if the current browser is running on a MS Windows based OS.\n\t *\n\t * @return A boolean value indicating true if the browser is on Windows,\n\t *          false otherwise.\n\t */\n\tisWindowsOS: function() {\n\n\t\treturn ( navigator.userAgent.indexOf('Mac OS X') === -1 );\n\t},\n\n\t/**\n\t * Convert a URL parameter string into an object.\n\t *\n\t * @return A object with key/value members created from the URL string.\n\t */\n\tconvertQueryString: function( search ) {\n\n\t\t// build out the JS object - note: this does not handle sub-objects (like the 'overrides' one)\n\t\tvar jsObj =  { };\n\n\t\tif ( search ) {\n\t\t\t// remove hash before parsing the query\n\t\t\tvar idx = search.indexOf('#');\n\n\t\t\tif (idx !== -1) {\n\t\t\t\tsearch = search.slice(0, idx);\n\t\t\t}\n\n\t\t\tvar jsData = '{\"' + search.replace(/&/g, '\",\"').replace(/=/g, '\":\"') + '\"}';\n\n\t\t\tjsObj = JSON.parse(jsData, function(key, value) {\n\n\t\t\t\tvar val = (key === '' ? value : decodeURIComponent(value));\n\n\t\t\t\t// check for numeric values & boolean - otherwise assume string\n\t\t\t\tif (isNaN( val )) { // boolean, or possibly a string\n\t\t\t\t\tif (val !== 'true') {\n\t\t\t\t\t\tval = (val !== 'false') ? val /* its a string */ : false;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tval = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {  // numeric\n\t\t\t\t\tval = parseFloat(val);\n\t\t\t\t}\n\n\t\t\t\treturn val;\n\t\t\t});\n\t\t}\n\n\t\treturn jsObj;\n\t},\n\n\t/**\n\t * Convert query string into an object. New one because the above throws an error and it's easier to write a new one than to debug the old one.\n\t * Usually you'll just want to pass in `location.hash`\n\t *\n\t * @return A object with key/value members created from the URL string.\n\t */\n\tparseQueryString: function(str) {\n\t\tvar ret = Object.create(null); // object with no proto so it won't break with bad param\n\n\t\tif (typeof str !== 'string') {\n\t\t\treturn ret;\n\t\t}\n\n\t\tstr = str.trim().replace(/^(\\?|#|&)/, '');\n\n\t\tif (!str) {\n\t\t\treturn ret;\n\t\t}\n\n\t\tstr.split('&').forEach(function(param) {\n\t\t\tvar parts = param.replace(/\\+/g, ' ').split('=');\n\t\t\t// Firefox (pre 40) decodes `%3D` to `=`\n\t\t\tvar key = parts.shift();\n\t\t\tvar val = parts.length > 0 ? parts.join('=') : undefined;\n\n\t\t\tkey = decodeURIComponent(key);\n\n\t\t\t// missing `=` should be `null`:\n\t\t\tval = val === undefined ? null : decodeURIComponent(val);\n\n\t\t\tif (ret[key] === undefined) {\n\t\t\t\tret[key] = val;\n\t\t\t}\n\t\t\telse if (Array.isArray(ret[key])) {\n\t\t\t\tret[key].push(val);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tret[key] = [ret[key], val];\n\t\t\t}\n\t\t});\n\n\t\treturn ret;\n\t},\n\n\t/**\n\t * Download image.\n\t * @param url        url to download\n\t * @param callback   completion callback method with the parameter of blob or null if any failure.\n\t */\n\tdownLoadImage: function( url, callback ) {\n\n\t\tiaw.log.debug( 'Downloading image from: ' + url );\n\t\tvar xhr = new XMLHttpRequest( );\n\n\t\txhr.onreadystatechange = function() {\n\t\t\tif ( this.readyState === 4 && this.status === 200 ) {\n\t\t\t\tiaw.log.debug( 'Image is downloaded.' );\n\t\t\t\tcallback( this.response );\n\t\t\t}\n\t\t};\n\t\txhr.onerror  = function( error ) {\n\t\t\tcallback( null );\n\t\t};\n\t\txhr.open( 'GET', url, true );\n\t\txhr.responseType = 'blob';\n\t\txhr.send( );\n\t},\n\n\t/**\n\t * Setup ajax request.\n\t * @param url        url to download\n\t * @param callback   completion callback method with the parameter of blob or null if any failure.\n\t */\n\tajax: function( url, callback, scope ) {\n\t\tvar xhr = new XMLHttpRequest();\n\n\t\txhr.onreadystatechange = function() {\n\t\t\tif ( this.readyState === 4 && this.status === 200 ) {\n\t\t\t\tcallback.call(scope || null, this.response);\n\t\t\t}\n\t\t};\n\n\t\txhr.onerror = function( error ) {\n\t\t\tiaw.log.debug('[util.ajax] Error');\n\t\t\tcallback.call(scope || null, error);\n\t\t};\n\t\txhr.open('GET', url, true);\n\t\txhr.send();\n\t},\n\n\t/**\n\t *\n\t */\n\tnormalize: function(v, min, max) {\n\n\t\treturn (v - min) / (max - min);\n\t},\n\n\t/**\n\t * Open a URL in the default browser.\n\t *\n\t * @param url string containing the URL to load\n\t */\n\topenDefaultBrowser: function( url, isAuthenticated ) {\n\n\t\tisAuthenticated = isAuthenticated || false;\n\n\t\t// skip the authenticated URL's because they dont mean anything... we want the base\n\t\tif ( !isAuthenticated ) {\n\t\t\tiaw.analytics.pip.logInteractionEvent( 'OpenExtLink:' + url );\n\t\t}\n\t\tif ( window.cep.util.openURLInDefaultBrowser ) {\n\t\t\twindow.cep.util.openURLInDefaultBrowser(url);\n\t\t}\n\t\telse {\n\t\t\twindow.open(url, '_blank');\n\t\t}\n\t},\n\n\t/**\n\t * Similar to openDefaultBrowser but uses creates an authenicated\n\t * jump url.\n\t *\n\t * @param clientKey\t\telement key that matches entry in iaw.cepUtil.authenticationInfo\n\t * @param url\t\t\tstring containing the URL to open\n\t */\n\topenDefaultBrowserAuthenicated: function( clientKey, url ) {\n\n\t\tif ( iaw.cepUtil.imsValid() ) {\n\t\t\tvar query = url.indexOf('?');\n\n\t\t\tiaw.analytics.pip.logInteractionEvent( 'OpenExtLink:' + url.substr(0, (query > 0) ? query : url.length) );\n\n\t\t\tvar callback = function(authenticatedURL) { //eslint-disable-line func-style\n\t\t\t\tiaw.log.console('The generated jumpURL is: ' + authenticatedURL);\n\t\t\t\tiaw.util.openDefaultBrowser( authenticatedURL, true );\n\t\t\t};\n\t\t\tthis.jumpToURL( iaw.cepUtil.authenticationInfo[clientKey].clientID,\n\t\t\t\t\t\t\tiaw.cepUtil.authenticationInfo[clientKey].clientScope,\n\t\t\t\t\t\t\turl, callback );\n\t\t}\n\t\telse {\n\t\t\tthis.openDefaultBrowser( url );\n\t\t}\n\t},\n\n\t/**\n\t * Set the UI theme mode.\n\t *\n\t * @param mode          color mode, 'light' or 'dark'\n\t */\n\tsetUIThemeMode: function( mode ) {\n\n\t\tswitch ( mode ) {\n\t\t\tcase 'light':\n\t\t\t\tdocument.body.classList.remove('spc--dark');\n\t\t\t\tbreak;\n\n\t\t\tcase 'dark':\n\t\t\t\tdocument.body.classList.add('spc--dark');\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\t// get the interface color -- if CEP is not present -\n\t\t\t\t// submit to the dark side cause its cooler...\n\t\t\t\tvar interfaceColor = ( iaw.cepUtil.csInterface ) ? iaw.cepUtil.getUIThemeColor() : null;\n\n\t\t\t\tthis.setUIThemeMode( (interfaceColor && interfaceColor.red >= 184) ? 'light' : 'dark' );\n\t\t\t\tbreak;\n\t\t}\n\t},\n\n\t/**\n\t * Method to generate a jump url. Only for CEP based applications. This method\n\t * will make a callback to deal with the jump url.\n\t *\n\t * @param clientID      SSO client ID\n\t * @param clientScope   SSO client scope\n\t * @param url           base url\n\t * @param callback      callback method which takes the following parameters:\n\t *                          the jump url to deal with\n\t */\n\tjumpToURL : function( clientID, clientScope, url,  callback) {\n\n\t\tif ( url && callback && clientID && clientScope ) {\n\t\t\tif (window.__adobe_cep__) {\n\t\t\t\tiaw.cepUtil.getIMSAccessToken( function(token) {\n\t\t\t\t\tif ( token ) {\n\t\t\t\t\t\tiaw.cepUtil.createJumpURL(clientID, clientScope, url, callback);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tiaw.log.console('No jump URL since access token is invalid.');\n\t\t\t\t\t\tcallback(url);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse { // no CEP present\n\t\t\t/*\n\t\t\t\t$.get('https://'+ getEnvironment().ims +'/ims/jumptoken/v1',\n\t\t\t\t\t  {\n\t\t\t\t\t  bearer_token:accessToken,\n\t\t\t\t\t  target_client_id:'AdobeStockClient1',\n\t\t\t\t\t  target_redirect_uri:url,\n\t\t\t\t\t  target_scope:'AdobeID,openid,creative_cloud,read_organizations,gnav,additional_info.address.mail_to,sao.stock'\n\t\t\t\t\t  })\n\t\t\t\t.success(function(data) {\n\t\t\t\t\t\t if (data.jump) {\n\t\t\t\t\t\t HelloLog.log('jump url:' + data.jump);\n\t\t\t\t\t\t callback(data.jump);\n\t\t\t\t\t\t }\n\t\t\t\t\t\t })\n\t\t\t\t.error(function(jqXHR, textStatus, errorThrown) {\n\t\t\t\t\t   console.log('jump url error: ' + errorThrown);\n\t\t\t\t\t   callback(url);\n\t\t\t\t\t   });\n\t\t\t\t*/\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Method to append an external script to the head\n\t *\n\t * @param script        script path\n\t * @return [Promise] promise that will resolve when the script is loaded\n\t */\n\tloadExternalScript : function( script ) {\n\t\treturn new Promise(function(resolve, reject) {\n\t\t\tvar scriptTag = document.createElement('script');\n\t\t\t// setup properties so it's interpreted correctly and loads asynchronously\n\t\t\tscriptTag.type = 'text/javascript';\n\t\t\tscriptTag.charset = 'utf-8';\n\t\t\t// ASYNC: load in parallel and execute as soon as possible\n\t\t\tscriptTag.async = true;\n\t\t\t// DEFER: load in parallel but maintain execution order\n\t\t\tscriptTag.defer = false;\n\t\t\tscriptTag.src = script;\n\t\t\tscriptTag.onload = function() {\n\t\t\t\tresolve(scriptTag);\n\t\t\t};\n\t\t\tscriptTag.onerror = function(error) {\n\t\t\t\treject(error);\n\t\t\t};\n\t\t\t// kick off the load, directly to body so we don't have to traverse to find the head\n\t\t\tdocument.body.appendChild(scriptTag);\n\t\t});\n\t},\n\n\t/**\n\t * Format the a Date object in the correct string layout for Radar.\n\t * This method is a percaution in case someone changes the required\n\t * date format, and we won't need to hunt throught the code to change\n\t * all the instances of moment.format\n\t *\n\t * @param [Date] stamp     Date time stamp to format\n\t * @return [String] in the date format YYYY-MM-DDTHH:mm:ss.SSS-XXXX\n\t */\n\tformatTimeStamp : function( stamp ) {\n\n\t\treturn window.moment(stamp).format('YYYY-MM-DDTHH:mm:ss.SSSZZ');\n\t},\n\n\t/**\n\t * Method to get trial end date.\n\t *\n\t * @param secondsLeftInTrial      seconds left in trial\n\t */\n\tgetTrialEndDate : function( secondsLeftInTrial ) {\n\n\t\tvar trialEndDate = new Date(new Date().getTime() + secondsLeftInTrial * 1000);\n\n\t\treturn (secondsLeftInTrial >= 0) ? this.formatTimeStamp(trialEndDate) : null;\n\t},\n\n\t/**\n\t * Generate a rfc4122 version 4 compliant GUID.\n\t * @see http://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\n\t *\n\t * @return A string containing the GUID\n\t */\n\tgenerateGUID : function() {\n\n\t\t/*jshint bitwise: false*/\n\t\treturn 'xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n\t\t\t// 'x|0' is a shortcut for 'Math.floor(x)'\n\t\t\tvar r = Math.random()*16|0;\n\t\t\tvar v = (c === 'x') ? r : (r&0x3|0x8);\n\n\t\t\treturn v.toString(16);\n\t\t});\n\t},\n\n\t/**\n\t * Open the Library panel to a specific library\n\t *\n\t * @param The ID of the library you want to show\n\t */\n\tshowLibraryInPanel : function( libraryId ) {\n\n\t\tvar csInterface = new CSInterface();\n\t\tvar emitEvent   = function() { //eslint-disable-line func-style\n\t\t\tvar setLibEvent = new CSEvent('dlSetCurrentLibrary', 'APPLICATION');\n\n\t\t\tsetLibEvent.data = {'libraryId' : libraryId};\n\t\t\tcsInterface.dispatchEvent(setLibEvent);\n\t\t};\n\n\t\tvar handlePanelInitialized = function() { //eslint-disable-line func-style\n\t\t\tcsInterface.removeEventListener('dlPanelInitialized', handlePanelInitialized);\n\t\t\tsetTimeout(emitEvent, 200);\n\t\t};\n\n\t\t// Emit the event once incase the panel is already open\n\t\temitEvent();\n\n\t\t// Emit the event after panel is initialized\n\t\tcsInterface.addEventListener('dlPanelInitialized', handlePanelInitialized);\n\n\t\t// Launch the extension incase if it's not already open\n\t\tcsInterface.requestOpenExtension('com.adobe.DesignLibraries.angular', '');\n\t},\n\n\t/**\n\t * Promise helper function\n\t *\n\t * @param The method you want to use\n\t * @param The URL of the service\n\t * @param More http headers\n\t * @param An array of ignored http status\n\t */\n\tpromise : function( method, url, token, headers, ignoredStatus ) {\n\n\t\treturn new Promise(function(resolve, reject) {\n\t\t\tvar request = new XMLHttpRequest();\n\t\t\trequest.open(method, url, true);\n\n\t\t\trequest.onload = function() {\n\t\t\t\tif (request.status === 200 || request.status === 202) {\n\t\t\t\t\tresolve(request.response);\n\t\t\t\t}\n\t\t\t\telse if (ignoredStatus && ignoredStatus.indexOf(request.status) > -1) {\n\t\t\t\t\tresolve(request.status);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\treject(request.statusText);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\trequest.onerror = function() {\n\t\t\t\treject(request.statusText || 'Network Error');\n\t\t\t};\n\n\t\t\tif (token) {\n\t\t\t\trequest.setRequestHeader('x-api-key', 'CCXInAppWelcome');\n\t\t\t\trequest.setRequestHeader('Content-Type', 'application/json');\n\t\t\t\trequest.setRequestHeader('Authorization', 'Bearer ' + token);\n\t\t\t\tif (headers) {\n\t\t\t\t\tObject.keys(headers).forEach(function(key) {\n\t\t\t\t\t\tif (typeof headers[key] !== 'undefined') {\n\t\t\t\t\t\t\trequest.setRequestHeader(key, headers[key]);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\trequest.send();\n\t\t});\n\t},\n\n\t/**\n\t * Handle status coming back from the host ExtendScript method,\n\t * closes the extension is status is 'true'. Remember callbacks/continuation\n\t * methods from ExtendScript always send params as strings.\n\t *\n\t * @param status       string containing 'false' if cancelled/error, 'true' otherwise\n\t */\n\tcloseExtOnStatus: function(status) {\n\t\tif ((status.toLowerCase() === 'true') && window.__adobe_cep__) {\n\t\t\tiaw.analytics.ingest.logScreenStateEvent('close-auto');\n\t\t\tiaw.cepUtil.sendEvent(iaw.cepUtil.events.REQUESTHOSTCLOSE, null);\n\t\t}\n\t},\n\n\t/**\n\t * To be more stringent in adhering to RFC 3986 (which reserves !, ', (, ), and *),\n\t * even though these characters have no formalized URI delimiting uses.\n\t *\n\t * @param str\t\t\tstring to encode\n\t * @return String object encoded for URI\n\t * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent\n\t */\n\tfixedEncodeURIComponent: function(str) {\n\t\tvar encoded = (str && str.length) ? encodeURIComponent(str).replace(/[!'()*]/g, function(c) {\n\t\t\treturn '%' + c.charCodeAt(0).toString(16);\n\t\t}) : str;\n\n\t\treturn encoded;\n\t},\n\n\t/**\n\t * Round to the nearest decimal\n\t *\n\t * @param {Number} num\n\t * @param {Number} decimal - how many decimal places you want to round to\n\t * @return {Number} - number rounded to the correct number of decimals\n\t */\n\troundDecimal: function(num, decimal) {\n\t\treturn Number(Math.round(Number(num).toFixed(20) + ('e' + decimal)) + ('e-' + decimal));\n\t},\n\n\t/**\n\t * Using the ceiling of the closest decimal\n\t * Example: ceilDecimal(0.131, 2); // 0.14\n\t *\n\t * @param {Number} num\n\t * @param {Number} decimal - how many decimal places you want to round to\n\t * @return {Number} - number rounded to the correct number of decimals\n\t */\n\tceilDecimal: function(num, decimal) {\n\t\treturn Number(Math.ceil(Number(num).toFixed(20) + ('e' + decimal)) + ('e-' + decimal));\n\t},\n\n\t/**\n\t * Using the floor of the closest decimal\n\t * Example: floorDecimal(0.131, 2); // 0.13\n\t *\n\t * @param {Number} num\n\t * @param {Number} decimal - how many decimal places you want to round to\n\t * @return {Number} - number rounded to the correct number of decimals\n\t */\n\tfloorDecimal: function(num, decimal) {\n\t\treturn Number(Math.floor(Number(num).toFixed(20) + ('e' + decimal)) + ('e-' + decimal));\n\t},\n\n\t/**\n     *\n     *\n     * @param target \tIf string, will mount the tag to first element matched with querySelector; else, assume it's an element\n     *\n\t */\n\tmountTag: function(target, tagName, data, animClassIn, animClassOut) {\n\t\tdata = data || null;\n\t\tanimClassOut = animClassOut || 'anim--fade-out';\n\t\tanimClassIn = animClassIn || 'anim--fade-in';\n\n\t\tvar parent = target;\n\t\tif (typeof parent === 'string') {\n\t\t\tparent = document.querySelector(target);\n\t\t\tif (!parent) {\n\t\t\t\tconsole.warn('[iaw.util.mountTag] No element found with selector '+target);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tfunction onEnd(evt) {\n\t\t\t// console.log('[mount] onEnd');\n\t\t\tparent.removeEventListener('webkitTransitionEnd', onEnd);\n\t\t\tparent.removeEventListener('webkitAnimationEnd', onEnd);\n\t\t\tparent.removeEventListener('animationend', onEnd);\n\n\t\t\tparent.classList.remove(animClassOut);\n\t\t\tparent.classList.add(animClassIn);\n\t\t\triot.mount(parent, tagName, data);\n\t\t}\n\n\t\t// just in case it was there\n\t\tparent.classList.remove('hidden');\n\t\tparent.classList.remove(animClassOut);\n\t\tparent.classList.remove(animClassIn);\n\n\t\tif (parent.children.length > 0 || parent.attributes['data-is']) {\n\t\t\t// if there's already something in here, fade it out\n\t\t\tparent.addEventListener('webkitTransitionEnd', onEnd, false);\n\t\t\tparent.addEventListener('webkitAnimationEnd', onEnd, false);\n\t\t\tparent.addEventListener('animationend', onEnd, false);\n\n\t\t\tparent.classList.add(animClassOut);\n\t\t}\n\t\telse {\n\t\t\t// animate it in immediately\n\t\t\tparent.classList.add(animClassIn);\n\t\t\triot.mount(parent, tagName, data);\n\t\t}\n\t},\n\n\t/**\n     *\n     *\n     * @param tagInstance\n     *\n\t */\n\tunmountTag: function(tagInstance, animClassIn, animClassOut) {\n\t\tanimClassOut = animClassOut || 'anim--fade-out';\n\t\tanimClassIn = animClassIn || 'anim--fade-in';\n\t\tvar parent = tagInstance.root;\n\n\t\tif (parent.classList.contains(animClassOut)) {\n\t\t\t// it's already animating out, so ignore\n\t\t\treturn;\n\t\t}\n\n\t\t// just in case it was there\n\t\tparent.classList.remove(animClassIn);\n\n\t\tfunction onEnd(evt) {\n\t\t\t// console.log('[unmount] onEnd');\n\t\t\tparent.removeEventListener('webkitTransitionEnd', onEnd);\n\t\t\tparent.removeEventListener('webkitAnimationEnd', onEnd);\n\t\t\tparent.removeEventListener('animationend', onEnd);\n\n\t\t\ttagInstance.unmount(true);\n\t\t\tparent.removeAttribute('data-is'); // must be a riot bug, because riot should remove this for us\n\t\t\tparent.classList.remove(animClassOut); // clean classList for next time\n\t\t\tparent.classList.add('hidden'); // remove from DOM\n\t\t}\n\n\t\tparent.addEventListener('webkitTransitionEnd', onEnd, false);\n\t\tparent.addEventListener('webkitAnimationEnd', onEnd, false);\n\t\tparent.addEventListener('animationend', onEnd, false);\n\n\t\tparent.classList.add(animClassOut);\n\t},\n\n\tshowElement: function(element, animClassIn, animClassOut) {\n\t\tanimClassOut = animClassOut || 'anim--fade-out';\n\t\tanimClassIn = animClassIn || 'anim--fade-in';\n\n\t\t// just in case it was there\n\t\telement.classList.remove('hidden');\n\t\telement.classList.remove(animClassOut);\n\t\telement.classList.remove(animClassIn);\n\n\t\telement.classList.add(animClassIn);\n\t},\n\n\thideElement: function(element, animClassIn, animClassOut) {\n\t\tanimClassOut = animClassOut || 'anim--fade-out';\n\t\tanimClassIn = animClassIn || 'anim--fade-in';\n\n\t\t// just in case it was there\n\t\telement.classList.remove(animClassOut);\n\t\telement.classList.remove(animClassIn);\n\n\t\tfunction onEnd(evt) {\n\t\t\telement.removeEventListener('webkitTransitionEnd', onEnd);\n\t\t\telement.removeEventListener('webkitAnimationEnd', onEnd);\n\t\t\telement.removeEventListener('animationend', onEnd);\n\t\t\telement.classList.add('hidden'); // remove from DOM\n\t\t}\n\n\t\telement.addEventListener('webkitTransitionEnd', onEnd, false);\n\t\telement.addEventListener('webkitAnimationEnd', onEnd, false);\n\t\telement.addEventListener('animationend', onEnd, false);\n\n\t\telement.classList.add(animClassOut);\n\t},\n\n\t/**\n     * Convert a country code to a shared cloud useable region\n     *\n     * @param countryCode    country code\n     * @return two digit region used in shared cloud call\n     *\n\t */\n\tgetRegionFromCountryCode: function(countryCode) {\n\t\treturn iaw.util.countryCodeMap[countryCode];\n\t},\n\t// keep this outside so it's only created once per app session, not once every time the function is called, or else we'll have a memory problem\n\tcountryCodeMap: {'US': 'us', 'CA': 'us', 'AI': 'us', 'AG': 'us', 'AR': 'us', 'AW': 'us', 'BS': 'us', 'BB': 'us', 'BZ': 'us', 'BM': 'us', 'BO': 'us', 'BR': 'us', 'KY': 'us', 'CL': 'us', 'CO': 'us', 'CR': 'us', 'DM': 'us', 'DO': 'us', 'EC': 'us', 'SV': 'us', 'FK': 'us', 'GF': 'us', 'GD': 'us', 'GP': 'us', 'GT': 'us', 'GY': 'us', 'HT': 'us', 'HN': 'us', 'JM': 'us', 'MQ': 'us', 'MX': 'us', 'MS': 'us', 'AN': 'us', 'NI': 'us', 'PA': 'us', 'PY': 'us', 'PE': 'us', 'KN': 'us', 'LC': 'us', 'PM': 'us', 'VC': 'us', 'GS': 'us', 'SR': 'us', 'TT': 'us', 'TC': 'us', 'UM': 'us', 'UY': 'us', 'VE': 'us', 'VG': 'us', 'AS': 'us', 'PR': 'us', 'GB': 'eu', 'AL': 'eu', 'DZ': 'eu', 'AD': 'eu', 'AO': 'eu', 'AM': 'eu', 'AT': 'eu', 'AZ': 'eu', 'BY': 'eu', 'BE': 'eu', 'BJ': 'eu', 'BA': 'eu', 'BW': 'eu', 'IO': 'eu', 'BG': 'eu', 'BF': 'eu', 'BI': 'eu', 'CM': 'eu', 'CV': 'eu', 'CF': 'eu', 'TD': 'eu', 'KM': 'eu', 'CD': 'eu', 'CG': 'eu', 'HR': 'eu', 'CY': 'eu', 'CZ': 'eu', 'DK': 'eu', 'DJ': 'eu', 'EG': 'eu', 'GQ': 'eu', 'ER': 'eu', 'EE': 'eu', 'ET': 'eu', 'FO': 'eu', 'FI': 'eu', 'FR': 'eu', 'GA': 'eu', 'GM': 'eu', 'GE': 'eu', 'DE': 'eu', 'GH': 'eu', 'GI': 'eu', 'GR': 'eu', 'GL': 'eu', 'GN': 'eu', 'GW': 'eu', 'HU': 'eu', 'IS': 'eu', 'IE': 'eu', 'IT': 'eu', 'CI': 'eu', 'KE': 'eu', 'LV': 'eu', 'LS': 'eu', 'LR': 'eu', 'LY': 'eu', 'LI': 'eu', 'LT': 'eu', 'LU': 'eu', 'MK': 'eu', 'MG': 'eu', 'MW': 'eu', 'ML': 'eu', 'MT': 'eu', 'MR': 'eu', 'MU': 'eu', 'YT': 'eu', 'MD': 'eu', 'MC': 'eu', 'ME': 'eu', 'MA': 'eu', 'MZ': 'eu', 'NA': 'eu', 'NL': 'eu', 'NE': 'eu', 'NG': 'eu', 'NO': 'eu', 'PS': 'eu', 'PL': 'eu', 'PT': 'eu', 'RE': 'eu', 'RO': 'eu', 'RW': 'eu', 'SH': 'eu', 'SM': 'eu', 'ST': 'eu', 'SN': 'eu', 'CS': 'eu', 'RS': 'eu', 'SC': 'eu', 'SL': 'eu', 'SK': 'eu', 'SI': 'eu', 'SO': 'eu', 'ZA': 'eu', 'ES': 'eu', 'SJ': 'eu', 'SZ': 'eu', 'SE': 'eu', 'CH': 'eu', 'TZ': 'eu', 'TG': 'eu', 'TN': 'eu', 'UG': 'eu', 'UA': 'eu', 'VA': 'eu', 'EH': 'eu', 'ZM': 'eu', 'ZW': 'eu', 'AF': 'ap', 'AQ': 'ap', 'AU': 'ap', 'BH': 'ap', 'BD': 'ap', 'BT': 'ap', 'BN': 'ap', 'MM': 'ap', 'KH': 'ap', 'CN': 'ap', 'CX': 'ap', 'CC': 'ap', 'CK': 'ap', 'TL': 'ap', 'FJ': 'ap', 'PF': 'ap', 'HK': 'ap', 'IN': 'ap', 'ID': 'ap', 'IQ': 'ap', 'IL': 'ap', 'JP': 'ap', 'JO': 'ap', 'KZ': 'ap', 'KI': 'ap', 'KR': 'ap', 'KW': 'ap', 'KG': 'ap', 'LA': 'ap', 'LB': 'ap', 'MO': 'ap', 'MY': 'ap', 'MV': 'ap', 'MH': 'ap', 'FM': 'ap', 'MN': 'ap', 'NR': 'ap', 'NP': 'ap', 'NC': 'ap', 'NZ': 'ap', 'NU': 'ap', 'NF': 'ap', 'OM': 'ap', 'PK': 'ap', 'PG': 'ap', 'PH': 'ap', 'PN': 'ap', 'QA': 'ap', 'RU': 'ap', 'WS': 'ap', 'SA': 'ap', 'SG': 'ap', 'SB': 'ap', 'LK': 'ap', 'TW': 'ap', 'TJ': 'ap', 'TH': 'ap', 'TK': 'ap', 'TO': 'ap', 'TR': 'ap', 'TM': 'ap', 'TV': 'ap', 'AE': 'ap', 'UZ': 'ap', 'VU': 'ap', 'VN': 'ap', 'WF': 'ap', 'YE': 'ap'},\n\n\thashStr: function(str) {\n\t\tvar hash = 0, i, chr, len;\n\t\tif (str.length === 0) return hash;\n\t\tfor (i = 0, len = str.length; i < len; i++) {\n\t\t\tchr = str.charCodeAt(i);\n\t\t\thash = ((hash << 5) - hash) + chr;\n\t\t\thash |= 0; // convert to 32bit integer\n\t\t}\n\t\treturn hash;\n\t},\n\n\t/**\n\t * Convert the file size into a formatted string.\n\t *\n\t * @param isize\t\t\tinteger value of file size\n\t * @return A string formatted with the size MB/GB/KB etc. specifier\n\t */\n\tcreateFileSizeString: function(isize) {\n\t\tvar val = '';\n\n\t\tif (isize >= 1099511627776) { // TB\n\t\t\tval = ((isize / 1099511627776).toFixed(1)).toString()+iaw.i18n.getLocalizedString('filesize_key_TB');\n\t\t}\n\t\telse if (isize >= 1073741824) { // GB\n\t\t\tval = ((isize / 1073741824).toFixed(1)).toString()+iaw.i18n.getLocalizedString('filesize_key_GB');\n\t\t}\n\t\telse if (isize >= 1048576) { // MB\n\t\t\tval = ((isize / 1048576).toFixed(1)).toString()+iaw.i18n.getLocalizedString('filesize_key_MB');\n\t\t}\n\t\telse if (isize >= 1024) { // KB\n\t\t\tval = ((isize / 1024).toFixed(1)).toString() + iaw.i18n.getLocalizedString('filesize_key_KB');\n\t\t}\n\t\telse if (isize > 0) { // Bytes\n\t\t\tval = isize.toString()+iaw.i18n.getLocalizedString('filesize_key_B');\n\t\t}\n\t\telse {\n\t\t\tval = '--';\n\t\t}\n\n\t\treturn val.replace('.', iaw.i18n.getLocalizedString('filesize_key_decimal'));\n\t},\n\n\t/**\n\t * Show license dialog.\n\t *\n\t * @param element\telement {type: 'application/vnd.adobe.element.template+dcx'}\n\t * @param contentId template Id\n\t * @skipQuotaCheck \tskip quota check\n\t * @licenseType \tlicense type\n\t */\n\tshowLicenseDialog: function(element, contentId, skipQuotaCheck, libraryId, renditionDetails, licenseType) {\n\t\tvar PURCHASE_DIALOG_INIT_EVENT_NAME = 'com.adobe.inapp.purchase.init';\n\t\tvar PURCHASE_DIALOG_PERFORM_EVENT_NAME = 'com.adobe.inapp.purchase.perform';\n\t\tvar PURCHASE_DIALOG_CLOSED_EVENT_NAME = 'com.adobe.inapp.purchase.closed';\n\t\tvar PURCHASE_DIALOG_EXTENSION_ID = 'com.adobe.inapp.purchase';\n\n\t\treturn new Promise(function(resolve, reject) {\n\t\t\tvar csInterface = iaw.cepUtil.csInterface;\n\t\t\tif (!csInterface) {\n\t\t\t\treject();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// Register for event to know when Purchase dialog loads & pass on the required information\n\t\t\tfunction onPurchaseDialogInit(event) {\n\t\t\t\tcsInterface.removeEventListener(PURCHASE_DIALOG_INIT_EVENT_NAME, onPurchaseDialogInit);\n\t\t\t\tvar csEvent = new CSEvent(PURCHASE_DIALOG_PERFORM_EVENT_NAME, 'APPLICATION', 'CCInAppCmdN', csInterface.getExtensionID());\n\t\t\t\t// TODO: get rid of stockSearchAsset once Stock search is working fine\n\t\t\t\tcsEvent.data = {'elementType': element.type, 'contentId': String(contentId), 'skipQuotaCheck': skipQuotaCheck, 'licenseType': licenseType, 'addToLibraryID': libraryId, 'renditionDetails': renditionDetails};\n\t\t\t\tcsInterface.dispatchEvent(csEvent);\n\t\t\t\tiaw.log.logJSON('Dispatch CEP event to start purchase dialog: ', csEvent);\n\t\t\t}\n\t\t\tcsInterface.addEventListener(PURCHASE_DIALOG_INIT_EVENT_NAME, onPurchaseDialogInit);\n\n\t\t\t// Register for event to know when Purchase dialog closes & get purchase information\n\t\t\tfunction onPurchaseDialogClosed(event) {\n\t\t\t\tiaw.log.logJSON('Data from purchase dialog: ', event);\n\t\t\t\tcsInterface.removeEventListener(PURCHASE_DIALOG_CLOSED_EVENT_NAME, onPurchaseDialogClosed);\n\t\t\t\tcsInterface.removeEventListener('com.adobe.csxs.events.ExtensionUnloaded', onPurchaseDialogClosed);\n\n\t\t\t\t// If this callback is due to ExtensionUnloaded event\n\t\t\t\tif (event.type === 'com.adobe.csxs.events.ExtensionUnloaded') {\n\t\t\t\t\tvar xmlParser = new DOMParser();\n\t\t\t\t\tvar xmlDoc = xmlParser.parseFromString(event.data, 'text/xml');\n\t\t\t\t\t// Check for the extension that go unloaded\n\t\t\t\t\tif (xmlDoc.getElementsByTagName('Id')[0].childNodes[0].nodeValue !== PURCHASE_DIALOG_EXTENSION_ID || xmlDoc.getElementsByTagName('ClosingType')[0].childNodes[0].nodeValue !== '1') {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar eventData = event.data;\n\t\t\t\tif (eventData && eventData.didFinish) {\n\t\t\t\t\tresolve(eventData.data);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\treject(eventData && eventData.data);\n\t\t\t\t}\n\t\t\t}\n\t\t\tcsInterface.addEventListener(PURCHASE_DIALOG_CLOSED_EVENT_NAME, onPurchaseDialogClosed);\n\t\t\tcsInterface.addEventListener('com.adobe.csxs.events.ExtensionUnloaded', onPurchaseDialogClosed);\n\n\t\t\tcsInterface.requestOpenExtension(PURCHASE_DIALOG_EXTENSION_ID);\n\t\t});\n\t},\n\n\t/**\n\t * Creates a string like \"ccx.open recent grid\" or \"ccx.start dragdrop\" to pass to Photoshop\n\t * for Highbeam logging of open actions.\n\t *\n\t * @param context\t\t\tThe general context such as recent, cc files, open dialog, etc\n\t * @param contextDetails\tMore details about the context, e.g. grid or list view. Optional.\n\t * @return A string combining the telling part of the extension id and the contet and details.\n\t */\n\tgetPipMethodString : function(context, viewMode) {\n\t\tvar method = iaw.cepUtil.csInterface.getExtensionID().replace('com.adobe.', '') + ' ' + context;\n\t\tif (viewMode) {\n\t\t\tmethod += ' ' + viewMode;\n\t\t}\n\t\treturn method;\n\t},\n\n\t/**\n\t * Object.assing polyfill from https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign\n\t */\n\tassign: function(target) {\n\t\t'use strict';\n\t\tif (target === undefined || target === null) {\n\t\t\tthrow new TypeError('Cannot convert undefined or null to object');\n\t\t}\n\n\t\tvar output = Object(target);\n\t\tfor (var index = 1; index < arguments.length; index++) {\n\t\t\tvar source = arguments[index];\n\t\t\tif (source !== undefined && source !== null) {\n\t\t\t\tfor (var nextKey in source) {\n\t\t\t\t\tif (source.hasOwnProperty(nextKey) && source[nextKey] !== undefined) {\n\t\t\t\t\t\toutput[nextKey] = source[nextKey];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t},\n\n\t/**\n\t * Merges two (or more) objects, giving the last one precedence\n\t * @param {Object} target\n\t * @param {Object} source\n\t */\n\tmerge: function(target, source) {\n\t\tif (typeof target !== 'object') {\n\t\t\ttarget = {};\n\t\t}\n\n\t\tvar sourceProperty;\n\n\t\tfor (var property in source) {\n\t\t\tif (source.hasOwnProperty(property)) {\n\t\t\t\tsourceProperty = source[property];\n\n\t\t\t\tif (typeof sourceProperty === 'object') {\n\t\t\t\t\ttarget[property] = iaw.util.merge(target[property], sourceProperty);\n\t\t\t\t}\n\n\t\t\t\ttarget[property] = sourceProperty;\n\t\t\t}\n\t\t}\n\n\t\tfor (var a = 2, l = arguments.length; a < l; a++) {\n\t\t\tiaw.util.merge(target, arguments[a]);\n\t\t}\n\n\t\treturn target;\n\t},\n\n\n\t/**\n\t * Get template data per template id\n\t * @param templateId\t\ttemplate id\n\t * @return A object of template data\n\t */\n\tgetTemplateData: function(templateId) {\n\t\tvar templateData;\n\t\tvar templates = iaw.store.get('templates');\n\t\tif (templates && templates.length > 0) {\n\t\t\ttemplates.forEach(function(template) {\n\t\t\t\tif (template.id === templateId) {\n\t\t\t\t\ttemplateData = template;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn templateData;\n\t},\n\n\t/**\n\t * Set template data per uuid\n\t * @param templateId\t\ttemplate id\n\t * @return A object of template data\n\t */\n\tsetTemplateData: function(uuid, templateData) {\n\t\tvar templateIndex = iaw.store.get(['templateLUT', uuid]);\n\t\tiaw.store.set(['templates', templateIndex], templateData);\n\t},\n\n\t/**\n\t * Animate a scrollTo action of the provided element given the provided offset\n\t * TODO this should move to a more common location, perhaps with spectre if this disclosure widget makes it there\n\t *\n\t * @param {DOM.element} element scroll container element\n\t * @param {number} offset positive or negative distance to scroll from current\n\t * @param {number=} duration\n\t * @param {Function=} callback\n\t */\n\tsmoothScroll: function(element, offset, duration, callback) {\n\n\t\tfunction easeInOutQuad(t, b, c, d) {\n\t\t\tt /= d/2;\n\t\t\tif (t < 1) {\n\t\t\t\treturn c/2*t*t + b;\n\t\t\t}\n\t\t\tt--;\n\t\t\treturn -c/2 * (t*(t-2) - 1) + b;\n\t\t}\n\n\t\tvar start = element.scrollTop,\n\t\t\tcurrentTime = 0,\n\t\t\tincrement = 20,\n\t\t\tval;\n\n\t\tduration = (typeof (duration) === 'undefined') ? 500 : duration;\n\n\t\tfunction animateScroll() {\n\t\t\tcurrentTime += increment;\n\t\t\tval = easeInOutQuad(currentTime, start, offset, duration);\n\t\t\telement.scrollTop = val;\n\n\t\t\tif (currentTime < duration) {\n\t\t\t\trequestAnimationFrame(animateScroll);\n\t\t\t}\n\t\t\telse if (typeof callback === 'function') {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\n\t\tanimateScroll();\n\t},\n\n\t/**\n\t * Launch CCX process if not running.\n\t * callback is a funcion with parameter status code:\n\t *   0: means the process has been running\n\t *   1: indicates the process is just launched and ready\n\t *   2: timeout or failed to launch process, like Thor is upgrading, or it's slow to get CCX Process startup (longer than 2 seconds)\n\t *   3: Thor or ccx process is not installed at all\n\t */\n\tlaunchCCXProcess: function(callback) {\n\t\tif (iaw.util.ccxProcessLaunchPending || !window.__adobe_cep__) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar initializedTimeout;\n\t\tvar initializedMessage = 'vulcan.SuiteMessage.ccxprocess.Initialized';\n\n\t\tcallback = callback || function() {};\n\t\tiaw.util.ccxProcessLaunchPending = true;\n\n\t\tfunction onFinished(status) {\n\t\t\tcallback(status);\n\t\t\tiaw.util.ccxProcessLaunchPending = false;\n\t\t}\n\n\t\tfunction started() {\n\t\t\tclearTimeout(initializedTimeout);\n\t\t\tiaw.util.ccxProcessLaunchPending = false;\n\t\t\tVulcanInterface.removeMessageListener(initializedMessage, started);\n\t\t\tonFinished(1);\n\t\t}\n\n\t\tfunction startLaunchCCXProcess() {\n\t\t\tVulcanInterface.addMessageListener(initializedMessage, started);\n\t\t\tinitializedTimeout = setTimeout(function() {\n\t\t\t\tVulcanInterface.removeMessageListener(initializedMessage, started);\n\t\t\t\tonFinished(2);\n\t\t\t},\n\t\t\t1000);\n\t\t\tVulcanInterface.launchApp('ccxprocess', false);\n\t\t}\n\n\t\tif (VulcanInterface.isAppInstalled('ccxprocess')) {\n\t\t\tiaw.util.isCCXProcessRunning(function(isRunning) {\n\t\t\t\tif (!isRunning) {\n\t\t\t\t\tiaw.log.console('Start to launch CCX Process');\n\t\t\t\t\tstartLaunchCCXProcess();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tonFinished(0);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse {\n\t\t\tonFinished(3);\n\t\t}\n\t},\n\n\t/**\n\t * Check if CCX process is installed.\n\t */\n\tisCCXProcessInstalled: function(callback) {\n\t\treturn VulcanInterface.isAppInstalled('ccxprocess');\n\t},\n\n\t/**\n\t * Check if CCX process is running.\n\t */\n\tisCCXProcessRunning: function(callback) {\n\t\tif (!iaw.util.isWindowsOS() && VulcanInterface.isAppRunning('ccxprocess')) {\n\t\t\t// Ignore VulcanInterface.isAppRunning on Windows due to https://jira.corp.adobe.com/browse/CEP-510\n\t\t\treturn callback(true);\n\t\t}\n\n\t\t// VulcanInterface.isAppRunning is not reliable to know the running status. Sometimes it returns false for the running CCX Process on Mac.\n\t\t// Workaround is to check if CCX Process is able to respond to a ping/pong message in 200ms.\n\t\tvar pingMessage = 'vulcan.SuiteMessage.ccxprocess.in.request.app.ping';\n\t\tvar pongMessage = 'vulcan.SuiteMessage.ccxprocess.out.response.app.ping';\n\t\tvar pingMessageTimeout;\n\n\t\tfunction pongHanlder() {\n\t\t\tclearTimeout(pingMessageTimeout);\n\t\t\tVulcanInterface.removeMessageListener(pongMessage, pongHanlder);\n\t\t\tcallback(true);\n\t\t}\n\n\t\tVulcanInterface.addMessageListener(pongMessage, pongHanlder);\n\t\tpingMessageTimeout = setTimeout(function() {\n\t\t\tVulcanInterface.removeMessageListener(pongMessage, pongHanlder);\n\t\t\tcallback(false);\n\t\t}, 200);\n\n\t\tvar message = new VulcanMessage(pingMessage);\n\t\tmessage.setPayload('');\n\t\tVulcanInterface.dispatchMessage(message);\n\t}\n};\n","/*************************************************************************\n * ADOBE CONFIDENTIAL\n * ___________________\n *\n *  Copyright 2016 Adobe Systems Incorporated\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe Systems Incorporated and its suppliers,\n * if any.  The intellectual and technical concepts contained\n * herein are proprietary to Adobe Systems Incorporated and its\n * suppliers and are protected by all applicable intellectual property\n * laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe Systems Incorporated.\n **************************************************************************/\n(function() {\n\tvar fnft = {\n\n\t\tdata: { },\n\n\t\tRWD_SMALL: 0,\n\t\tRWD_LARGE: 1,\n\t\tLOG_PREFIX:\t\t\t\t\t\t'CCX-FNFT :: ',\n\t\tCCXP_VULCAN_SPECIFIER:\t\t\t'CCXP',\n\t\tVULCAN_STOCK_TEMPLATE_REQUEST:\t'ccxprocess.StockTemplateRequest',\n\t\tVULCAN_STOCK_TEMPLATE_RESPONSE:\t'ccxprocess.StockTemplateResponse',\n\t\tSTOCK_RESPONSE_TIMEOUT:\t\t\t1000, // 1 seconds\n\t\tStockTimeoutHandler:\t\t\tnull,\n\n\t\t/**\n\t\t * Event handler for updating the calculation data from the host for AI/ID field calculations.\n\t\t *\n\t\t * @param evt \tevent data object\n\t\t */\n\t\thandleUpdateCalcData: function(evt) {\n\t\t\tvar evtData = null;\n\n\t\t\ttry {\n\t\t\t\tevtData = (typeof evt.data === 'string') ? JSON.parse(evt.data) : evt.data;\n\t\t\t}\n\t\t\tcatch (err) {\n\t\t\t\tiaw.log.exception('Host calculation update handler exception: '+err.message);\n\t\t\t}\n\t\t\tif (evtData) {\n\t\t\t\tiaw.store.set(['host-calc-update'], evtData);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Generate a default data set if the Stock pull fails.\n\t\t *\n\t\t * @return an object representing the default data set.\n\t\t */\n\t\tgenerateDefaultStockData: function(hostData) {\n\t\t\tvar defaultData = {\n\t\t\t\t'nb_results': 0,\n\t\t\t\t'templates': [],\n\t\t\t\t'expirationDTS': '2015-11-01T00:00:00.000+00:00',\n\t\t\t\t'version': hostData.radarVersion || '0.0.0'\n\t\t\t};\n\n\t\t\treturn defaultData;\n\t\t},\n\n\t\t/**\n\t\t * Create the filter tab elements for the file new from template nav bar\n\t\t *\n\t\t * @param hostID\t\t\tapplication host ID string\n\t\t * @return An ordered array of the nav bar filter elements\n\t\t */\n\t\tgenerateFilters: function(hostID) {\n\t\t\tvar filters;\n\t\t\tswitch (hostID) {\n\t\t\t\tcase 'ILST':\n\t\t\t\t\tfilters = [\n\t\t\t\t\t\t{type: 'recent',\tname: 'newdoc_filter_recent'},\n\t\t\t\t\t\t{type: 'saved',     name: 'newdoc_filter_saved'},\n\t\t\t\t\t\t{type: 'mobile',\tname: 'newdoc_filter_mobile'},\n\t\t\t\t\t\t{type: 'web',\t\tname: 'newdoc_filter_web'},\n\t\t\t\t\t\t{type: 'print',\t\tname: 'newdoc_filter_print'},\n\t\t\t\t\t\t{type: 'film',\t\tname: 'newdoc_filter_film'},\n\t\t\t\t\t\t{type: 'art',\t\tname: 'newdoc_filter_art'}\n\t\t\t\t\t];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'PHXS':\n\t\t\t\t\tfilters = [\n\t\t\t\t\t\t{type: 'recent',\tname: 'newdoc_filter_recent'},\n\t\t\t\t\t\t{type: 'saved',     name: 'newdoc_filter_saved'},\n\t\t\t\t\t\t{type: 'photo',\t\tname: 'newdoc_filter_photo'},\n\t\t\t\t\t\t{type: 'print',\t\tname: 'newdoc_filter_print'},\n\t\t\t\t\t\t{type: 'art',\t\tname: 'newdoc_filter_art'},\n\t\t\t\t\t\t{type: 'web',\t\tname: 'newdoc_filter_web'},\n\t\t\t\t\t\t{type: 'mobile',\tname: 'newdoc_filter_mobile'},\n\t\t\t\t\t\t{type: 'film',\t\tname: 'newdoc_filter_film'}\n\t\t\t\t\t];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'IDSN':\n\t\t\t\t\tfilters = [\n\t\t\t\t\t\t{type: 'recent',\tname: 'newdoc_filter_recent'},\n\t\t\t\t\t\t{type: 'saved',     name: 'newdoc_filter_saved'},\n\t\t\t\t\t\t{type: 'print',\t\tname: 'newdoc_filter_print'},\n\t\t\t\t\t\t{type: 'web',\t\tname: 'newdoc_filter_web'},\n\t\t\t\t\t\t{type: 'mobile',\tname: 'newdoc_filter_mobile'}\n\t\t\t\t\t];\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tfilters = [\n\t\t\t\t\t\t{type: 'recent',\tname: 'newdoc_filter_recent'},\n\t\t\t\t\t\t{type: 'saved',     name: 'newdoc_filter_saved'},\n\t\t\t\t\t\t{type: 'mobile',\tname: 'newdoc_filter_mobile'},\n\t\t\t\t\t\t{type: 'web',\t\tname: 'newdoc_filter_web'},\n\t\t\t\t\t\t{type: 'print',\t\tname: 'newdoc_filter_print'},\n\t\t\t\t\t\t{type: 'photo',\t\tname: 'newdoc_filter_photo'},\n\t\t\t\t\t\t{type: 'film',\t\tname: 'newdoc_filter_film'},\n\t\t\t\t\t\t{type: 'art',\t\tname: 'newdoc_filter_art'}\n\t\t\t\t\t];\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\treturn filters;\n\t\t},\n\n\t\t/**\n\t\t * Get the icon font element associated with the corresponding ID.\n\t\t *\n\t\t * @param elementID\tunique identifier string of the UI element\n\t\t */\n\t\tgetThumbnailIcon: function(elementID) {\n\t\t\tvar iconMap = {\n\t\t\t\t'recent': 'SP_PresetNewFromPreset.png',\n\t\t\t\t'mobile': 'SP_PresetMobileAppDoc.png',\n\t\t\t\t'web': 'SP_PresetWebDoc.png',\n\t\t\t\t'print': 'SP_PrintDoc.png',\n\t\t\t\t'photo': 'SP_PresetPhotoDoc.png',\n\t\t\t\t'film': 'SP_PresetFilmVideo.png',\n\t\t\t\t'art': 'SP_PresetCustom.png'\n\t\t\t};\n\t\t\tvar icon = iconMap[elementID] || 'CCX_Start_DefaultThumb_other.png';\n\n\t\t\treturn 'images/thumbs/'+icon;\n\t\t},\n\n\t\t/**\n\t\t * Get the JSON data block that matches the selected template.\n\t\t *\n\t\t * @param templateUUID\tunique identifier string of the template\n\t\t */\n\t\tgetTemplateData: function(templateUUID) {\n\n\t\t\tvar templateData  = null;\n\n\t\t\tif (templateUUID) {\n\t\t\t\tvar dataIndex = iaw.store.get(['presetLUT', templateUUID]);\n\n\t\t\t\tif (dataIndex !== undefined ) {\n\t\t\t\t\ttemplateData = iaw.store.get('presets', dataIndex);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tdataIndex = iaw.store.get(['templateLUT', templateUUID]);\n\n\t\t\t\t\tif (dataIndex !== undefined ) {\n\t\t\t\t\t\ttemplateData = iaw.store.get('templates', dataIndex);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn templateData;\n\t\t},\n\n\t\t/**\n\t\t * Handle status coming back from the host ExtendScript method,\n\t\t * closes the extension is status is 'true'. Remember callbacks/continuation\n\t\t * methods from ExtendScript always send params as strings.\n\t\t * For FNFT we have to close 2 extensions - the Start & FNFT.\n\t\t *\n\t\t * @param status       string containing 'false' if cancelled/error, 'true' otherwise\n\t\t */\n\t\tcloseExtOnStatus: function(status) {\n\t\t\tif ((status.toLowerCase() === 'true') && window.__adobe_cep__) {\n\t\t\t\t//iaw.analytics.ingest.logScreenStateEvent('close-auto');\n\t\t\t\twindow.__adobe_cep__.closeExtension();\n\t\t\t}\n\t\t},\n\n\t\t/*\n\t\t * Create a new Preset from the currently selected document settings\n\t\t *\n\t\t * @param name the name of the preset to create\n\t\t * @return an object representing the created template set.\n\t\t */\n\t\tcreatePreset: function(name, callback) {\n\t\t\t// get the selected template\n\t\t\tvar templateData = iaw.fnft.getTemplateData(iaw.store.get(['input', 'selected-item']));\n\t\t\tif (!templateData) {\n\t\t\t\ttry {\n\t\t\t\t\ttemplateData = JSON.parse(iaw.store.get('last-saved-template-data') || iaw.store.get('last-deleted-template-data'));\n\t\t\t\t}\n\t\t\t\tcatch (e) {\n\t\t\t\t\ttemplateData = {isPreset: true};\n\t\t\t\t}\n\t\t\t}\n\t\t\tiaw.store.set('last-saved-template-data', JSON.stringify(templateData));\n\n\t\t\tvar hostID  = iaw.store.get(['host', 'hostID']);\n\t\t\tvar settings = iaw.store.get(['input', 'settings']);\n\n\t\t\tvar tempObj = {};\n\n\t\t\t// merge templateData to tempObj\n\t\t\tiaw.util.assign(tempObj, templateData);\n\n\t\t\tif (templateData.isPreset && settings) {\n\t\t\t\t// merge custom settings to tempObj\n\t\t\t\tiaw.util.assign(tempObj, settings);\n\t\t\t}\n\n\t\t\ttempObj['template_category'] = 'saved';\n\n\t\t\ttempObj.title = name;\n\t\t\ttempObj.name = name;\n\t\t\ttempObj.group = 'user';\n\n\t\t\tif (hostID === 'PHXS') {\n\t\t\t\tif (templateData.isPreset) {\n\t\t\t\t\tif (window.__adobe_cep__) {\n\t\t\t\t\t\tiaw.cepUtil.evalExtendScriptWithParams('CCXWelcomeXSHost_PHXS.createPreset', tempObj, name, callback);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tcallback(tempObj);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (hostID === 'IDSN') {\n\t\t\t\tif (templateData.isPreset) {\n\t\t\t\t\tif (window.__adobe_cep__) {\n\t\t\t\t\t\tiaw.cepUtil.sendEvent( iaw.cepUtil.events.SAVEPRESET, tempObj);\n\t\t\t\t\t\tcallback(tempObj);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn tempObj;\n\t\t},\n\n\t\tdeletePreset: function(name) {\n\t\t\tif (!window.__adobe_cep__) return;\n\t\t\tvar hostID  = iaw.store.get(['host', 'hostID']);\n\t\t\tvar templateData = iaw.fnft.getTemplateData(iaw.store.get(['input', 'selected-item']));\n\t\t\tiaw.store.set('last-deleted-template-data', JSON.stringify(templateData));\n\t\t\tswitch (hostID) {\n\t\t\t\tcase 'PHXS':\n\t\t\t\t\tiaw.cepUtil.evalExtendScriptWithParams('CCXWelcomeXSHost_PHXS.deletePreset', name, iaw.fnft.closeExtOnStatus);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'IDSN':\n\t\t\t\t\tiaw.cepUtil.sendEvent( iaw.cepUtil.events.DELETEPRESET, name);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\n\t\t/*\n\t\t * Create a new document from the currently selected template\n\t\t *\n\t\t * @param showDialog\t\tboolean parameter indicating if the native document\n\t\t *\t\t\t\t\t\t\tdialog should be shown or not\n\t\t */\n\t\tcreateNewDocumentFromSelectedTemplate: function(showDialog) {\n\t\t\tvar self = this;\n\t\t\t// validate required parameter\n\t\t\tshowDialog = showDialog || false;\n\n\t\t\t// get the selected template\n\t\t\tvar templateData = iaw.fnft.getTemplateData(iaw.store.get(['input', 'selected-item']));\n\n\t\t\tif (templateData) {\n\t\t\t\tvar hostID  = iaw.store.get(['host', 'hostID']);\n\t\t\t\tvar docName = iaw.store.get(['input', 'doc-name']);\n\t\t\t\tvar settings = iaw.store.get(['input', 'settings']);\n\t\t\t\tvar tempObj = {};\n\n\t\t\t\t// set the document name for the new document\n\t\t\t\ttempObj.documentName = docName;\n\t\t\t\ttempObj.showDialog = showDialog;\n\n\t\t\t\t// merge templateData to tempObj\n\t\t\t\tiaw.util.assign(tempObj, templateData);\n\n\t\t\t\tif (templateData.isPreset && settings) {\n\t\t\t\t\t// merge custom settings to tempObj\n\t\t\t\t\tiaw.util.assign(tempObj, settings);\n\t\t\t\t}\n\t\t\t\telse if (!templateData.url) {\n\t\t\t\t\tvar status = iaw.libraryManager.getTemplateStatus(templateData.id);\n\t\t\t\t\tif (status) {\n\t\t\t\t\t\ttempObj.url = status.path;\n\t\t\t\t\t\ttempObj.elementRef = status.elementRef;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tswitch (hostID) {\n\t\t\t\t\tcase 'PHXS':\n\t\t\t\t\t\tif (templateData.isPreset) {\n\t\t\t\t\t\t\tiaw.cepUtil.evalExtendScriptWithParams('CCXWelcomeXSHost_PHXS.createDocumentFromTemplate',\n\t\t\t\t\t\t\t\ttempObj, docName, showDialog, iaw.fnft.closeExtOnStatus);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tvar pipMethod = iaw.util.getPipMethodString('stocktemplate', null);\n\t\t\t\t\t\t\twindow.__adobe_cep__.evalScript('CCXWelcomeXSHost_PHXS.openDocumentWithPath(\"'+tempObj.url+'\",\"'+pipMethod+'\",true,\"'+templateData.elementRef+'\")', iaw.fnft.closeExtOnStatus);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tiaw.log.console(self.LOG_PREFIX + 'Sending data to create new doc: ' + JSON.stringify(tempObj));\n\t\t\t\t\t\tiaw.cepUtil.sendEvent(iaw.cepUtil.events.NEWDOCFROMTEMPLATE, JSON.stringify(tempObj));\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Get template data from the Adobe Stock service.\n\t\t * @param hostData\thost data passed from the application\n\t\t * @param cb\t\tcallback method\n\t\t */\n\t\tgetStockData: function(hostData, cb) {\n\n\t\t\tvar self = this;\n\t\t\t// var startTimestamp = Date.now();\n\t\t\tvar onFinish = function(err, data) { //eslint-disable-line func-style\n\t\t\t\tif (err) {\n\t\t\t\t\tiaw.log.console(self.LOG_PREFIX + err);\n\t\t\t\t}\n\t\t\t\t// var durationInMilliSec = Date.now() - startTimestamp;\n\n\t\t\t\t// iaw.log.debug(self.LOG_PREFIX + 'It costs ' + durationInMilliSec + ' ms to get stock response from CCXProcess.');\n\t\t\t\tcb(data);\n\t\t\t};\n\n\t\t\tif (!iaw.util.isCCXProcessInstalled()) {\n\t\t\t\treturn onFinish('CCX Process is not installed.');\n\t\t\t}\n\n\t\t\t// Check and launch CCXProcess\n\t\t\tiaw.util.launchCCXProcess();\n\n\t\t\tvar uuid = iaw.util.generateGUID();\n\t\t\tvar responder = {};\n\t\t\tresponder.handler = function(msg) { //eslint-disable-line func-style\n\t\t\t\tvar responseData = VulcanInterface.getPayload(msg);\n\t\t\t\tvar stockJSON;\n\t\t\t\tvar parsedData;\n\n\t\t\t\t// parse the JSON response\n\t\t\t\ttry {\n\t\t\t\t\tparsedData = JSON.parse(responseData);\n\t\t\t\t\t// iaw.log.debug(self.LOG_PREFIX + 'Receiving ' + self.VULCAN_STOCK_TEMPLATE_RESPONSE + ' [' + parsedData.requestId + '], path is ' + parsedData.path);\n\t\t\t\t}\n\t\t\t\tcatch (error) {\n\t\t\t\t\t// iaw.log.debug(self.LOG_PREFIX + 'Invalid JSON string:' + responseData);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// validate\n\t\t\t\tif (parsedData && parsedData.requestId === uuid) {\n\t\t\t\t\t// Clear timeout only if the response has the expected requestid.\n\t\t\t\t\tclearTimeout(self.StockTimeoutHandler);\n\t\t\t\t\tvar err = null;\n\n\t\t\t\t\tif (parsedData.path) {\n\t\t\t\t\t\t// read in the locally written JSON data from Adobe Stock\n\t\t\t\t\t\t// and adjust image paths to the local file system\n\t\t\t\t\t\tstockJSON = iaw.json.readLocalJSONFile(parsedData.path);\n\n\t\t\t\t\t\tif (stockJSON && stockJSON.templates) {\n\t\t\t\t\t\t\tfor (var i = 0; i < stockJSON.templates.length; i++) {\n\t\t\t\t\t\t\t\tvar template = stockJSON.templates[i];\n\t\t\t\t\t\t\t\tvar parentFolder = parsedData.path.substring(0, parsedData.path.lastIndexOf('/'));\n\t\t\t\t\t\t\t\tif (template['thumbnail_url'] ) {\n\t\t\t\t\t\t\t\t\ttemplate['thumbnail_url'] = parentFolder && parentFolder + '/' + template['thumbnail_url'];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (template.previews) {\n\t\t\t\t\t\t\t\t\tfor (var j = 0; j < template.previews.length; j++) {\n\t\t\t\t\t\t\t\t\t\tvar preview = template.previews[j];\n\t\t\t\t\t\t\t\t\t\tif (preview && preview.url) {\n\t\t\t\t\t\t\t\t\t\t\tpreview.url = parentFolder && parentFolder + '/' + preview.url;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\terr = 'path is missing, parsedData=' + JSON.stringify(parsedData);\n\t\t\t\t\t}\n\t\t\t\t\t// clear IPC listeners\n\t\t\t\t\tVulcanInterface.removeMessageListener(VulcanMessage.TYPE_PREFIX + self.VULCAN_STOCK_TEMPLATE_RESPONSE, responder.handler);\n\t\t\t\t\t// finsish out\n\t\t\t\t\tonFinish(err, stockJSON);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// Add message lisener for Stock response\n\t\t\tVulcanInterface.addMessageListener(VulcanMessage.TYPE_PREFIX + self.VULCAN_STOCK_TEMPLATE_RESPONSE, responder.handler);\n\n\t\t\t// Send Stock request\n\t\t\tvar stockParams = {\n\t\t\t\tproductCode:\t\thostData.hostID,\n\t\t\t\tproductVersion:\t\thostData.appVersion,\n\t\t\t\tproductLanguage:\thostData.language,\n\t\t\t\tcountryCode:\t\thostData.countryCode,\n\t\t\t\tsubscriptionStatus:\thostData.accountStatus,\n\t\t\t\trequestId:\t\t\tuuid,\n\t\t\t\tfeatureFlag: \t\tfalse,\n\t\t\t\trelease: \t\t\t'CCXStart-1-5'\n\t\t\t};\n\n\t\t\tif (stockParams.subscriptionStatus === 'trial') {\n\t\t\t\tstockParams.trialEndDTS = iaw.util.getTrialEndDate(hostData.secondsLeftInTrial);\n\t\t\t}\n\n\t\t\tvar params = {\n\t\t\t\tstockParams:\t\t\tstockParams,\n\t\t\t\trequestId:\t\t\t\tuuid,\n\t\t\t\tuserTrackingEnabled:\thostData.userTrackingEnabled\n\t\t\t};\n\t\t\tvar StockRequestMsg = new VulcanMessage(VulcanMessage.TYPE_PREFIX + self.VULCAN_STOCK_TEMPLATE_REQUEST);\n\n\t\t\tStockRequestMsg.setPayload(JSON.stringify(params));\n\t\t\tVulcanInterface.dispatchMessage(StockRequestMsg);\n\t\t\tiaw.log.console(self.LOG_PREFIX + 'Sending ' + self.VULCAN_STOCK_TEMPLATE_REQUEST + ' [' + uuid + ']');\n\n\t\t\t// Set timeout\n\t\t\tself.StockTimeoutHandler = setTimeout(function() {\n\t\t\t\tVulcanInterface.removeMessageListener(VulcanMessage.TYPE_PREFIX + self.VULCAN_STOCK_TEMPLATE_RESPONSE, responder.handler);\n\t\t\t\tonFinish('It is timeout to get stock response from CCX Process.');\n\t\t\t}, self.STOCK_RESPONSE_TIMEOUT);\n\t\t}\n\t};\n\n\twindow.iaw = window.iaw || {};\n\twindow.iaw.fnft = fnft;\n}());\n","/*************************************************************************\n * ADOBE CONFIDENTIAL\n * ___________________\n *\n *  Copyright 2016 Adobe Systems Incorporated\n *  All Rights Reserved.\n *\n * NOTICE:  All information contained herein is, and remains\n * the property of Adobe Systems Incorporated and its suppliers,\n * if any.  The intellectual and technical concepts contained\n * herein are proprietary to Adobe Systems Incorporated and its\n * suppliers and are protected by all applicable intellectual property\n * laws, including trade secret and copyright laws.\n * Dissemination of this information or reproduction of this material\n * is strictly forbidden unless prior written permission is obtained\n * from Adobe Systems Incorporated.\n **************************************************************************/\n\niaw.fnftEvents = {\n\tCUSTOMIZE_DOC:\t\t'host-more-options',\n\tCREATE_DOC:\t\t\t'host-create-template-doc',\n\tCANCEL_DOC:\t\t\t'host-close-fnft',\n\tSCREEN_TEMPLATE:\t'host-screen-template',\n\tFILTER:\t\t\t\t'filter-templates'\n};\n\n/**\n * Handle the \"Customize\" button event\n */\nriotctrl.on(iaw.fnftEvents.CUSTOMIZE_DOC, function() {\n\tif (window.__adobe_cep__) {\n\t\tiaw.fnft.createNewDocumentFromSelectedTemplate(true);\n\t}\n});\n\n/**\n * Handle the \"Create Document\" button event.\n */\nriotctrl.on(iaw.fnftEvents.CREATE_DOC, (function() {\n\tvar isCoolingDown = false;\n\tvar coolDownTimer = 7000;\n\n\treturn function() {\n\t\tif (window.__adobe_cep__) {\n\t\t\t\n\t\t\tif (isCoolingDown) return;\n\n\t\t\tisCoolingDown = true;\n\t\t\tsetTimeout( function() {\n\t\t\t\tisCoolingDown = false;\n\t\t\t}, coolDownTimer);\n\n\t\t\tvar template = iaw.fnft.getTemplateData(iaw.store.get(['input', 'selected-item']));\n\t\t\tif (template && !template.isPreset) {\n\t\t\t\tif (iaw.store.get(['host', 'hostID']) !== 'PHXS') {\n\t\t\t\t\tiaw.localstorage.setUserItem('templateLUT_' + template.id, new Date().getTime());\n\t\t\t\t}\n\t\t\t\tiaw.analytics.ingest.logFNFTActionClickedEvent('open-template', template);\n\t\t\t\tiaw.analytics.pip.logFNFTDataGroupEvent('Open Template', {\n\t\t\t\t\tid: String(template.id),\n\t\t\t\t\tname: template.title,\n\t\t\t\t\ttemplateCategory: template.template_category.toString(),\n\t\t\t\t\tactiveTab: template.activeFilter\n\t\t\t\t});\n\t\t\t}\n\t\t\tiaw.fnft.createNewDocumentFromSelectedTemplate();\n\t\t}\n\t\t\n\t};\n})());\n\n/**\n * Handle the \"Close\" button event.\n */\nriotctrl.on(iaw.fnftEvents.CANCEL_DOC, function() {\n\tif (!window.__adobe_cep__) return;\n\n\twindow.__adobe_cep__.closeExtension();\n});\n\n/**\n * Handle the download template button event.\n */\nriotctrl.on(iaw.fnftEvents.SCREEN_TEMPLATE, function() {\n\tvar template = iaw.store.get(['input', 'preview-item']);\n\tiaw.analytics.ingest.logFNFTActionClickedEvent('download', template);\n\tvar showScreen = iaw.localstorage.getUserItem('fnft.showFilesizeWarning');\n\n\tshowScreen = typeof showScreen === 'boolean' ? showScreen : true;\n\tif (!showScreen) {\n\t\tiaw.analytics.ingest.logFNFTActionClickedEvent('license-template', template);\n\t\triotctrl.trigger('host-license-template');\n\t\treturn;\n\t}\n\n\tif (template.size / 1048576 > 100) {\n\t\t// warn the user that this is pretty big\n\t\tiaw.analytics.ingest.logFNFTActionClickedEvent('too-large-render', template);\n\t\triotctrl.trigger('host-download-template--large');\n\t\treturn;\n\t}\n\t// start the licensing process\n\tiaw.analytics.ingest.logFNFTActionClickedEvent('license-template', template);\n\triotctrl.trigger('host-license-template');\n});\n"]}